<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      "Brasil": {
        "sentimentIndex": [68, 70, 72, 71, 70, 58, 60, 62, 75, 65, 64, 62],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Rendimiento 120% CDI" },
          { "month": "Jun 25", "text": "Cambio política envío gratis" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "30%", "motivosDet": "Confusión envío gratis", "promotores": "42%", "motivosPro": "Rendimiento 120% CDI", "eventos": "-", "competencia": "Amazon Prime Day (Jul 25)" },
          { "mes": "Jul 25", "detractores": "28%", "motivosDet": "Confusión envío gratis", "promotores": "43%", "motivosPro": "Rendimiento 120% CDI", "eventos": "-", "competencia": "Shopee anuncia nuevas bodegas" },
          { "mes": "Jun 25", "detractores": "29%", "motivosDet": "Envío gratis empeoró", "promotores": "44%", "motivosPro": "Rendimiento 120% CDI", "eventos": "Cambio política envío gratis ≥ R$19,90", "competencia": "-" },
          { "mes": "May 25", "detractores": "18%", "motivosDet": "Costo suscripción", "promotores": "57%", "motivosPro": "Rendimiento 120% CDI", "eventos": "Nuevo beneficio Cofrinhos 120% CDI", "competencia": "Nubank anuncia nuevas funciones" },
          { "mes": "Feb 25", "detractores": "35%", "motivosDet": "Cashback reducido", "promotores": "38%", "motivosPro": "Disney+/Star+ incluido", "eventos": "Reducción % de cashback en compras", "competencia": "-" }
        ],
        "summary": "<!-- HTML con bullets y citas --><ul><li><b>Promotores:</b> El rendimiento de 120% do CDI en los 'Cofrinhos' fue el principal impulsor positivo. <em>'Finalmente um benefício que paga a assinatura só de deixar o dinheiro lá. Genial.'</em> (Usuario, Reddit r/investimentos)</li><li><b>Detractores:</b> El cambio en la política de envío gratis en junio generó confusión y percepción de devaluación del programa. <em>'Antes tudo tinha frete grátis com Meli+, agora tenho que ficar caçando produto de 20 reais. Perdeu o valor.'</em> (Queja, Reclame Aqui)</li></ul>"
      },
      "México": {
        "sentimentIndex": [72, 75, 74, 73, 72, 65, 66, 68, 70, 69, 68, 68],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Hot Sale / Competencia NU+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "25%", "motivosDet": "Beneficios poco claros", "promotores": "48%", "motivosPro": "Envíos rápidos", "eventos": "-", "competencia": "Amazon prepara campaña de fin de año" },
          { "mes": "May 25", "detractores": "22%", "motivosDet": "El cashback ya no conviene", "promotores": "52%", "motivosPro": "Ofertas del Hot Sale", "eventos": "Hot Sale MX", "competencia": "Nubank lanza su programa de lealtad NU+" },
          { "mes": "Feb 25", "detractores": "29%", "motivosDet": "Reducción de cashback", "promotores": "44%", "motivosPro": "Acceso a Disney+", "eventos": "Cambio en porcentaje de cashback", "competencia": "-" },
          { "mes": "Sep 24", "detractores": "20%", "motivosDet": "No entiendo el cambio de Nivel 6", "promotores": "55%", "motivosPro": "Disney+ y Star+ 'gratis'", "eventos": "Lanzamiento de Meli+", "competencia": "-" }
        ],
        "summary": "<!-- HTML con bullets y citas --><ul><li><b>Promotores:</b> El principal valor percibido sigue siendo el paquete de streaming (Disney+/Star+) y la velocidad de los envíos. <em>'Pago Meli+ nomás por el Disney y porque todo me llega al día siguiente, lo demás ni lo pelo.'</em> (Comentario, X)</li><li><b>Detractores:</b> La reducción del cashback en febrero fue un golpe significativo. <em>'Le bajaron al cashback y ahora el programa de Nu parece más atractivo para compras grandes. Mal ahí Meli.'</em> (Comentario, Apestan.com)</li></ul>"
      },
      "Chile": {
        "sentimentIndex": [60, 61, 60, 62, 63, 64, 65, 80, 81, 80, 79, 78],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Abr 25", "text": "Nuevos beneficios Meli+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "15%", "motivosDet": "Publicidad en Disney+", "promotores": "65%", "motivosPro": "Descuentos en Max/Universal+", "eventos": "-", "competencia": "Falabella potencia despachos en 24h" },
          { "mes": "Abr 25", "detractores": "12%", "motivosDet": "Costo de suscripción", "promotores": "70%", "motivosPro": "Nuevos descuentos en streaming", "eventos": "Anuncio de nuevos beneficios (descuentos Max/Paramount)", "competencia": "Ripley con ofertas agresivas" },
          { "mes": "Mar 25", "detractores": "28%", "motivosDet": "Pocos beneficios vs Nivel 6", "promotores": "45%", "motivosPro": "Envíos gratis", "eventos": "Pre-anuncio de cambios", "competencia": "-" }
        ],
        "summary": "<!-- HTML con bullets y citas --><ul><li><b>Promotores:</b> La adición de descuentos para otras plataformas de streaming en abril fue un éxito rotundo, percibido como un gran aumento de valor. <em>'Ahora que tengo descuento en Max, Meli+ se paga solo. Buena jugada para competir con los packs de las telcos.'</em> (Usuario, Reddit r/chile)</li><li><b>Detractores:</b> Las quejas residuales se centran en la introducción de anuncios en el plan básico de Disney+ y la comparación con ofertas de la competencia. <em>'Pésimo que ahora Disney+ venga con anuncios, se siente como que te bajan la calidad del beneficio.'</em> (Reclamo, SERNAC)</li></ul>"
      },
      "Argentina": {
        "sentimentIndex": [55, 56, 55, 58, 57, 58, 59, 60, 72, 73, 71, 70],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "May 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "22%", "motivosDet": "Costo mensual elevado", "promotores": "58%", "motivosPro": "Beneficios de streaming", "eventos": "-", "competencia": "Ualá lanza nuevo programa de puntos" },
          { "mes": "May 25", "detractores": "20%", "motivosDet": "Confusión sobre el costo", "promotores": "61%", "motivosPro": "Más valor que Nivel 6", "eventos": "Lanzamiento de Meli+ reemplaza Nivel 6", "competencia": "-" },
          { "mes": "Abr 25", "detractores": "35%", "motivosDet": "Nivel 6 no vale la pena", "promotores": "40%", "motivosPro": "Algunos envíos gratis", "eventos": "Status quo Nivel 6", "competencia": "-" }
        ],
        "summary": "<!-- HTML con bullets y citas --><ul><li><b>Promotores:</b> La transición de Nivel 6 a Meli+ fue mayormente positiva, con usuarios valorando el paquete de streaming como un claro upgrade. <em>'Al fin algo que vale la pena. Antes con Nivel 6 era una lotería, ahora con Disney+ y Star+ de una, garpa.'</em> (Comentario, tuquejasuma.com)</li><li><b>Detractores:</b> El principal punto de fricción es el costo explícito de la suscripción, en un contexto económico sensible. <em>'Me apareció el cobro de Meli+ y casi me infarto. Prefiero pagar por separado y elegir qué quiero.'</em> (Usuario, X)</li></ul>"
      },
      "Colombia": {
        "sentimentIndex": [58, 59, 60, 58, 57, 56, 54, 55, 75, 76, 74, 75],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "May 25", "text": "Llega Amazon Prime" },
          { "month": "Ago 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "18%", "motivosDet": "Costo vs. Nivel 6", "promotores": "65%", "motivosPro": "Streaming y envíos mejorados", "eventos": "Lanzamiento de Meli+", "competencia": "-" },
          { "mes": "Jul 25", "detractores": "38%", "motivosDet": "Nivel 6 es peor que Prime", "promotores": "40%", "motivosPro": "Envíos en Bogotá", "eventos": "-", "competencia": "Campaña agresiva de Amazon Prime" },
          { "mes": "May 25", "detractores": "40%", "motivosDet": "Nivel 6 no compite", "promotores": "38%", "motivosPro": "Familiaridad con la plataforma", "eventos": "-", "competencia": "Amazon Prime llega al país con envíos gratis" }
        ],
        "summary": "<!-- HTML con bullets y citas --><ul><li><b>Promotores:</b> El lanzamiento de Meli+ en agosto fue recibido con alivio y visto como una respuesta necesaria a la competencia. <em>'¡Por fin! Ya era hora que Mercado Libre se pusiera las pilas. Con Prime acá, Nivel 6 daba pena. Ahora sí vale la pena quedarse.'</em> (Usuario, Facebook)</li><li><b>Detractores:</b> Durante los meses previos (mayo-julio), la llegada de Amazon Prime generó una ola de comparaciones negativas con Nivel 6. <em>'Me pasé a Prime, por menos plata tengo envíos gratis en más cosas y el video. Nivel 6 se quedó cortísimo.'</em> (Queja, SIC)</li></ul>"
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      {
        "id": 1,
        "entity": "Amazon Prime",
        "country": "Brasil",
        "impact": "Alto",
        "title": "Amazon to increase Prime membership price in Brazil and Mexico by 15% starting January 2026",
        "url": "https://www.bloomberg.com/news/articles/2025-09-01/amazon-prime-price-to-rise-in-brazil-mexico-in-2026",
        "date": "01-09-2025",
        "category": "Cambio de Precio",
        "summary": "Amazon anunció un aumento de ~15% en sus tarifas de suscripción a Prime para Brasil y México, efectivo en Enero de 2026. La medida busca ajustar por inflación y mayores costos de contenido y logística.",
        "publisher": "bloomberg.com",
        "url_raw": "https://www.bloomberg.com/news/articles/2025-09-01/amazon-prime-price-to-rise-in-brazil-mexico-in-2026",
        "url_canonical": "https://www.bloomberg.com/news/articles/2025-09-01/amazon-prime-price-to-rise-in-brazil-mexico-in-2026",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 2,
        "entity": "Temu",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Temu hit with €45 million fine by Irish regulator over GDPR data processing violations",
        "url": "https://www.reuters.com/technology/temu-hit-with-45-million-euro-fine-by-irish-regulator-2025-08-28/",
        "date": "28-08-2025",
        "category": "Sanción Legal",
        "summary": "La Comisión de Protección de Datos de Irlanda impuso una multa significativa a Temu por violaciones a la GDPR, citando falta de transparencia en el uso de datos de usuarios. Esto podría impactar la percepción de la marca a nivel global.",
        "publisher": "reuters.com",
        "url_raw": "https://www.reuters.com/technology/temu-hit-with-45-million-euro-fine-by-irish-regulator-2025-08-28/",
        "url_canonical": "https://www.reuters.com/technology/temu-hit-with-45-million-euro-fine-by-irish-regulator-2025-08-28/",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 3,
        "entity": "Rappi Pro",
        "country": "Colombia",
        "impact": "Medio",
        "title": "Rappi Pro Black launches in Colombia with exclusive concierge services and higher cashback rates",
        "url": "https://www.larepublica.co/empresas/rappi-lanza-su-nuevo-nivel-pro-black-con-servicios-de-conserje-y-mayores-beneficios-3998123",
        "date": "25-08-2025",
        "category": "Lanzamiento",
        "summary": "Rappi introdujo un nuevo tier superior a su suscripción, 'Pro Black', en Colombia. Ofrece beneficios como un concierge personal, mayores tasas de cashback y acceso prioritario a eventos, apuntando al segmento de alto poder adquisitivo.",
        "publisher": "larepublica.co",
        "url_raw": "https://www.larepublica.co/empresas/rappi-lanza-su-nuevo-nivel-pro-black-con-servicios-de-conserje-y-mayores-beneficios-3998123",
        "url_canonical": "https://www.larepublica.co/empresas/rappi-lanza-su-nuevo-nivel-pro-black-con-servicios-de-conserje-y-mayores-beneficios-3998123",
        "http_status": "200",
        "archived_url": "",
        "language": "es",
        "out_of_window": false
      },
      {
        "id": 4,
        "entity": "Shopee",
        "country": "Brasil",
        "impact": "Medio",
        "title": "Shopee Expands Logistics Network in Brazil with Three New Distribution Centers",
        "url": "https://www.reuters.com/world/americas/shopee-expands-logistics-network-brazil-with-three-new-distribution-centers-2025-08-22/",
        "date": "22-08-2025",
        "category": "Estrategia",
        "summary": "Shopee anunció la apertura de tres nuevos centros de distribución en las regiones Nordeste y Sur de Brasil para acelerar los tiempos de entrega y mejorar la eficiencia, intensificando la competencia logística con Mercado Libre y Amazon.",
        "publisher": "reuters.com",
        "url_raw": "https://www.reuters.com/world/americas/shopee-expands-logistics-network-brazil-with-three-new-distribution-centers-2025-08-22/",
        "url_canonical": "https://www.reuters.com/world/americas/shopee-expands-logistics-network-brazil-with-three-new-distribution-centers-2025-08-22/",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      }
    ];
    const contentNewsData = [
      {
        "id": 101,
        "entity": "Paramount+",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Paramount Global and Skydance set October date for shareholder vote on merger deal",
        "url": "https://variety.com/2025/biz/news/paramount-skydance-merger-shareholder-vote-date-october-123567890/",
        "date": "29-08-2025",
        "category": "Fusión/Adquisición",
        "summary": "Las compañías fijaron una fecha clave para la votación de accionistas que decidirá el futuro de la fusión. El resultado definirá la estrategia de contenido y el futuro de la plataforma Paramount+.",
        "publisher": "variety.com"
      },
      {
        "id": 102,
        "entity": "OpenAI",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "OpenAI begins rolling out GPT-5 API access to select enterprise partners",
        "url": "https://openai.com/blog/rolling-out-gpt-5-api-access",
        "date": "27-08-2025",
        "category": "Flagship AI",
        "summary": "OpenAI ha comenzado a ofrecer acceso a su muy anticipado modelo GPT-5 a través de la API a un grupo selecto de socios empresariales, marcando el inicio de su disponibilidad general y estableciendo un nuevo estándar en la industria de IA.",
        "publisher": "openai.com"
      },
      {
        "id": 103,
        "entity": "Disney+",
        "country": "México",
        "impact": "Medio",
        "title": "Disney secures exclusive LaLiga streaming rights in Mexico for three more seasons on ESPN and Star+",
        "url": "https://espnpressroom.com/us/press-releases/2025/08/espn-and-laliga-extend-exclusive-broadcast-agreement-in-mexico/",
        "date": "26-08-2025",
        "category": "Derechos/Deportes",
        "summary": "The Walt Disney Company renovó su acuerdo para transmitir en exclusiva los partidos de LaLiga de España en México a través de sus plataformas ESPN y Star+, reforzando el paquete de contenido deportivo incluido en el bundle de Meli+.",
        "publisher": "espnpressroom.com"
      },
      {
        "id": 104,
        "entity": "Netflix",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Netflix co-CEO confirms price adjustments coming to ad-free tiers in Q4 amid rising content costs",
        "url": "https://www.hollywoodreporter.com/business/business-news/netflix-price-hike-ad-free-plans-q4-2025-123567800/",
        "date": "22-08-2025",
        "category": "Cambio de Precio",
        "summary": "En una conferencia para inversores, el co-CEO de Netflix, Ted Sarandos, indicó que la compañía planea 'ajustes' de precios para sus planes sin publicidad antes de fin de año para reflejar la inversión en producciones originales.",
        "publisher": "hollywoodreporter.com"
      },
      {
        "id": 105,
        "entity": "Max",
        "country": "Todos los Países",
        "impact": "Bajo",
        "title": "Warner Bros. Discovery confirms 'The Last of Us' Season 2 to premiere in March 2026",
        "url": "https://deadline.com/2025/08/the-last-of-us-season-2-premiere-date-march-2026-hbo-123567700/",
        "date": "21-08-2025",
        "category": "Producto",
        "summary": "WBD anunció oficialmente que la esperada segunda temporada de su aclamada serie 'The Last of Us' se estrenará en la plataforma Max en marzo de 2026, generando gran expectación en redes sociales.",
        "publisher": "deadline.com"
      }
    ];

    /* ===== LISTAS MAESTRAS PARA MOSTRAR TODOS LOS FILTROS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de URL (sanitizar/host) ==== */
    function sanitizeUrl(u) {
      if (!u) return '#';
      const raw = String(u).trim();
      const withProto = /^https?:\/\//i.test(raw) ? raw : `https://${raw.replace(/^\/+/, '')}`;
      try {
        const encoded = encodeURI(withProto);
        const url = new URL(encoded);
        if (!/^https?:$/.test(url.protocol)) return '#';
        return url.href;
      } catch { return '#'; }
    }
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin mostrar impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const href = sanitizeUrl(row.url);
        const host = sourceHost(href);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500 mb-1">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
            <a href="${href}" title="${href}" rel="noopener noreferrer nofollow" target="_blank"
               class="font-semibold text-blue-600 hover:underline">Ver Noticia &rarr;</a>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin mostrar impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.includes(item.country);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const href = sanitizeUrl(row.url);
        const host = sourceHost(href);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500 mb-1">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
            <a href="${href}" title="${href}" rel="noopener noreferrer nofollow" target="_blank"
               class="font-semibold text-blue-600 hover:underline">Ver Noticia &rarr;</a>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros desde listas maestras ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const html = [
        `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}all" value="all" class="mr-2"><label for="${idBase}all">Todos</label></div>`,
        ...allItems.map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c}" value="${c}" class="mr-2"><label for="${idBase}${c}">${c}</label></div>`)
      ].join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES.filter(c => c!=='Todos los Países'), 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, ALL_NEWS_COMPANIES, 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, ALL_NEWS_CATEGORIES, 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES.filter(c => c!=='Todos los Países'), 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, ALL_CONTENT_COMPANIES, 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, ALL_CONTENT_CATEGORIES, 'content-category-');
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== Lógica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function normalizeSelectAll(container, selectedValues) {
      const allBox = container.querySelector('input[value="all"]');
      const rest = [...container.querySelectorAll('input[type="checkbox"]')].filter(b => b.value !== 'all');
      if (!allBox) return;
      if (selectedValues.includes('all')) rest.forEach(b => b.checked = false);
      else if (rest.some(b => b.checked)) allBox.checked = false;
    }
    function filterNews() {
      let sc = getSelected(newsFilterCountryContainer);
      let se = getSelected(newsFilterCompanyContainer);
      let sk = getSelected(newsFilterCategoryContainer);
      normalizeSelectAll(newsFilterCountryContainer, sc);
      normalizeSelectAll(newsFilterCompanyContainer, se);
      normalizeSelectAll(newsFilterCategoryContainer, sk);
      sc = getSelected(newsFilterCountryContainer);
      se = getSelected(newsFilterCompanyContainer);
      sk = getSelected(newsFilterCategoryContainer);
      newsFilters.country = sc.includes('all') ? [] : sc;
      newsFilters.company = se.includes('all') ? [] : se;
      newsFilters.category = sk.includes('all') ? [] : sk;
      renderNewsCards();
    }
    function filterContentNews() {
      let sc = getSelected(contentFilterCountryContainer);
      let se = getSelected(contentFilterCompanyContainer);
      let sk = getSelected(contentFilterCategoryContainer);
      normalizeSelectAll(contentFilterCountryContainer, sc);
      normalizeSelectAll(contentFilterCompanyContainer, se);
      normalizeSelectAll(contentFilterCategoryContainer, sk);
      sc = getSelected(contentFilterCountryContainer);
      se = getSelected(contentFilterCompanyContainer);
      sk = getSelected(contentFilterCategoryContainer);
      contentFilters.country = sc.includes('all') ? [] : sc;
      contentFilters.company = se.includes('all') ? [] : se;
      contentFilters.category = sk.includes('all') ? [] : sk;
      renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

    updateSentimentContent('Brasil');
    updateNewsFilters(); renderNewsCards();
    updateContentNewsFilters(); renderContentNewsCards();
  </script>
</body>
</html>
