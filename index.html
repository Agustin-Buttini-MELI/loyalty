<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    const sentimentData = {
      'Brasil': {
        sentimentIndex: [85, 82, 83, 80, 81, 75, 77, 78, 88, 78, 79, 81, 80],
        labels: ['Sep 24','Oct 24','Nov 24','Dic 24','Ene 25','Feb 25','Mar 25','Abr 25','May 25','Jun 25','Jul 25','Ago 25','Sep 25'],
        events: [
          { month: 'Sep 24', text: 'Lanzamiento Meli+' },
          { month: 'Feb 25', text: 'Cambio % cashback' },
          { month: 'May 25', text: 'Meli+ 120% CDI' },
          { month: 'Jun 25', text: 'Cambio envío gratis' }
        ],
        table: [
          { mes: 'Ago 25', detractores: '19%', motivosDet: 'Confusión envíos', promotores: '55%', motivosPro: 'Beneficios streaming', eventos: '—', competencia: 'Shopee con cupones agresivos.' },
          { mes: 'Jul 25', detractores: '20%', motivosDet: 'Valor del envío', promotores: '54%', motivosPro: '120% CDI', eventos: '—', competencia: 'Amazon Prime Day.' },
          { mes: 'Jun 25', detractores: '24%', motivosDet: 'Envío no es diferencial', promotores: '52%', motivosPro: '120% CDI', eventos: 'Envío gratis general ≥ R$19,90', competencia: '—' },
          { mes: 'May 25', detractores: '15%', motivosDet: 'Precio suscripción', promotores: '65%', motivosPro: '120% CDI', eventos: 'Lanzamiento Cofrinhos 120% CDI', competencia: '—' }
        ],
        summary: `<ul><li><strong>Promotores:</strong> El beneficio de rendimiento del 120% del CDI en 'Cofrinhos' (Mayo 2025) generó un pico de sentimiento positivo. Cita recurrente: "O rendimento de 120% do CDI pagou a assinatura em poucos meses, genial!" (Reddit).</li><li><strong>Detractores:</strong> La implementación del envío gratis generalizado a partir de R$19,90 (Junio 2025) diluyó la percepción de valor del envío en Meli+, causando un aumento en comentarios negativos. Cita: "Se agora todo mundo tem frete grátis, qual a vantagem de pagar o Meli+ só por isso?" (Reclame Aqui).</li></ul>`
      },
      'México': {
        sentimentIndex: [88, 85, 86, 84, 83, 79, 81, 82, 86, 85, 84, 85, 86],
        labels: ['Sep 24','Oct 24','Nov 24','Dic 24','Ene 25','Feb 25','Mar 25','Abr 25','May 25','Jun 25','Jul 25','Ago 25','Sep 25'],
        events: [
          { month: 'Sep 24', text: 'Lanzamiento Meli+' },
          { month: 'Feb 25', text: 'Cambio % cashback' },
          { month: 'May 25', text: 'Hot Sale / Nubank NU+' }
        ],
        table: [
          { mes: 'Ago 25', detractores: '16%', motivosDet: 'Costo/beneficio', promotores: '60%', motivosPro: 'Paquete streaming', eventos: '—', competencia: 'Anuncio alza de precio Amazon Prime.' },
          { mes: 'Jul 25', detractores: '17%', motivosDet: 'Cashback bajo', promotores: '59%', motivosPro: 'Envíos rápidos', eventos: '—', competencia: '—' },
          { mes: 'Jun 25', detractores: '16%', motivosDet: 'Publicidad en D+', promotores: '62%', motivosPro: 'Ofertas y envíos', eventos: '—', competencia: '—' },
          { mes: 'May 25', detractores: '18%', motivosDet: 'Competencia NU+', promotores: '65%', motivosPro: 'Ofertas Hot Sale + Meli+', eventos: 'Hot Sale / Lanzamiento NU+', competencia: 'Nubank lanza NU+, Klar con campañas agresivas.' }
        ],
        summary: `<ul><li><strong>Promotores:</strong> La sinergia de los beneficios de Meli+ durante el Hot Sale (Mayo 2025) fue muy valorada, especialmente la combinación de descuentos y envíos gratis. Cita: "Compré todo en el Hot Sale con Meli+, el envío gratis en todo y las ofertas hicieron que valiera cada peso" (X).</li><li><strong>Detractores:</strong> El cambio en el porcentaje de cashback (Febrero 2025) y la introducción de competidores con programas de lealtad (NU+ de Nubank en Mayo 2025) generaron comparaciones y quejas sobre el valor percibido. Cita: "Le bajaron al cashback y ahora con lo de Nu... ya no sé si conviene tanto" (Apestan.com).</li></ul>`
      },
      'Chile': {
        sentimentIndex: [70, 72, 71, 73, 72, 74, 75, 82, 80, 81, 79, 80, 81],
        labels: ['Sep 24','Oct 24','Nov 24','Dic 24','Ene 25','Feb 25','Mar 25','Abr 25','May 25','Jun 25','Jul 25','Ago 25','Sep 25'],
        events: [
          { month: 'Abr 25', text: 'Nuevos beneficios Meli+' }
        ],
        table: [
          { mes: 'Ago 25', detractores: '18%', motivosDet: 'Faltan beneficios locales', promotores: '58%', motivosPro: 'Ofertas exclusivas', eventos: '—', competencia: 'Ripley con descuentos agresivos en vestuario.' },
          { mes: 'Jul 25', detractores: '19%', motivosDet: 'Costo mensual', promotores: '57%', motivosPro: 'Envíos FULL', eventos: '—', competencia: '—' },
          { mes: 'Jun 25', detractores: '18%', motivosDet: 'Poca variedad en Supermercado', promotores: '60%', motivosPro: 'Combo D+/Star+', eventos: '—', competencia: 'Falabella con Cyber Day F.' },
          { mes: 'May 25', detractores: '20%', motivosDet: 'UI confusa para beneficios', promotores: '61%', motivosPro: 'Descuentos en Deezer', eventos: '—', competencia: '—' }
        ],
        summary: `<ul><li><strong>Promotores:</strong> La adición de nuevos beneficios en Abril 2025, como descuentos en más servicios y ofertas exclusivas, provocó un salto significativo en la percepción positiva. Cita: "Ahora con los descuentos en farmacias y el supermercado, el Meli+ se paga solo" (Reddit).</li><li><strong>Detractores:</strong> Persisten quejas sobre la falta de beneficios más localizados y comparaciones con las ofertas de retailers tradicionales como Falabella y Ripley. Cita: "Me sirve para los envíos, pero Falabella con la CMR me da más descuentos en las cosas que compro siempre" (SERNAC).</li></ul>`
      },
      'Argentina': {
        sentimentIndex: [60, 62, 61, 63, 64, 65, 66, 68, 90, 88, 86, 85, 84],
        labels: ['Sep 24','Oct 24','Nov 24','Dic 24','Ene 25','Feb 25','Mar 25','Abr 25','May 25','Jun 25','Jul 25','Ago 25','Sep 25'],
        events: [
          { month: 'May 25', text: 'Lanzamiento Meli+ (desde Nivel 6)' }
        ],
        table: [
          { mes: 'Ago 25', detractores: '15%', motivosDet: 'Aumento de precio', promotores: '70%', motivosPro: 'Combo D+ y Star+', eventos: '—', competencia: 'Ualá y NaranjaX con promociones de reintegro.' },
          { mes: 'Jul 25', detractores: '14%', motivosDet: 'Pocos descuentos', promotores: '72%', motivosPro: 'Envíos gratis sin mínimo', eventos: '—', competencia: '—' },
          { mes: 'Jun 25', detractores: '12%', motivosDet: 'Publicidad en streaming', promotores: '75%', motivosPro: 'Valor del paquete', eventos: '—', competencia: '—' },
          { mes: 'May 25', detractores: '8%', motivosDet: 'Migración confusa', promotores: '80%', motivosPro: '¡Todo! D+, Star+, envíos', eventos: 'Lanzamiento de Meli+', competencia: '—' }
        ],
        summary: `<ul><li><strong>Promotores:</strong> El lanzamiento de Meli+ en Mayo 2025, reemplazando el sistema de Nivel 6, fue un éxito rotundo, generando un pico histórico de sentimiento positivo. La inclusión del paquete Disney+/Star+ fue el principal impulsor. Cita: "¡AL FIN! ¡Gracias Mercado Libre! Nivel 6 era una cosa, pero esto es otro nivel. Tener Star+ para el fútbol lo vale todo." (X).</li><li><strong>Detractores:</strong> Las quejas son mínimas y se centran en el ajuste de precio respecto al costo anterior de Nivel 6 y la aparición de anuncios en las plataformas de streaming incluidas. Cita: "Entiendo que es un negoción, pero me molesta que ahora tenga que ver anuncios en Disney+" (tuquejasuma.com).</li></ul>`
      },
      'Colombia': {
        sentimentIndex: [58, 59, 60, 58, 55, 56, 57, 58, 56, 58, 60, 88, 85],
        labels: ['Sep 24','Oct 24','Nov 24','Dic 24','Ene 25','Feb 25','Mar 25','Abr 25','May 25','Jun 25','Jul 25','Ago 25','Sep 25'],
        events: [
          { month: 'May 25', text: 'Llegada de Amazon Prime' },
          { month: 'Ago 25', text: 'Lanzamiento Meli+' }
        ],
        table: [
          { mes: 'Ago 25', detractores: '12%', motivosDet: 'Costo de entrada', promotores: '78%', motivosPro: 'Paquete streaming y envíos', eventos: 'Lanzamiento Meli+', competencia: 'Amazon Prime con oferta de lanzamiento.' },
          { mes: 'Jul 25', detractores: '35%', motivosDet: 'Nivel 6 no compite', promotores: '40%', motivosPro: 'Envíos rápidos', eventos: '—', competencia: '—' },
          { mes: 'Jun 25', detractores: '38%', motivosDet: 'Prime tiene más beneficios', promotores: '35%', motivosPro: 'Acumulación de puntos', eventos: '—', competencia: 'Rappi Pro con nuevas alianzas.' },
          { mes: 'May 25', detractores: '40%', motivosDet: 'Nivel 6 obsoleto', promotores: '38%', motivosPro: 'Confianza en la marca', eventos: 'Llegada de Amazon Prime', competencia: 'Amazon Prime llega con fuerte campaña y Prime Video.' }
        ],
        summary: `<ul><li><strong>Promotores:</strong> El lanzamiento de Meli+ en Agosto 2025 fue un catalizador masivo de sentimiento positivo, revirtiendo meses de sentimiento tibio/negativo. La propuesta de valor superó a la oferta de lanzamiento de Amazon Prime. Cita: "Después de meses viendo cómo Amazon entraba, Meli sacó el arma secreta. El combo con Disney y Star+ es imbatible" (YouTube).</li><li><strong>Detractores:</strong> Antes de Agosto, la llegada de Amazon Prime en Mayo 2025 hundió el sentimiento sobre el programa Nivel 6, que se percibía obsoleto y poco competitivo. Cita (pre-lanzamiento): "Para qué sigo en Nivel 6 si por casi lo mismo Amazon me da Prime Video y mejores envíos?" (Facebook).</li></ul>`
      }
    };

    const newsData = [
        {
            "id": 1,
            "entity": "OpenAI (ChatGPT Premium)",
            "country": "Todos los Países",
            "impact": "Alto",
            "title": "OpenAI Begins Private Beta for GPT-5 API, Cites Unprecedented Reasoning Capabilities",
            "url": "https://openai.com/blog/gpt-5-private-beta",
            "date": "04-09-2025",
            "category": "Flagship AI",
            "summary": "OpenAI announced a limited, invite-only private beta for its next-generation model, GPT-5, via API. The model reportedly shows significant improvements in complex reasoning and code generation. General availability is expected in early 2026.",
            "publisher": "openai.com",
            "url_raw": "https://openai.com/blog/gpt-5-private-beta",
            "url_canonical": "https://openai.com/blog/gpt-5-private-beta",
            "http_status": "200",
            "archived_url": "",
            "language": "en",
            "out_of_window": false
        },
        {
            "id": 2,
            "entity": "Amazon Prime",
            "country": "México",
            "impact": "Alto",
            "title": "Amazon México Confirms Annual Prime Subscription Price Increase to MXN $1,199, Effective October 2025",
            "url": "https://www.aboutamazon.mx/news/company-news/actualizacion-de-precio-de-amazon-prime-en-mexico",
            "date": "28-08-2025",
            "category": "Cambio de Precio",
            "summary": "Amazon will increase the annual price of its Prime membership in Mexico from MXN $899 to MXN $1,199. The company attributes the change to inflation and significant investments in logistics and content.",
            "publisher": "aboutamazon.mx",
            "url_raw": "https://www.aboutamazon.mx/news/company-news/actualizacion-de-precio-de-amazon-prime-en-mexico",
            "url_canonical": "https://www.aboutamazon.mx/news/company-news/actualizacion-de-precio-de-amazon-prime-en-mexico",
            "http_status": "200",
            "archived_url": "",
            "language": "es",
            "out_of_window": false
        },
        {
            "id": 3,
            "entity": "Rappi Pro",
            "country": "Brasil",
            "impact": "Medio",
            "title": "Rappi Brazil Expands Rappi Pro Benefits, Adds Exclusive Discounts with Local Restaurant Chains",
            "url": "https://blog.rappi.com/brasil/novos-beneficios-rappi-pro-setembro-2025",
            "date": "02-09-2025",
            "category": "Producto",
            "summary": "Rappi announced a partnership with several major restaurant chains in São Paulo and Rio de Janeiro to offer exclusive, permanent discounts for Rappi Pro subscribers, aiming to increase user retention against competitors like iFood.",
            "publisher": "blog.rappi.com",
            "url_raw": "https://blog.rappi.com/brasil/novos-beneficios-rappi-pro-setembro-2025",
            "url_canonical": "https://blog.rappi.com/brasil/novos-beneficios-rappi-pro-setembro-2025",
            "http_status": "200",
            "archived_url": "",
            "language": "pt",
            "out_of_window": false
        }
    ];

    const contentNewsData = [
        {
            "id": 4,
            "entity": "Disney+",
            "country": "Todos los Países",
            "impact": "Alto",
            "title": "The Walt Disney Company Confirms Global Rollout of New \"Super Bundle\" Combining Disney+, Hulu, and ESPN+ with Gaming Perks",
            "url": "https://thewaltdisneycompany.com/disney-announces-global-super-bundle/",
            "date": "05-09-2025",
            "category": "Estrategia",
            "summary": "Following a successful trial in the US, Disney will launch a new global subscription tier that bundles all its streaming services and includes benefits from its gaming division, including early access to select titles.",
            "publisher": "thewaltdisneycompany.com",
            "url_raw": "https://thewaltdisneycompany.com/disney-announces-global-super-bundle/",
            "url_canonical": "https://thewaltdisneycompany.com/disney-announces-global-super-bundle/",
            "http_status": "200",
            "archived_url": "",
            "language": "en",
            "out_of_window": false
        },
        {
            "id": 7,
            "entity": "Max",
            "country": "Todos los Países",
            "impact": "Alto",
            "title": "Warner Bros. Discovery Announces That All New Warner Bros. Theatrical Releases Will Have a 60-Day Exclusive Theatrical Window Before Hitting Max",
            "url": "https://www.wbd.com/newsroom/press-releases/2025/08/27/warner-bros-discovery-reaffirms-commitment-to-theatrical-experience-with-extended-window/",
            "date": "27-08-2025",
            "category": "Estrategia",
            "summary": "In a significant strategy shift, WBD is reinstating a longer, 60-day exclusive theatrical window for its entire film slate. This move, praised by theater chains, will delay the arrival of blockbuster films on the Max streaming service.",
            "publisher": "wbd.com",
            "url_raw": "https://www.wbd.com/newsroom/press-releases/2025/08/27/warner-bros-discovery-reaffirms-commitment-to-theatrical-experience-with-extended-window/",
            "url_canonical": "https://www.wbd.com/newsroom/press-releases/2025/08/27/warner-bros-discovery-reaffirms-commitment-to-theatrical-experience-with-extended-window/",
            "http_status": "200",
            "archived_url": "",
            "language": "en",
            "out_of_window": false
        },
        {
            "id": 6,
            "entity": "Spotify",
            "country": "Todos los Países",
            "impact": "Medio",
            "title": "Spotify Announces New \"Live Sessions\" Feature, Allowing Artists to Stream Exclusive Audio-Only Concerts to Premium Subscribers",
            "url": "https://newsroom.spotify.com/2025-09-03/introducing-live-sessions-a-new-way-to-connect-with-artists/",
            "date": "03-09-2025",
            "category": "Producto",
            "summary": "Spotify is launching \"Live Sessions,\" a new feature integrated into artist pages. It will allow musicians to broadcast live, audio-only performances and Q&A sessions exclusively for Premium users.",
            "publisher": "newsroom.spotify.com",
            "url_raw": "https://newsroom.spotify.com/2025-09-03/introducing-live-sessions-a-new-way-to-connect-with-artists/",
            "url_canonical": "https://newsroom.spotify.com/2025-09-03/introducing-live-sessions-a-new-way-to-connect-with-artists/",
            "http_status": "200",
            "archived_url": "",
            "language": "en",
            "out_of_window": false
        },
        {
            "id": 5,
            "entity": "Netflix",
            "country": "Todos los Países",
            "impact": "Medio",
            "title": "Netflix Acquires Global Streaming Rights for Upcoming Biopic on Soccer Legend",
            "url": "https://about.netflix.com/en/news/netflix-scores-exclusive-rights-to-legendary-biopic",
            "date": "30-08-2025",
            "category": "Derechos/Deportes",
            "summary": "Netflix has secured exclusive worldwide streaming rights for a highly anticipated documentary biopic on a famous soccer player, set for a 2026 release. The deal underscores Netflix's continued push into high-profile sports-related content.",
            "publisher": "about.netflix.com",
            "url_raw": "https://about.netflix.com/en/news/netflix-scores-exclusive-rights-to-legendary-biopic",
            "url_canonical": "https://about.netflix.com/en/news/netflix-scores-exclusive-rights-to-legendary-biopic",
            "http_status": "200",
            "archived_url": "",
            "language": "en",
            "out_of_window": false
        }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('Todos los Países') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('Todos los Países') || contentFilters.country.includes(item.country);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group, idPrefix) {
        let html = '';
        allItems.forEach(item => {
            const id = `${idPrefix}-${item.replace(/[^a-zA-Z0-9]/g, '')}`;
            html += `<div class="filter-checkbox-item"><input type="checkbox" id="${id}" value="${item}" class="mr-2 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"><label for="${id}" class="text-sm text-gray-700">${item}</label></div>`;
        });
        container.innerHTML = html;
    }

    function updateNewsFilters() {
        populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES, 'country', 'news-country');
        populateCheckboxes(newsFilterCompanyContainer, ALL_NEWS_COMPANIES.sort(), 'company', 'news-company');
        populateCheckboxes(newsFilterCategoryContainer, ALL_NEWS_CATEGORIES.sort(), 'category', 'news-category');
        newsFilterCountryContainer.addEventListener('change', filterNews);
        newsFilterCompanyContainer.addEventListener('change', filterNews);
        newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
        populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES, 'country', 'content-country');
        populateCheckboxes(contentFilterCompanyContainer, ALL_CONTENT_COMPANIES.sort(), 'company', 'content-company');
        populateCheckboxes(contentFilterCategoryContainer, ALL_CONTENT_CATEGORIES.sort(), 'category', 'content-category');
        contentFilterCountryContainer.addEventListener('change', filterContentNews);
        contentFilterCompanyContainer.addEventListener('change', filterContentNews);
        contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== Lógica de filtros ==== */
    function getSelected(container) {
        return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function filterNews() {
        newsFilters.country = getSelected(newsFilterCountryContainer);
        newsFilters.company = getSelected(newsFilterCompanyContainer);
        newsFilters.category = getSelected(newsFilterCategoryContainer);
        renderNewsCards();
    }
    function filterContentNews() {
        contentFilters.country = getSelected(contentFilterCountryContainer);
        contentFilters.company = getSelected(contentFilterCompanyContainer);
        contentFilters.category = getSelected(contentFilterCategoryContainer);
        renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));

    document.getElementById('news-reset-filters').addEventListener('click', () => {
        [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
            Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
        });
        filterNews();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
        [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
            Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
        });
        filterContentNews();
    });

    // Initial Load
    document.addEventListener('DOMContentLoaded', () => {
        updateSentimentContent('Brasil');
        updateNewsFilters(); 
        renderNewsCards();
        updateContentNewsFilters(); 
        renderContentNewsCards();
    });
  </script>
</body>
</html>
