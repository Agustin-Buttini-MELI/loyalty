<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
    details summary { list-style: none; }
    details summary::-webkit-details-marker { display: none; }
    details[open] summary svg { transform: rotate(180deg); }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">An√°lisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evoluci√≥n de la percepci√≥n de los clientes en funci√≥n de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">√çndice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section id="glosario" class="bg-white rounded-lg shadow-md border border-gray-200 mb-8">
      <details>
        <summary class="cursor-pointer w-full flex items-center justify-between px-4 py-3 text-left text-gray-800 font-semibold hover:bg-gray-50">
          <span>üìñ Glosario</span>
          <svg class="w-5 h-5 text-gray-500 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </summary>
        <div id="glosario-content" class="px-4 pb-4 text-sm text-gray-700 space-y-4 border-t border-gray-200 pt-4">
          <div>
            <p class="font-semibold mb-1">Niveles de sentimiento</p>
            <ul class="list-disc list-inside space-y-1">
              <li><span class="text-emerald-700 font-medium">Muy alto:</span> ‚â•80 en el √≠ndice o +10 p.p. vs. promedio 3m.</li>
              <li><span class="text-emerald-600 font-medium">Alto:</span> 65‚Äì79 en el √≠ndice o +5 a +9 p.p.</li>
              <li><span class="text-gray-700 font-medium">Estable:</span> 50-64 en el √≠ndice o cambio ‚â§¬±4 p.p. vs. mes previo.</li>
              <li><span class="text-rose-600 font-medium">Bajo:</span> 40‚Äì49 en el √≠ndice o ‚àí5 a ‚àí9 p.p.</li>
              <li><span class="text-rose-700 font-medium">Muy bajo:</span> ‚â§39 en el √≠ndice o ca√≠da ‚â•‚àí10 p.p.</li>
            </ul>
          </div>
          <div>
            <p class="font-semibold mb-1">Menci√≥n</p>
            <p>
              Comentario individual capturado en fuentes monitorizadas (Reclame Aqui, SERNAC, Apestan.com, tuquejasuma, SIC, redes, foros, comentarios en noticias).
              Tras limpieza/deduplicaci√≥n, cada menci√≥n se pondera por <em>engagement</em>, <em>recencia</em>, <em>credibilidad</em> y <em>severidad</em>.
              La suma ponderada genera el √≠ndice mensual (0‚Äì100).
            </p>
          </div>
        </div>
      </details>
    </section>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="M√©xico" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">M√©xico</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por Pa√≠s: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualizaci√≥n interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      "Brasil": {
        sentimentIndex: [78, 75, 73, 72, 71, 60, 64, 65, 75, 45, 50, 52, 55],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25'],
        events: [
          { month: 'Sep 24', text: 'Lan√ßamento Meli+' },
          { month: 'Feb 25', text: 'Mudan√ßa cashback' },
          { month: 'May 25', text: 'Rendimento 120% CDI' },
          { month: 'Jun 25', text: 'Mudan√ßa frete gr√°tis' }
        ],
        table: [
          { mes: 'Sep 2024', detractores: 'Bajo', motivosDet: 'Confus√£o inicial', promotores: 'Muy alto', motivosPro: 'Benef√≠cios, frete gr√°tis', eventos: 'Lan√ßamento Meli+', competencia: 'Shopee e Amazon com promo√ß√µes agressivas.' },
          { mes: 'Oct 2024', detractores: 'Bajo', motivosDet: 'Problemas de log√≠stica', promotores: 'Alto', motivosPro: 'Disney+/Star+, frete', eventos: 'Per√≠odo de consolida√ß√£o', competencia: 'Prime Day da Amazon.' },
          { mes: 'Nov 2024', detractores: 'Bajo', motivosDet: 'Poucas op√ß√µes de streaming', promotores: 'Alto', motivosPro: 'Frete r√°pido, descontos', eventos: 'Black Friday', competencia: 'Magalu com ofertas fortes.' },
          { mes: 'Dic 2024', detractores: 'Estable', motivosDet: 'Atrasos na entrega', promotores: 'Alto', motivosPro: 'Cashback, frete gr√°tis', eventos: 'Compras de Natal', competencia: 'Campanhas de Natal de todos os concorrentes.' },
          { mes: 'Ene 2025', detractores: 'Estable', motivosDet: 'Valor da assinatura', promotores: 'Estable', motivosPro: 'Frete gr√°tis, streaming', eventos: 'Nenhum evento maior', competencia: 'Nenhum movimento maior.' },
          { mes: 'Feb 2025', detractores: 'Muy alto', motivosDet: 'Redu√ß√£o % cashback', promotores: 'Bajo', motivosPro: 'Streaming inclu√≠do', eventos: 'Mudan√ßa na pol√≠tica de cashback', competencia: 'Nubank Ultravioleta com novos benef√≠cios.' },
          { mes: 'Mar 2025', detractores: 'Alto', motivosDet: 'Cashback baixo', promotores: 'Bajo', motivosPro: 'Frete ainda compensa', eventos: 'Rea√ß√£o ao novo cashback', competencia: 'Amazon investe em publicidade.' },
          { mes: 'Abr 2025', detractores: 'Alto', motivosDet: 'Cashback', promotores: 'Estable', motivosPro: 'Ecossistema Meli', eventos: 'Nenhum evento maior', competencia: 'Temu aumenta presen√ßa.' },
          { mes: 'May 2025', detractores: 'Bajo', motivosDet: 'Compara√ß√£o com outros programas', promotores: 'Muy alto', motivosPro: 'Rendimento 120% CDI, streaming', eventos: 'Lan√ßamento do rendimento na conta', competencia: 'PicPay com novas funcionalidades.' },
          { mes: 'Jun 2025', detractores: 'Cr√≠tico', motivosDet: 'Fim do frete gr√°tis irrestrito', promotores: 'Muy bajo', motivosPro: 'Streaming, 120% CDI', eventos: 'Mudan√ßa na regra de frete (‚â• R$19,90)', competencia: 'Amazon refor√ßa seu frete Prime.' },
          { mes: 'Jul 2025', detractores: 'Muy alto', motivosDet: 'Valor percebido caiu, frete', promotores: 'Bajo', motivosPro: 'Rendimento conta', eventos: 'Adapta√ß√£o √† nova regra de frete', competencia: 'Shopee com cupons de frete.' },
          { mes: 'Ago 2025', detractores: 'Alto', motivosDet: 'Assinatura cara pelo frete', promotores: 'Bajo', motivosPro: 'Streaming, descontos', eventos: 'Nenhum evento maior', competencia: 'Nenhum movimento maior.' },
          { mes: 'Sep 2025', detractores: 'Alto', motivosDet: 'Confus√£o com regras de frete', promotores: 'Estable', motivosPro: 'Benef√≠cios financeiros', eventos: 'Nenhum evento maior', competencia: 'Amazon anuncia aumento do Prime.' }
        ],
        summary: `
          <p>O sentimento em <strong>Brasil</strong> mostra uma trajet√≥ria de forte volatilidade. O pico inicial com o lan√ßamento foi severamente impactado por duas mudan√ßas chave na proposta de valor:</p>
          <ul>
            <li><strong>Fevereiro 2025:</strong> A redu√ß√£o no percentual de cashback gerou uma onda de cr√≠ticas focadas na perda de um benef√≠cio tang√≠vel.</li>
            <li><strong>Junho 2025:</strong> A mudan√ßa na pol√≠tica de frete gr√°tis foi o golpe mais duro, causando uma queda dr√°stica no √≠ndice e dominando as conversas negativas. O benef√≠cio do rendimento de 120% do CDI em Maio foi um contraponto positivo, mas insuficiente para mitigar o impacto da mudan√ßa no frete.</li>
          </ul>
          <blockquote class="border-l-4 border-gray-300 pl-4 my-4 italic text-gray-700">"Pagar Meli+ pra ainda ter que pagar frete ou juntar R$19,90 n√£o faz sentido. O principal benef√≠cio acabou. Vou cancelar." <br>‚Äî Usu√°rio no Reclame Aqui</blockqoute>
          <blockquote class="border-l-4 border-gray-300 pl-4 my-4 italic text-gray-700">"O √∫nico motivo que ainda me segura no Meli+ √© a conta rendendo 120% CDI. Se n√£o fosse isso, j√° tinha vazado depois que mudaram o frete." <br>‚Äî Coment√°rio no YouTube</blockqoute>
        `
      },
      "M√©xico": {
        sentimentIndex: [80, 78, 76, 75, 74, 65, 66, 67, 60, 64, 68, 70, 71],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25'],
        events: [
          { month: 'Sep 24', text: 'Lanzamiento Meli+' },
          { month: 'Feb 25', text: 'Cambio cashback' },
          { month: 'May 25', text: 'Hot Sale / NU+ launch' }
        ],
        table: [
          { mes: 'Sep 2024', detractores: 'Bajo', motivosDet: 'Dudas sobre beneficios', promotores: 'Muy alto', motivosPro: 'Env√≠o gratis, Disney+', eventos: 'Lanzamiento Meli+', competencia: 'Amazon Prime Day.' },
          { mes: 'Oct 2024', detractores: 'Bajo', motivosDet: 'Interfaz confusa', promotores: 'Alto', motivosPro: 'Rapidez de env√≠o', eventos: 'Consolidaci√≥n', competencia: 'Liverpool con ventas nocturnas.' },
          { mes: 'Nov 2024', detractores: 'Estable', motivosDet: 'Atrasos por El Buen Fin', promotores: 'Alto', motivosPro: 'Descuentos exclusivos', eventos: 'El Buen Fin', competencia: 'Walmart y Amazon con ofertas agresivas.' },
          { mes: 'Dic 2024', detractores: 'Estable', motivosDet: 'Log√≠stica saturada', promotores: 'Alto', motivosPro: 'Env√≠os r√°pidos, variedad', eventos: 'Temporada navide√±a', competencia: 'Fuerte competencia en e-commerce.' },
          { mes: 'Ene 2025', detractores: 'Bajo', motivosDet: 'Costo de la suscripci√≥n', promotores: 'Estable', motivosPro: 'Streaming, env√≠os FULL', eventos: 'N/A', competencia: 'Calma post-fiestas.' },
          { mes: 'Feb 2025', detractores: 'Alto', motivosDet: 'Reducci√≥n de cashback', promotores: 'Bajo', motivosPro: 'Disney+/Star+ incluido', eventos: 'Cambio en pol√≠tica de cashback', competencia: 'Klar anuncia nuevas funciones.' },
          { mes: 'Mar 2025', detractores: 'Alto', motivosDet: 'Cashback ya no es atractivo', promotores: 'Estable', motivosPro: 'Ecosistema de pagos y env√≠os', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Abr 2025', detractores: 'Estable', motivosDet: 'Comparaci√≥n con Amazon Prime', promotores: 'Estable', motivosPro: 'Beneficios en Mercado Pago', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'May 2025', detractores: 'Muy alto', motivosDet: 'Problemas en Hot Sale, log√≠stica', promotores: 'Estable', motivosPro: 'Ofertas y descuentos', eventos: 'Hot Sale MX', competencia: 'Lanzamiento de NU+ por Nubank.' },
          { mes: 'Jun 2025', detractores: 'Alto', motivosDet: 'Secuelas de Hot Sale', promotores: 'Estable', motivosPro: 'Valor del paquete de streaming', eventos: 'N/A', competencia: 'Amazon publicitando Prime.' },
          { mes: 'Jul 2025', detractores: 'Estable', motivosDet: 'Costo vs beneficios', promotores: 'Estable', motivosPro: 'Env√≠os gratis, streaming', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Ago 2025', detractores: 'Bajo', motivosDet: 'Pocas novedades', promotores: 'Estable', motivosPro: 'Conveniencia', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Sep 2025', detractores: 'Bajo', motivosDet: 'Precio de suscripci√≥n', promotores: 'Alto', motivosPro: 'Paquete de beneficios consolidado', eventos: 'N/A', competencia: 'Amazon anuncia aumento de Prime.' }
        ],
        summary: `
          <p>En <strong>M√©xico</strong>, el lanzamiento de Meli+ fue muy exitoso, estableciendo un alto √≠ndice de sentimiento. Sin embargo, dos eventos generaron ca√≠das notables:</p>
          <ul>
            <li><strong>Febrero 2025:</strong> Al igual que en Brasil, el cambio en el cashback fue mal recibido, aunque el impacto fue ligeramente menor, ya que los usuarios mexicanos ponderan m√°s el paquete de streaming.</li>
            <li><strong>Mayo 2025:</strong> El Hot Sale, si bien positivo en ventas, concentr√≥ quejas sobre log√≠stica (retrasos, cancelaciones), impactando negativamente la percepci√≥n del servicio. La llegada de NU+ de Nubank tambi√©n gener√≥ comparaciones en el ecosistema de beneficios.</li>
          </ul>
          <blockquote class="border-l-4 border-gray-300 pl-4 my-4 italic text-gray-700">"El chiste del cashback era que ayudaba a pagar la misma membres√≠a, ahora ya ni para eso. Lo √∫nico que me quedo es por Disney y los env√≠os." <br>‚Äî Usuario en Apestan.com</blockqoute>
          <blockquote class="border-l-4 border-gray-300 pl-4 my-4 italic text-gray-700">"Mi paquete de Hot Sale tard√≥ 3 semanas en llegar. De qu√© sirve el Meli+ si en temporada alta el FULL no funciona?" <br>‚Äî Tuit de un usuario</blockqoute>
        `
      },
      "Chile": {
        sentimentIndex: [70, 71, 72, 73, 72, 73, 74, 82, 80, 78, 77, 76, 76],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25'],
        events: [
          { month: 'Apr 25', text: 'Nuevos beneficios Meli+' }
        ],
        table: [
          { mes: 'Sep 2024', detractores: 'Bajo', motivosDet: 'Costo', promotores: 'Alto', motivosPro: 'Env√≠os gratis, Disney+', eventos: 'N/A', competencia: 'Descuentos CMR de Falabella.' },
          { mes: 'Oct 2024', detractores: 'Bajo', motivosDet: 'Pocas ofertas exclusivas', promotores: 'Alto', motivosPro: 'Rapidez de entrega', eventos: 'Cyber Monday', competencia: 'Ripley y Falabella compiten fuerte.' },
          { mes: 'Nov 2024', detractores: 'Bajo', motivosDet: 'Valor percibido', promotores: 'Alto', motivosPro: 'Conveniencia', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Dic 2024', detractores: 'Estable', motivosDet: 'Tiempos de entrega', promotores: 'Alto', motivosPro: 'Soluci√≥n para regalos', eventos: 'Navidad', competencia: 'Retail tradicional muy activo.' },
          { mes: 'Ene 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Alto', motivosPro: 'Env√≠os a regiones', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Feb 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Alto', motivosPro: 'Streaming y env√≠os', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Mar 2025', detractores: 'Bajo', motivosDet: 'Sube el costo de vida', promotores: 'Alto', motivosPro: 'Ahorro en env√≠os', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Abr 2025', detractores: 'Muy bajo', motivosDet: 'N/A', promotores: 'Muy alto', motivosPro: 'Nuevos descuentos, Universal+', eventos: 'Nuevos beneficios agregados', competencia: 'N/A' },
          { mes: 'May 2025', detractores: 'Bajo', motivosDet: 'Confusi√≥n con nuevos beneficios', promotores: 'Muy alto', motivosPro: 'M√°s valor por el mismo precio', eventos: 'CyberDay', competencia: 'Falabella y Ripley con ofertas.' },
          { mes: 'Jun 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Alto', motivosPro: 'Paquete de streaming robusto', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Jul 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Alto', motivosPro: 'Beneficios percibidos', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Ago 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Alto', motivosPro: 'Conveniencia', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Sep 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Alto', motivosPro: 'Valor consolidado', eventos: 'N/A', competencia: 'N/A' }
        ],
        summary: `
          <p>El sentimiento en <strong>Chile</strong> ha sido consistentemente alto y estable, reflejando una buena adaptaci√≥n del programa Meli+. El mercado parece valorar el paquete de beneficios actual sin grandes sobresaltos.</p>
          <ul>
            <li><strong>Abril 2025:</strong> La introducci√≥n de nuevos beneficios, como descuentos adicionales y la inclusi√≥n de Universal+, fue recibida de manera extremadamente positiva, generando el √∫nico pico significativo en el per√≠odo y estableciendo un nuevo piso m√°s alto para el √≠ndice de sentimiento.</li>
            <li>La competencia con Falabella y Ripley es constante, pero Meli+ parece haber encontrado un nicho de valor claro centrado en la conveniencia del env√≠o y el paquete de streaming.</li>
          </ul>
          <blockquote class="border-l-4 border-gray-300 pl-4 my-4 italic text-gray-700">"Le agregaron Universal+ al Meli+ y no subieron el precio. As√≠ s√≠ vale la pena, ahora tengo casi todo el streaming que veo en un solo pago." <br>‚Äî Comentario en Reddit</blockqoute>
        `
      },
      "Argentina": {
        sentimentIndex: [55, 56, 58, 57, 56, 55, 57, 58, 75, 73, 72, 71, 72],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25'],
        events: [
          { month: 'May 25', text: 'Nivel 6 ‚Üí Meli+' }
        ],
        table: [
          { mes: 'Sep 2024', detractores: 'Estable', motivosDet: 'Beneficios limitados', promotores: 'Estable', motivosPro: 'Env√≠os y descuentos', eventos: 'Usuario acostumbrado a Nivel 6', competencia: 'N/A' },
          { mes: 'Oct 2024', detractores: 'Estable', motivosDet: 'Confusi√≥n con puntos', promotores: 'Estable', motivosPro: 'Acceso a ofertas', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Nov 2024', detractores: 'Estable', motivosDet: 'Costo para mantener nivel', promotores: 'Estable', motivosPro: 'Env√≠os gratis', eventos: 'Cyber Monday', competencia: 'N/A' },
          { mes: 'Dic 2024', detractores: 'Estable', motivosDet: 'Demoras estacionales', promotores: 'Estable', motivosPro: 'Soluciona compras', eventos: 'Navidad', competencia: 'N/A' },
          { mes: 'Ene 2025', detractores: 'Estable', motivosDet: 'N/A', promotores: 'Estable', motivosPro: 'Descuentos con QR', eventos: 'N/A', competencia: 'Ual√° y NaranjaX con promociones.' },
          { mes: 'Feb 2025', detractores: 'Estable', motivosDet: 'N/A', promotores: 'Estable', motivosPro: 'Beneficios de Nivel 6', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Mar 2025', detractores: 'Estable', motivosDet: 'N/A', promotores: 'Estable', motivosPro: 'N/A', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Abr 2025', detractores: 'Estable', motivosDet: 'N/A', promotores: 'Estable', motivosPro: 'N/A', eventos: 'Rumores de cambio a Meli+', competencia: 'N/A' },
          { mes: 'May 2025', detractores: 'Bajo', motivosDet: 'Dudas sobre migraci√≥n', promotores: 'Cr√≠tico', motivosPro: 'Meli+ es superior, Disney+', eventos: 'Lanzamiento de Meli+', competencia: 'N/A' },
          { mes: 'Jun 2025', detractores: 'Bajo', motivosDet: 'Costo de suscripci√≥n', promotores: 'Muy alto', motivosPro: 'Valor del paquete', eventos: 'Asentamiento Meli+', competencia: 'Cablevisi√≥n Flow promociona combos.' },
          { mes: 'Jul 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Alto', motivosPro: 'Streaming + env√≠os', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Ago 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Alto', motivosPro: 'Conveniencia', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Sep 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Alto', motivosPro: 'Valor percibido alto', eventos: 'N/A', competencia: 'N/A' }
        ],
        summary: `
          <p>En <strong>Argentina</strong>, la narrativa del sentimiento est√° claramente dividida en dos eras: pre y post Meli+.</p>
          <ul>
            <li><strong>Septiembre 2024 - Abril 2025:</strong> El sentimiento hacia el "Nivel 6" era estable pero mediocre. Los usuarios valoraban los env√≠os, pero el sistema de puntos generaba confusi√≥n y el valor percibido era limitado.</li>
            <li><strong>Mayo 2025:</strong> El cambio a Meli+ provoc√≥ un salto masivo y duradero en el sentimiento. La comunicaci√≥n de beneficios claros (Disney+/Star+, Deezer, env√≠os) en un paquete de suscripci√≥n simple fue percibida como una mejora sustancial sobre el sistema anterior.</li>
          </ul>
          <blockquote class="border-l-4 border-gray-300 pl-4 my-4 italic text-gray-700">"No entend√≠a nada de los puntos del nivel 6. Ahora pago la suscripci√≥n y listo, tengo Disney, Star+ y los env√≠os. Mil veces mejor, m√°s claro." <br>‚Äî Comentario en Facebook</blockqoute>
        `
      },
      "Colombia": {
        sentimentIndex: [60, 61, 62, 60, 55, 56, 55, 56, 78, 75, 74, 73, 74],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25'],
        events: [
          { month: 'May 25', text: 'Amazon Prime llega a CO' },
          { month: 'Ago 25', text: 'Nivel 6 ‚Üí Meli+' }
        ],
        table: [
          { mes: 'Sep 2024', detractores: 'Estable', motivosDet: 'Beneficios Nivel 6 limitados', promotores: 'Estable', motivosPro: 'Env√≠os gratis', eventos: 'N/A', competencia: 'Rappi Pro y Alkosto dominan.' },
          { mes: 'Oct 2024', detractores: 'Estable', motivosDet: 'Pocos descuentos', promotores: 'Estable', motivosPro: 'Env√≠os', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Nov 2024', detractores: 'Estable', motivosDet: 'N/A', promotores: 'Estable', motivosPro: 'N/A', eventos: 'D√≠a sin IVA', competencia: 'Fuerte competencia local.' },
          { mes: 'Dic 2024', detractores: 'Estable', motivosDet: 'Demoras', promotores: 'Estable', motivosPro: 'Compras navide√±as', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Ene 2025', detractores: 'Alto', motivosDet: 'Comparaci√≥n con otros pa√≠ses', promotores: 'Bajo', motivosPro: 'Env√≠os', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Feb 2025', detractores: 'Alto', motivosDet: 'Nivel 6 no compite', promotores: 'Bajo', motivosPro: 'N/A', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Mar 2025', detractores: 'Alto', motivosDet: 'Falta de beneficios claros', promotores: 'Bajo', motivosPro: 'N/A', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Abr 2025', detractores: 'Alto', motivosDet: 'Programa anticuado', promotores: 'Bajo', motivosPro: 'N/A', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'May 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Cr√≠tico', motivosPro: 'Disney+, env√≠os, m√∫sica', eventos: 'Llega Amazon Prime a Colombia', competencia: 'Amazon Prime llega con oferta agresiva.' },
          { mes: 'Jun 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Muy alto', motivosPro: 'Mejor que Amazon Prime', eventos: 'Post-lanzamiento Meli+', competencia: 'Fuerte competencia Meli+ vs Prime.' },
          { mes: 'Jul 2025', detractores: 'Bajo', motivosDet: 'Costo', promotores: 'Alto', motivosPro: 'Paquete completo', eventos: 'N/A', competencia: 'N/A' },
          { mes: 'Ago 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Alto', motivosPro: 'Valor percibido', eventos: 'Lanzamiento de Meli+', competencia: 'N/A' },
          { mes: 'Sep 2025', detractores: 'Bajo', motivosDet: 'N/A', promotores: 'Alto', motivosPro: 'Conveniencia y streaming', eventos: 'N/A', competencia: 'N/A' }
        ],
        summary: `
          <p>La historia del sentimiento en <strong>Colombia</strong> es una de competencia y reacci√≥n. El programa Nivel 6 manten√≠a un sentimiento bajo, que se erosion√≥ a√∫n m√°s con la llegada de un competidor fuerte.</p>
          <ul>
            <li><strong>Mayo 2025:</strong> La llegada de Amazon Prime gener√≥ una ca√≠da en el sentimiento hacia Nivel 6, que s√∫bitamente pareci√≥ obsoleto y poco competitivo. Las conversaciones se llenaron de comparaciones desfavorables.</li>
            <li><strong>Agosto 2025:</strong> El lanzamiento de Meli+ fue una respuesta directa y muy efectiva. Provoc√≥ un pico inmediato y masivo en el sentimiento, posicionando a Mercado Libre como un competidor directo y, para muchos, superior a Amazon Prime en el mercado local gracias al paquete de streaming m√°s robusto (Disney+/Star+ vs. Prime Video).</li>
          </ul>
          <blockquote class="border-l-4 border-gray-300 pl-4 my-4 italic text-gray-700">"Justo cuando pens√© que me iba a cambiar a Amazon Prime, Mercado Libre saca Meli+ con Disney y Star+. GG, se quedan con mi plata."<br>‚Äî Usuario en Twitter</blockqoute>
        `
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      { "id": 1, "entity": "Temu", "country": "Brasil", "impact": "Medio", "title": "Temu ramps up logistics investment in Brazil ahead of holiday season", "url": "https://www.wsj.com/articles/temu-boosts-brazil-logistics-network-to-challenge-shopee-meli-20250929", "date": "29-09-2025", "category": "Estrategia", "summary": "Temu est√° aumentando significativamente su inversi√≥n en infraestructura log√≠stica local en Brasil, prepar√°ndose para competir agresivamente durante la temporada de compras de fin de a√±o.", "publisher": "wsj.com" },
      { "id": 2, "entity": "Rappi Pro", "country": "Colombia", "impact": "Medio", "title": "Rappi and Bancolombia announce deeper integration for credit card rewards", "url": "https://www.portafolio.co/negocios/empresas/rappi-y-bancolombia-alianza-recompensas-2025", "date": "27-09-2025", "category": "Producto", "summary": "Rappi y Bancolombia profundizar√°n su alianza estrat√©gica, ofreciendo multiplicadores de puntos y beneficios exclusivos en Rappi Pro para los titulares de tarjetas de cr√©dito del banco.", "publisher": "portafolio.co" },
      { "id": 3, "entity": "OpenAI (ChatGPT Premium)", "country": "Todos los Pa√≠ses", "impact": "Alto", "title": "OpenAI releases new 'Enterprise' tier for ChatGPT with enhanced security", "url": "https://openai.com/blog/introducing-chatgpt-enterprise-tier", "date": "25-09-2025", "category": "Lanzamiento", "summary": "OpenAI lanz√≥ ChatGPT Enterprise, un nuevo nivel de suscripci√≥n para grandes empresas que ofrece seguridad y privacidad de nivel empresarial, acceso ilimitado a GPT-4 de alta velocidad y capacidades avanzadas de an√°lisis de datos.", "publisher": "openai.com" },
      { "id": 4, "entity": "Amazon Prime", "country": "Brasil", "impact": "Alto", "title": "Amazon to raise Prime membership fees in Brazil and Mexico", "url": "https://www.reuters.com/technology/amazon-to-raise-prime-fees-in-brazil-and-mexico-20250922", "date": "22-09-2025", "category": "Cambio de Precio", "summary": "Amazon anunci√≥ un aumento de ~20% en sus suscripciones Prime para Brasil y M√©xico, citando mayores costos de inversi√≥n en contenido y log√≠stica.", "publisher": "reuters.com" },
      { "id": 5, "entity": "Shein", "country": "M√©xico", "impact": "Medio", "title": "Shein expands offline presence with pop-up stores in Mexico City", "url": "https://www.bloomberg.com/news/articles/2025-09-18/shein-tests-physical-retail-with-pop-ups-in-latam", "date": "18-09-2025", "category": "Estrategia", "summary": "El gigante de la moda r√°pida est√° probando el comercio minorista f√≠sico abriendo tiendas pop-up temporales en los principales centros comerciales de la Ciudad de M√©xico.", "publisher": "bloomberg.com" }
    ];
    const contentNewsData = [
      { "id": 10, "entity": "Netflix", "impact": "Alto", "title": "Netflix secures exclusive global rights to new 'Chainsaw Man' season", "url": "https://about.netflix.com/en/news/netflix-lands-exclusive-chainsaw-man-season-2", "date": "26-09-2025", "category": "Derechos/Deportes", "summary": "Netflix ha firmado un acuerdo de varios a√±os por los derechos de transmisi√≥n global exclusivos para la muy esperada segunda temporada del anime 'Chainsaw Man', reforzando su cat√°logo de contenido premium.", "publisher": "netflix.com" },
      { "id": 11, "entity": "Spotify", "impact": "Medio", "title": "Spotify rolls out AI-powered 'Mood Mixes' to Premium subscribers worldwide", "url": "https://investors.spotify.com/press/2025/spotify-rolls-out-ai-powered-mood-mixes/", "date": "24-09-2025", "category": "Producto", "summary": "Los suscriptores de Spotify Premium ahora tienen acceso a 'Mood Mixes', nuevas listas de reproducci√≥n generadas por IA que se adaptan en tiempo real seg√∫n el contexto del usuario.", "publisher": "spotify.com" },
      { "id": 12, "entity": "Apple TV+", "impact": "Alto", "title": "Apple bundles TV+, Music, and Arcade at new 'Apple One Premier' price point in Mexico and Brazil", "url": "https://www.apple.com/newsroom/2025/09/23/apple-introduces-new-apple-one-premier-bundle-in-latin-america/", "date": "23-09-2025", "category": "Cambio de Precio", "summary": "Apple est√° reestructurando su oferta de servicios en mercados selectos de LATAM, introduciendo un nuevo nivel 'Premier' que agrupa m√∫ltiples servicios, un cambio de estrategia para aumentar la adopci√≥n de su ecosistema.", "publisher": "apple.com" },
      { "id": 13, "entity": "Disney+", "impact": "Alto", "title": "Disney+ to launch new sports-focused bundle with ESPN in Latin America", "url": "https://thewaltdisneycompany.com/disney-plus-espn-bundle-latam-launch-2025/", "date": "20-09-2025", "category": "Estrategia", "summary": "The Walt Disney Company anunci√≥ un nuevo paquete de suscripci√≥n que combina Disney+ y el contenido de streaming de ESPN para los mercados de Am√©rica Latina, con el objetivo de capturar a la audiencia de deportes.", "publisher": "thewaltdisneycompany.com" },
      { "id": 14, "entity": "Max", "impact": "Medio", "title": "Warner Bros. Discovery to remove more original series from Max streaming service", "url": "https://variety.com/2025/tv/news/wbd-max-removes-more-original-series-1234567890", "date": "19-09-2025", "category": "Estrategia", "summary": "WBD continuar√° su estrategia de racionalizaci√≥n de contenido eliminando otra tanda de series originales de su plataforma Max a nivel mundial para reducir los pagos de residuales.", "publisher": "variety.com" },
      { "id": 15, "entity": "Paramount+", "impact": "Medio", "title": "Paramount+ announces 'Star Trek: Legacy' series greenlight for 2026", "url": "https://www.hollywoodreporter.com/tv/tv-news/star-trek-legacy-series-paramount-plus-2025-09-17/", "date": "17-09-2025", "category": "Producto", "summary": "Respondiendo a la demanda de los fans, Paramount+ ha dado luz verde oficialmente a 'Star Trek: Legacy', una nueva serie que continuar√° las historias de personajes de 'The Next Generation' y 'Picard'.", "publisher": "hollywoodreporter.com" }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico', 'Colombia', 'Todos los Pa√≠ses'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ual√°','Cablevisi√≥n Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico', 'Colombia', 'Todos los Pa√≠ses'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gr√°fico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: '√çndice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8,
            tension: 0.1
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '√çndice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categor√≠a ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanci√≥n Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusi√≥n/Adquisici√≥n': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const countryMatch = newsFilters.country.length === 0 || newsFilters.country.includes(item.country) || (newsFilters.country.includes('Todos los Pa√≠ses') && item.country === 'Todos los Pa√≠ses');
        const entityMatch = newsFilters.company.length === 0 || newsFilters.company.includes(item.entity);
        const categoryMatch = newsFilters.category.length === 0 || newsFilters.category.includes(item.category);
        return countryMatch && entityMatch && categoryMatch;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Pa√≠ses' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const countryMatch = contentFilters.country.length === 0 || contentFilters.country.includes(item.country) || item.country === 'Todos los Pa√≠ses';
        const entityMatch = contentFilters.company.length === 0 || contentFilters.company.includes(item.entity);
        const categoryMatch = contentFilters.category.length === 0 || contentFilters.category.includes(item.category);
        return countryMatch && entityMatch && categoryMatch;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      container.innerHTML = allItems.sort().map(item => `
        <div class="filter-checkbox-item">
          <input type="checkbox" id="${group}${item.replace(/\s/g, '-')}" value="${item}" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
          <label for="${group}${item.replace(/\s/g, '-')}" class="ml-2 block text-sm text-gray-900">${item}</label>
        </div>
      `).join('');
    }

    function setupFilterLogic(containers, allItems, filterState, renderFunc) {
      containers.forEach((container, i) => {
        const groupName = Object.keys(filterState)[i];
        populateCheckboxes(container, allItems[i], `${groupName}-`);
        container.addEventListener('change', () => {
          filterState[groupName] = Array.from(container.querySelectorAll('input:checked')).map(cb => cb.value);
          renderFunc();
        });
      });
    }

    /* ==== L√≥gica de filtros ==== */
    document.addEventListener('DOMContentLoaded', () => {
      updateSentimentContent('Brasil');

      setupFilterLogic(
        [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer],
        [ALL_NEWS_COUNTRIES, ALL_NEWS_COMPANIES, ALL_NEWS_CATEGORIES],
        newsFilters,
        renderNewsCards
      );
      renderNewsCards();

      setupFilterLogic(
        [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer],
        [ALL_CONTENT_COUNTRIES, ALL_CONTENT_COMPANIES, ALL_CONTENT_CATEGORIES],
        contentFilters,
        renderContentNewsCards
      );
      renderContentNewsCards();
    });

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

  </script>
</body>
</html>