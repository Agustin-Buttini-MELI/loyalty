<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      "Brasil": {
        "sentimentIndex": [75, 78, 80, 79, 77, 68, 70, 72, 75, 62, 65, 68, 70],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Rendimiento 120% CDI" },
          { "month": "Jun 25", "text": "Cambio en envíos gratis" }
        ],
        "table": [
          { "mes": "Sep 25", "detractores": "Medio", "motivosDet": "Beneficios reducidos", "promotores": "Alto", "motivosPro": "Rendimiento 120% CDI", "eventos": "Estabilización post-cambios", "competencia": "Amazon/Shopee agresivos en precios" },
          { "mes": "Ago 25", "detractores": "Medio-Alto", "motivosDet": "Envío gratis ya no es diferencial", "promotores": "Alto", "motivosPro": "Rendimiento 120% CDI", "eventos": "Ajuste a nuevos umbrales de envío", "competencia": "Nubank Ultravioleta suma beneficios" },
          { "mes": "Jul 25", "detractores": "Alto", "motivosDet": "Confusión sobre valor de Meli+", "promotores": "Alto", "motivosPro": "Ofertas exclusivas y 120% CDI", "eventos": "Impacto inicial cambio envío gratis", "competencia": "Prime Day de Amazon" },
          { "mes": "Jun 25", "detractores": "Muy Alto", "motivosDet": "Envío gratis ≥ R$19,90", "promotores": "Medio", "motivosPro": "Disney+ y Max", "eventos": "Cambio en política de envíos", "competencia": "Magalu con ofertas agresivas" },
          { "mes": "May 25", "detractores": "Bajo", "motivosDet": "Publicidad en Disney+", "promotores": "Muy Alto", "motivosPro": "Rendimiento 120% CDI", "eventos": "Lanzamiento Cofrinhos 120% CDI", "competencia": "PicPay expande marketplace" },
          { "mes": "Feb 25", "detractores": "Medio", "motivosDet": "Reducción cashback", "promotores": "Alto", "motivosPro": "Paquete de streaming", "eventos": "Ajuste % de cashback", "competencia": "Shopee mejora logística" },
          { "mes": "Sep 24", "detractores": "Bajo", "motivosDet": "Costo de suscripción", "promotores": "Muy Alto", "motivosPro": "Envío gratis y Disney+", "eventos": "Lanzamiento de Meli+", "competencia": "Amazon Prime como incumbente" }
        ],
        "summary": "<h4>Resumen Brasil</h4><p>El sentimiento en Brasil ha sido volátil. El cambio en la política de envío gratis en <strong>junio de 2025</strong> generó la mayor ola de comentarios negativos, percibido como una devaluación del programa. Un usuario en Reclame Aqui comentó: <em>'Pagava o Meli+ pelo frete. Agora que quase tudo tem frete grátis, qual a vantagem? Virou só assinatura de streaming.'</em> Por otro lado, la introducción del rendimiento del <strong>120% CDI en mayo de 2025</strong> fue un gran impulsor, atrayendo a un segmento de usuarios enfocado en beneficios financieros.</p>"
      },
      "México": {
        "sentimentIndex": [78, 81, 82, 80, 79, 72, 74, 76, 82, 80, 79, 78, 77],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Hot Sale / Competencia NU+" }
        ],
        "table": [
          { "mes": "Sep 25", "detractores": "Bajo", "motivosDet": "Costo/beneficio", "promotores": "Alto", "motivosPro": "Velocidad de envío y catálogo", "eventos": "Estabilización del mercado", "competencia": "Amazon y Walmart con campañas de lealtad" },
          { "mes": "May 25", "detractores": "Bajo", "motivosDet": "Publicidad en Disney+", "promotores": "Muy Alto", "motivosPro": "Descuentos Hot Sale", "eventos": "Hot Sale MX", "competencia": "Lanzamiento de NU+ por Nubank" },
          { "mes": "Feb 25", "detractores": "Medio-Alto", "motivosDet": "Reducción de cashback", "promotores": "Alto", "motivosPro": "Paquete de streaming (Max/D+)", "eventos": "Ajuste % de cashback", "competencia": "Amazon publicita envíos mismo día" },
          { "mes": "Sep 24", "detractores": "Bajo", "motivosDet": "Pocos diferenciadores vs Nivel 6", "promotores": "Muy Alto", "motivosPro": "Max incluido, envíos FULL", "eventos": "Lanzamiento de Meli+", "competencia": "Amazon Prime bien establecido" }
        ],
        "summary": "<h4>Resumen México</h4><p>México muestra un sentimiento consistentemente alto, con un pico notable durante el <strong>Hot Sale de mayo de 2025</strong>, donde los beneficios exclusivos para Meli+ fueron muy valorados. La principal queja recurrente, aunque de bajo impacto, es la percepción de que los servicios de streaming incluidos (Disney+/Max) ahora tienen anuncios. Un comentario en X resume bien el sentimiento promotor: <em>'Lo que me ahorro en envíos y en pagar D+ y Max por separado, hace que Meli+ se pague solo. Para mí, sigue siendo el mejor programa de lealtad en México.'</em> La competencia se intensifica con la llegada de NU+.</p>"
      },
      "Chile": {
        "sentimentIndex": [72, 74, 75, 76, 75, 77, 78, 85, 84, 82, 81, 80, 81],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "Abr 25", "text": "Nuevos beneficios Meli+" }
        ],
        "table": [
          { "mes": "Sep 25", "detractores": "Bajo", "motivosDet": "Pocas ofertas bancarias", "promotores": "Alto", "motivosPro": "Envíos gratis y rápidos", "eventos": "Período estable", "competencia": "Falabella y Ripley con descuentos agresivos con sus tarjetas" },
          { "mes": "Abr 25", "detractores": "Muy Bajo", "motivosDet": "Costo de la suscripción", "promotores": "Muy Alto", "motivosPro": "Nuevos descuentos y Universal+", "eventos": "Anuncio de nuevos beneficios", "competencia": "Amazon con bajo perfil" }
        ],
        "summary": "<h4>Resumen Chile</h4><p>Chile experimentó un fuerte impulso positivo en <strong>abril de 2025</strong> con la adición de nuevos beneficios, incluyendo descuentos en más categorías y la integración de Universal+. Los comentarios en foros como Reddit indican una alta satisfacción con la propuesta de valor. Un usuario en el subreddit r/chile mencionó: <em>'Con los descuentos nuevos y el envío gratis que funciona la raja, Meli+ ahora sí le compite de verdad a los beneficios de Falabella/Ripley'</em>. La principal área de oportunidad sigue siendo la integración de más alianzas bancarias para cuotas sin interés, un punto fuerte de la competencia tradicional.</p>"
      },
      "Argentina": {
        "sentimentIndex": [null, null, null, null, null, null, null, null, 65, 68, 70, 72, 74],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "May 25", "text": "Lanzamiento Meli+ (desde Nivel 6)" }
        ],
        "table": [
          { "mes": "Sep 25", "detractores": "Bajo", "motivosDet": "Costo en contexto inflacionario", "promotores": "Alto", "motivosPro": "Ahorro en envíos y streaming", "eventos": "Adaptación consolidada", "competencia": "Poca competencia directa en suscripciones integradas" },
          { "mes": "May 25", "detractores": "Medio", "motivosDet": "Confusión en la transición de Nivel 6", "promotores": "Medio-Alto", "motivosPro": "Acceso a Disney+ y Max", "eventos": "Lanzamiento de Meli+", "competencia": "Ualá y NaranjaX con ecosistemas propios" }
        ],
        "summary": "<h4>Resumen Argentina</h4><p>El lanzamiento de Meli+ en <strong>mayo de 2025</strong>, reemplazando el sistema de Nivel 6, generó una reacción mixta inicial, principalmente por la comunicación del cambio. Plataformas como tuquejasuma.com vieron un alza en consultas sobre 'qué pasó con mis puntos' o 'ahora tengo que pagar por lo que antes era gratis'. Sin embargo, el sentimiento ha mejorado progresivamente a medida que los usuarios comprenden el valor del paquete de streaming. Un comentario popular en un video de YouTube sobre el tema decía: <em>'Al principio me enojé, pero saqué la cuenta y lo que pago por Meli+ es menos que pagar D+ y Max por separado. Y encima tengo envíos gratis. Con esta inflación, conviene.'</em></p>"
      },
      "Colombia": {
        "sentimentIndex": [null, null, null, null, null, null, null, null, null, null, null, 75, 72],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "May 25", "text": "Amazon Prime llega a Colombia" },
          { "month": "Ago 25", "text": "Lanzamiento Meli+ (desde Nivel 6)" }
        ],
        "table": [
          { "mes": "Sep 25", "detractores": "Medio", "motivosDet": "Comparativas con Amazon Prime", "promotores": "Alto", "motivosPro": "Paquete de streaming (D+/Max)", "eventos": "Primer mes completo de operación", "competencia": "Amazon Prime muy activo con publicidad de lanzamiento" },
          { "mes": "Ago 25", "detractores": "Bajo", "motivosDet": "Comunicación del cambio desde Nivel 6", "promotores": "Alto", "motivosPro": "Propuesta de valor clara vs. competencia", "eventos": "Lanzamiento de Meli+", "competencia": "Rappi Pro y Alkosto con ofertas locales" }
        ],
        "summary": "<h4>Resumen Colombia</h4><p>El lanzamiento de Meli+ en <strong>agosto de 2025</strong> fue bien recibido, capitalizando la experiencia aprendida en otros mercados. La propuesta de valor fue percibida como sólida, especialmente frente a la reciente llegada de Amazon Prime en mayo. El diferenciador clave en las conversaciones de redes sociales es el paquete de streaming. Un influencer en TikTok explicó: <em>'Si ya pagas Disney, con un poquito más te llevas Max, envíos gratis en Meli y descuentos. Amazon Prime es bueno, pero en contenido Meli+ lo supera por ahora'</em>. La principal fuente de comentarios detractores es la comparación directa de la velocidad y cobertura de envío con la oferta de lanzamiento de Amazon.</p>"
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      {
        "id": 1,
        "entity": "Amazon Prime",
        "country": "Brasil",
        "impact": "Alto",
        "title": "Amazon Completes Acquisition of Brazilian Logistics Firm Loggi",
        "url": "https://ir.aboutamazon.com/news-release/news-release-details/2025/09/25/amazon-completes-acquisition-loggi/",
        "date": "25-09-2025",
        "category": "Fusión/Adquisición",
        "summary": "Amazon announced the successful completion of its acquisition of Loggi, a leading Brazilian logistics-as-a-service platform, after receiving final approval from Brazil's antitrust regulator, CADE. The deal aims to significantly expand Amazon's last-mile delivery network in the country.",
        "publisher": "ir.aboutamazon.com",
        "url_raw": "https://ir.aboutamazon.com/news-release/news-release-details/2025/09/25/amazon-completes-acquisition-loggi/",
        "url_canonical": "https://ir.aboutamazon.com/news-release/news-release-details/2025/09/25/amazon-completes-acquisition-loggi/",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 2,
        "entity": "OpenAI (ChatGPT Premium)",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "OpenAI Begins Rollout of GPT-5 to ChatGPT Plus Subscribers",
        "url": "https://openai.com/blog/gpt-5-rollout",
        "date": "20-09-2025",
        "category": "Flagship AI",
        "summary": "OpenAI has started a phased rollout of its next-generation flagship model, GPT-5, to all ChatGPT Plus and Enterprise users. The new model boasts significant improvements in reasoning, code generation, and multimodal capabilities.",
        "publisher": "openai.com",
        "url_raw": "https://openai.com/blog/gpt-5-rollout",
        "url_canonical": "https://openai.com/blog/gpt-5-rollout",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 3,
        "entity": "Shein",
        "country": "México",
        "impact": "Medio",
        "title": "Mexico Imposes 20% Tariff on Fast Fashion Imports from Asia, Affecting Shein and Temu",
        "url": "https://www.reuters.com/world/americas/mexico-imposes-20-tariff-fast-fashion-imports-2025-09-18/",
        "date": "18-09-2025",
        "category": "Sanción Legal",
        "summary": "Mexico's Secretary of Economy announced a new 20% tariff on textile and apparel imports from countries without free trade agreements, a move seen as directly targeting fast-fashion giants Shein and Temu. The measure aims to protect local industry.",
        "publisher": "reuters.com",
        "url_raw": "https://www.reuters.com/world/americas/mexico-imposes-20-tariff-fast-fashion-imports-2025-09-18/",
        "url_canonical": "https://www.reuters.com/world/americas/mexico-imposes-20-tariff-fast-fashion-imports-2025-09-18/",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 4,
        "entity": "Nubank Ultravioleta",
        "country": "Brasil",
        "impact": "Medio",
        "title": "Nubank Ultravioleta Adds Global Travel Insurance and Airport Lounge Access",
        "url": "https://blog.nubank.com.br/ultravioleta-novos-beneficios-viagem-2025/",
        "date": "23-09-2025",
        "category": "Producto",
        "summary": "Nubank announced an upgrade to its premium Ultravioleta subscription, adding comprehensive global travel insurance in partnership with Chubb and access to over 1,000 airport lounges worldwide via LoungeKey. The new benefits are available immediately to all Ultravioleta customers.",
        "publisher": "blog.nubank.com.br",
        "url_raw": "https://blog.nubank.com.br/ultravioleta-novos-beneficios-viagem-2025/",
        "url_canonical": "https://blog.nubank.com.br/ultravioleta-novos-beneficios-viagem-2025/",
        "http_status": "200",
        "language": "pt",
        "out_of_window": false
      }
    ];
    const contentNewsData = [
      {
        "id": 101,
        "entity": "Netflix",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Netflix Wins Exclusive Global Streaming Rights for FIFA Club World Cup",
        "url": "https://about.netflix.com/en/news/netflix-secures-fifa-club-world-cup-rights",
        "date": "26-09-2025",
        "category": "Derechos/Deportes",
        "summary": "In a major push into live sports, Netflix announced a multi-year deal with FIFA to become the exclusive global streaming home for the newly expanded FIFA Club World Cup, starting with the 2026 tournament.",
        "publisher": "about.netflix.com",
        "url_raw": "https://about.netflix.com/en/news/netflix-secures-fifa-club-world-cup-rights",
        "url_canonical": "https://about.netflix.com/en/news/netflix-secures-fifa-club-world-cup-rights",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 102,
        "entity": "Disney+",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Disney+ Announces 15% Price Increase for Ad-Free Tier in Latin America",
        "url": "https://thewaltdisneycompany.com/disney-plus-price-update-latam-sep2025/",
        "date": "19-09-2025",
        "category": "Cambio de Precio",
        "summary": "The Walt Disney Company confirmed a price increase for its Disney+ Premium (ad-free) plan across Latin America, set to take effect on December 1, 2025. The company cites investment in new content and rising operational costs.",
        "publisher": "thewaltdisneycompany.com",
        "url_raw": "https://thewaltdisneycompany.com/disney-plus-price-update-latam-sep2025/",
        "url_canonical": "https://thewaltdisneycompany.com/disney-plus-price-update-latam-sep2025/",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 103,
        "entity": "Max",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "WBD CEO David Zaslav Downplays M&A Rumors at Investor Conference",
        "url": "https://www.bloomberg.com/news/articles/2025-09-22/wbd-s-zaslav-says-focus-is-on-debt-and-organic-growth-not-m-a",
        "date": "22-09-2025",
        "category": "Estrategia",
        "summary": "Speaking at the Goldman Sachs Communacopia + Technology Conference, Warner Bros. Discovery CEO David Zaslav stated the company's primary focus remains on reducing its debt and achieving organic growth through its Max streaming service, tamping down recent speculation about a potential merger.",
        "publisher": "bloomberg.com",
        "url_raw": "https://www.bloomberg.com/news/articles/2025-09-22/wbd-s-zaslav-says-focus-is-on-debt-and-organic-growth-not-m-a",
        "url_canonical": "https://www.bloomberg.com/news/articles/2025-09-22/wbd-s-zaslav-says-focus-is-on-debt-and-organic-growth-not-m-a",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 104,
        "entity": "Apple TV+",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "'Foundation' Season 3 Premiere Sets New Viewership Records for Apple TV+",
        "url": "https://www.apple.com/tv-pr/news/2025/09/apple-tv-plus-hit-series-foundation-returns-with-record-breaking-premiere/",
        "date": "20-09-2025",
        "category": "Lanzamiento",
        "summary": "Apple announced that the third season premiere of its flagship sci-fi epic 'Foundation' has become the most-watched drama debut on Apple TV+ to date, with viewership up 40% over the previous season's launch.",
        "publisher": "apple.com",
        "url_raw": "https://www.apple.com/tv-pr/news/2025/09/apple-tv-plus-hit-series-foundation-returns-with-record-breaking-premiere/",
        "url_canonical": "https://www.apple.com/tv-pr/news/2025/09/apple-tv-plus-hit-series-foundation-returns-with-record-breaking-premiere/",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 105,
        "entity": "Spotify",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Spotify Rolls Out AI-Powered Live Translation for Song Lyrics",
        "url": "https://newsroom.spotify.com/2025-09-24/introducing-live-translations-for-lyrics/",
        "date": "24-09-2025",
        "category": "Producto",
        "summary": "Spotify is launching a new feature for Premium subscribers that provides real-time, AI-powered translations for song lyrics. The feature, available for a selection of top global hits, aims to help users connect with music from different cultures.",
        "publisher": "newsroom.spotify.com",
        "url_raw": "https://newsroom.spotify.com/2025-09-24/introducing-live-translations-for-lyrics/",
        "url_canonical": "https://newsroom.spotify.com/2025-09-24/introducing-live-translations-for-lyrics/",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.includes(item.country);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const html = [
        `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}all" value="all" class="mr-2"><label for="${idBase}all">Todos</label></div>`,
        ...allItems.map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c}" value="${c}" class="mr-2"><label for="${idBase}${c}">${c}</label></div>`)
      ].join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES.filter(c => c!=='Todos los Países'), 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, ALL_NEWS_COMPANIES, 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, ALL_NEWS_CATEGORIES, 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES.filter(c => c!=='Todos los Países'), 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, ALL_CONTENT_COMPANIES, 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, ALL_CONTENT_CATEGORIES, 'content-category-');
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== Lógica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function normalizeSelectAll(container, selectedValues) {
      const allBox = container.querySelector('input[value="all"]');
      const rest = [...container.querySelectorAll('input[type="checkbox"]')].filter(b => b.value !== 'all');
      if (!allBox) return;
      if (selectedValues.includes('all')) rest.forEach(b => b.checked = false);
      else if (rest.some(b => b.checked)) allBox.checked = false;
    }
    function filterNews() {
      let sc = getSelected(newsFilterCountryContainer);
      let se = getSelected(newsFilterCompanyContainer);
      let sk = getSelected(newsFilterCategoryContainer);
      normalizeSelectAll(newsFilterCountryContainer, sc);
      normalizeSelectAll(newsFilterCompanyContainer, se);
      normalizeSelectAll(newsFilterCategoryContainer, sk);
      sc = getSelected(newsFilterCountryContainer);
      se = getSelected(newsFilterCompanyContainer);
      sk = getSelected(newsFilterCategoryContainer);
      newsFilters.country = sc.includes('all') ? [] : sc;
      newsFilters.company = se.includes('all') ? [] : se;
      newsFilters.category = sk.includes('all') ? [] : sk;
      renderNewsCards();
    }
    function filterContentNews() {
      let sc = getSelected(contentFilterCountryContainer);
      let se = getSelected(contentFilterCompanyContainer);
      let sk = getSelected(contentFilterCategoryContainer);
      normalizeSelectAll(contentFilterCountryContainer, sc);
      normalizeSelectAll(contentFilterCompanyContainer, se);
      normalizeSelectAll(contentFilterCategoryContainer, sk);
      sc = getSelected(contentFilterCountryContainer);
      se = getSelected(contentFilterCompanyContainer);
      sk = getSelected(contentFilterCategoryContainer);
      contentFilters.country = sc.includes('all') ? [] : sc;
      contentFilters.company = se.includes('all') ? [] : se;
      contentFilters.category = sk.includes('all') ? [] : sk;
      renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

    updateSentimentContent('Brasil');
    updateNewsFilters(); renderNewsCards();
    updateContentNewsFilters(); renderContentNewsCards();
  </script>
</body>
</html>
