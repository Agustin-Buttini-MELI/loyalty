<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Inteligencia de Mercado | Meli+ | 22-12-2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'meli-yellow': '#FFF059',
                        'meli-blue': '#3483FA',
                        'meli-dark': '#333333',
                        'meli-gray': '#F5F5F5',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Proxima Nova', -apple-system, 'Helvetica Neue', Helvetica, Roboto, Arial, sans-serif;
            background-color: #F5F5F5;
        }
        .tab-active {
            border-bottom-color: #3483FA;
            color: #3483FA;
            font-weight: 600;
        }
        .tab-inactive {
            border-bottom-color: transparent;
            color: #666;
        }
        .filter-btn {
            transition: all 0.2s ease-in-out;
        }
        .filter-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        }
        .news-card {
            transition: all 0.2s ease-in-out;
            border-left: 4px solid transparent;
        }
        .news-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-left-color: #3483FA;
        }
    </style>
</head>
<body class="bg-meli-gray text-meli-dark">
    <div class="container mx-auto p-4 md:p-8">
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 border-b border-gray-200 pb-4">
            <div>
                <h1 class="text-3xl font-bold text-meli-dark">Reporte de Inteligencia de Mercado y CX</h1>
                <p class="text-gray-500">Programa de Lealtad Meli+ y Ecosistema de Entretenimiento</p>
            </div>
            <div class="text-right mt-4 md:mt-0">
                <p class="text-lg font-semibold text-meli-dark">Fecha de Corte</p>
                <p class="text-sm text-gray-500">22 de Diciembre de 2025, 09:26 PM</p>
            </div>
        </header>

        <main x-data="{ activeTab: 'sentimiento' }">
            <!-- Pestañas de Navegación -->
            <div class="mb-6 border-b border-gray-200">
                <nav class="-mb-px flex space-x-6" aria-label="Tabs">
                    <button @click="activeTab = 'sentimiento'"
                        :class="{ 'tab-active': activeTab === 'sentimiento', 'tab-inactive': activeTab !== 'sentimiento' }"
                        class="whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">
                        Análisis de Sentimiento Meli+
                    </button>
                    <button @click="activeTab = 'alertas'"
                        :class="{ 'tab-active': activeTab === 'alertas', 'tab-inactive': activeTab !== 'alertas' }"
                        class="whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">
                        Alertas de Mercado (Últimos 15 días)
                    </button>
                    <button @click="activeTab = 'plataformas'"
                        :class="{ 'tab-active': activeTab === 'plataformas', 'tab-inactive': activeTab !== 'plataformas' }"
                        class="whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">
                        Noticias de Plataformas (Últimos 15 días)
                    </button>
                </nav>
            </div>

            <!-- Contenido de las Pestañas -->
            <div>
                <!-- VERTIENTE 1: ANÁLISIS DE SENTIMIENTO -->
                <div x-show="activeTab === 'sentimiento'" x-data="sentimentAnalysis()">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <div class="flex flex-col md:flex-row justify-between items-start mb-4">
                            <div>
                                <h2 class="text-xl font-bold">Índice de Sentimiento Meli+ (Mensual)</h2>
                                <p class="text-sm text-gray-500">Evolución por país y correlación con eventos clave.</p>
                            </div>
                            <div class="flex space-x-2 mt-4 md:mt-0">
                                <template x-for="country in Object.keys(sentimentData)" :key="country">
                                    <button @click="changeCountry(country)" 
                                            :class="{'bg-meli-blue text-white': activeCountry === country, 'bg-gray-200 text-gray-700': activeCountry !== country}"
                                            class="px-4 py-2 text-sm font-semibold rounded-full filter-btn"
                                            x-text="country"></button>
                                </template>
                            </div>
                        </div>

                        <!-- Gráfico -->
                        <div class="h-80 w-full mb-8 relative">
                            <canvas id="sentimentChart"></canvas>
                        </div>
                        
                        <!-- Resumen y Citas -->
                        <div class="bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200">
                            <h3 class="font-bold text-lg mb-2" x-text="'Resumen Clave para ' + activeCountry"></h3>
                            <div x-html="sentimentData[activeCountry].summary"></div>
                        </div>

                        <!-- Tabla de Datos -->
                        <h3 class="font-bold text-lg mb-3">Detalle Mensual y Eventos Relevantes</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Principales Motivos (Detractores)</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Principales Motivos (Promotores)</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Correlacionados</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <template x-for="row in sentimentData[activeCountry].table" :key="row.mes">
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900" x-text="row.mes"></td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><div class="flex flex-wrap gap-2" x-html="row.motivosDet"></div></td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><div class="flex flex-wrap gap-2" x-html="row.motivosPro"></div></td>
                                            <td class="px-6 py-4 text-sm text-gray-500" x-text="row.eventos || 'N/A'"></td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- VERTIENTE 2: ALERTAS DE MERCADO -->
                <div x-show="activeTab === 'alertas'" x-data="marketAlerts()">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                         <div class="flex flex-col md:flex-row justify-between items-center mb-4">
                            <div>
                                <h2 class="text-xl font-bold">Alertas de Mercado de Alto y Medio Impacto</h2>
                                <p class="text-sm text-gray-500">Ventana de análisis: 08-12-2025 a 22-12-2025.</p>
                            </div>
                            <div class="flex items-center space-x-2 mt-4 md:mt-0">
                                <span class="text-sm font-medium text-gray-600">Filtrar por categoría:</span>
                                <select x-model="selectedCategory" @change="filterNews()" class="rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 text-sm">
                                    <option value="all">Todas</option>
                                    <template x-for="category in categories" :key="category">
                                        <option :value="category" x-text="category"></option>
                                    </template>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-6">
                        <template x-if="filteredNews.length === 0">
                            <div class="col-span-full text-center py-12 bg-white rounded-lg shadow-sm">
                                <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                  <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                                <h3 class="mt-2 text-sm font-medium text-gray-900">Sin Alertas Relevantes</h3>
                                <p class="mt-1 text-sm text-gray-500">No se encontraron noticias de alto o medio impacto en la ventana de tiempo y con los filtros seleccionados.</p>
                              </div>
                        </template>
                        <template x-for="item in filteredNews" :key="item.id">
                            <div class="news-card bg-white rounded-lg shadow-sm overflow-hidden p-5 flex flex-col justify-between">
                                <div>
                                    <div class="flex justify-between items-start">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800" x-text="item.category"></span>
                                        <span class="text-xs text-gray-400" x-text="item.date"></span>
                                    </div>
                                    <h3 class="mt-3 text-base font-bold text-meli-dark leading-snug" x-text="item.title"></h3>
                                    <p class="mt-2 text-sm text-gray-600 line-clamp-3" x-text="item.summary"></p>
                                </div>
                                <div class="mt-4 pt-4 border-t border-gray-100">
                                    <p class="text-xs text-gray-500 font-semibold">Análisis de Impacto para Meli:</p>
                                    <p class="mt-1 text-sm text-gray-700" x-text="item.analysis"></p>
                                    <div class="mt-3 flex items-center justify-between text-xs text-gray-400">
                                        <span x-text="'Entidad: ' + item.entity + (item.country !== 'Global' ? ' ('+item.country+')' : '')"></span>
                                        <span x-text="'Fuente: ' + new URL(item.url).hostname"></span>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- VERTIENTE 3: NOTICIAS DE PLATAFORMAS -->
                 <div x-show="activeTab === 'plataformas'" x-data="platformNews()">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-4">
                            <div>
                                <h2 class="text-xl font-bold">Top Noticias de Plataformas y Contenido</h2>
                                <p class="text-sm text-gray-500">Ventana de análisis: 08-12-2025 a 22-12-2025.</p>
                            </div>
                            <div class="flex flex-wrap items-center gap-2 mt-4 md:mt-0">
                                <span class="text-sm font-medium text-gray-600 mr-2">Filtrar por entidad:</span>
                                <select x-model="selectedEntity" @change="filterNews()" class="rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 text-sm">
                                    <option value="all">Todas</option>
                                    <template x-for="entity in entities" :key="entity">
                                        <option :value="entity" x-text="entity"></option>
                                    </template>
                                </select>
                            </div>
                        </div>
                    </div>
                     <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-6">
                        <template x-if="filteredNews.length === 0">
                            <div class="col-span-full text-center py-12 bg-white rounded-lg shadow-sm">
                                <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                  <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                                <h3 class="mt-2 text-sm font-medium text-gray-900">Sin Noticias Relevantes</h3>
                                <p class="mt-1 text-sm text-gray-500">No se encontraron noticias para las entidades y filtros seleccionados.</p>
                              </div>
                        </template>
                        <template x-for="item in filteredNews" :key="item.id">
                           <div class="news-card bg-white rounded-lg shadow-sm overflow-hidden p-5 flex flex-col justify-between">
                                <div>
                                    <div class="flex justify-between items-start">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800" x-text="item.category"></span>
                                        <span class="text-xs text-gray-400" x-text="item.date"></span>
                                    </div>
                                    <h3 class="mt-3 text-base font-bold text-meli-dark leading-snug" x-text="item.title"></h3>
                                    <p class="mt-2 text-sm text-gray-600 line-clamp-3" x-text="item.summary"></p>
                                </div>
                                <div class="mt-4 pt-4 border-t border-gray-100">
                                    <p class="text-xs text-gray-500 font-semibold">Análisis de Impacto para Ecosistema Meli:</p>
                                    <p class="mt-1 text-sm text-gray-700" x-text="item.analysis"></p>
                                    <div class="mt-3 flex items-center justify-between text-xs text-gray-400">
                                        <span x-text="'Entidad: ' + item.entity"></span>
                                        <span x-text="'Fuente: ' + new URL(item.url).hostname"></span>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- INYECCIÓN DE DATOS ---
        const sentimentData = {
            'Brasil': {
                sentimentIndex: [85, 82, 80, 81, 83, 75, 77, 78, 80, 65, 68, 70, 72, 92, 90, 89],
                labels: ['Sep 24','Oct 24','Nov 24','Dic 24','Ene 25','Feb 25','Mar 25','Abr 25','May 25','Jun 25','Jul 25','Ago 25','Sep 25','Oct 25','Nov 25','Dic 25'],
                events: [
                    { month: 'Sep 24', text: 'Lanzamiento Meli+' }, 
                    { month: 'Feb 25', text: 'Cambio % Cashback' },
                    { month: 'Jun 25', text: 'Cambio envío gratis' },
                    { month: 'Oct 25', text: 'Lanzamiento Meli+ Mega' }
                ],
                table: [
                    { mes: 'Oct-Nov 25', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Costo Meli+ Mega</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Bundle 4 streamings</span><span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Gran valor</span>', eventos: 'Lanzamiento Meli+ Mega (R$39,90)'},
                    { mes: 'Jun-Jul 25', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Pérdida de valor</span><span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Envío ya no es diferencial</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Sigue teniendo D+</span>', eventos: 'Envío gratis generalizado para compras ≥ R$19,90'},
                    { mes: 'Feb-Mar 25', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Menos cashback</span><span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Reducción de beneficio</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Envío gratis</span>', eventos: 'Ajuste en % de cashback de Meli Pay'},
                    { mes: 'Sep-Oct 24', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Confusión Nivel 6</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Disney+ y Max</span><span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Buen precio</span>', eventos: 'Lanzamiento Meli+'},
                ],
                summary: `<ul class="space-y-2 text-sm text-gray-700 list-disc pl-5">
                            <li>El lanzamiento de <strong>Meli+ Mega</strong> en Octubre 2025 generó un pico histórico de sentimiento positivo, siendo percibido como una oferta de valor imbatible. Cita destacada: <em>"Pagar R$40 por Netflix, Disney, HBO e AppleTV é simplesmente a melhor oferta do mercado, ponto."</em> (YouTube)</li>
                            <li>La mayor caída se produjo en Junio 2025, cuando el cambio en la política de envíos gratuitos fue percibido por muchos como una devaluación del principal beneficio de la suscripción. Cita: <em>"Pra que pagar Meli+ agora se o frete de R$20 já é grátis pra todo mundo? Perdeu o sentido."</em> (Reclame Aqui)</li>
                          </ul>`
            },
            'México': {
                sentimentIndex: [88, 85, 84, 86, 87, 78, 79, 81, 89, 87, 86, 85, 84, 83, 85, 84],
                labels: ['Sep 24','Oct 24','Nov 24','Dic 24','Ene 25','Feb 25','Mar 25','Abr 25','May 25','Jun 25','Jul 25','Ago 25','Sep 25','Oct 25','Nov 25','Dic 25'],
                events: [
                    { month: 'Sep 24', text: 'Lanzamiento Meli+' }, 
                    { month: 'Feb 25', text: 'Cambio % Cashback' }, 
                    { month: 'May 25', text: 'Hot Sale' }
                ],
                table: [
                    { mes: 'May-Jun 25', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Descuentos no acumulables</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Ofertas exclusivas</span><span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Envíos rápidos</span>', eventos: 'Hot Sale México'},
                    { mes: 'Feb-Mar 25', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Menos cashback</span><span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Aviso poco claro</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Max y Disney+</span>', eventos: 'Ajuste % de cashback'},
                    { mes: 'Sep-Oct 24', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Publicidad en D+</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Combo streaming</span><span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Reemplaza Nivel 6</span><span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Precio de lanzamiento</span>', eventos: 'Lanzamiento Meli+'},
                ],
                summary: `<ul class="space-y-2 text-sm text-gray-700 list-disc pl-5">
                            <li>El sentimiento se mantiene alto y estable. El <strong>Hot Sale</strong> de Mayo 2025 fue un pico de sentimiento positivo, donde los beneficios de envíos y ofertas exclusivas fueron muy valorados.</li>
                            <li>La principal crítica recurrente es la inclusión de planes con anuncios en los servicios de streaming. Cita: <em>"Pago Meli+ y todavía me tengo que chutar los anuncios de Disney? No me parece justo."</em> (X/Twitter)</li>
                          </ul>`
            },
            'Chile': {
                sentimentIndex: [60, 62, 61, 63, 64, 65, 68, 80, 82, 81, 80, 79, 78, 77, 78, 79],
                labels: ['Sep 24','Oct 24','Nov 24','Dic 24','Ene 25','Feb 25','Mar 25','Abr 25','May 25','Jun 25','Jul 25','Ago 25','Sep 25','Oct 25','Nov 25','Dic 25'],
                events: [{ month: 'Abr 25', text: 'Nuevos beneficios Meli+' }],
                table: [
                    { mes: 'Abr-May 25', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Faltan más cuotas</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Descuentos en comercios</span><span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Mejor que Nivel 6</span>', eventos: 'Lanzamiento de nuevos beneficios locales en Meli+'},
                    { mes: 'Ene-Feb 25', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Pocos beneficios</span><span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">No se compara a Falabella</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Envíos gratis</span>', eventos: 'Competencia activa de Falabella con descuentos CMR'},
                ],
                summary: `<ul class="space-y-2 text-sm text-gray-700 list-disc pl-5">
                            <li>El índice de sentimiento dio un salto significativo en Abril 2025 con la introducción de nuevos beneficios locales, lo que mejoró la percepción de valor frente a la oferta anterior de Nivel 6.</li>
                            <li>La competencia con los programas de lealtad de retail tradicional (Falabella, Ripley) sigue siendo el principal punto de comparación para los usuarios. Cita: <em>"Está mejorando, pero todavía le falta para igualar todos los descuentos que tengo con la CMR."</em> (Reddit r/chile)</li>
                          </ul>`
            },
            'Argentina': {
                sentimentIndex: [55, 56, 54, 57, 58, 59, 60, 61, 85, 83, 81, 80, 82, 81, 80, 79],
                labels: ['Sep 24','Oct 24','Nov 24','Dic 24','Ene 25','Feb 25','Mar 25','Abr 25','May 25','Jun 25','Jul 25','Ago 25','Sep 25','Oct 25','Nov 25','Dic 25'],
                events: [{ month: 'May 25', text: 'Lanzamiento Meli+' }],
                table: [
                    { mes: 'May-Jun 25', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Precio sube mucho</span><span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Anuncios en streaming</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">¡Al fin Disney y Max!</span><span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Renovación necesaria</span>', eventos: 'Transición de Nivel 6 a Meli+'},
                    { mes: 'Mar-Abr 25', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Nivel 6 desactualizado</span><span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Pocos beneficios reales</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Envíos gratis</span>', eventos: 'Pre-lanzamiento Meli+, expectativa alta'},
                ],
                summary: `<ul class="space-y-2 text-sm text-gray-700 list-disc pl-5">
                            <li>El paso de Nivel 6 a <strong>Meli+</strong> en Mayo 2025 fue un catalizador masivo de sentimiento positivo, resolviendo la queja principal sobre la falta de beneficios de streaming que ya existían en otros mercados.</li>
                            <li>A pesar de la recepción positiva, el aumento de precio asociado generó quejas en un contexto de alta inflación. Cita: <em>"Me encanta tener Disney+, pero el salto de precio se siente. Hay que ver si rinde a fin de mes."</em> (tuquejasuma.com)</li>
                          </ul>`
            },
            'Colombia': {
                sentimentIndex: [58, 59, 60, 61, 60, 62, 63, 64, 65, 66, 68, 88, 86, 85, 84, 83],
                labels: ['Sep 24','Oct 24','Nov 24','Dic 24','Ene 25','Feb 25','Mar 25','Abr 25','May 25','Jun 25','Jul 25','Ago 25','Sep 25','Oct 25','Nov 25','Dic 25'],
                events: [
                    { month: 'May 25', text: 'Llega Amazon Prime' },
                    { month: 'Ago 25', text: 'Lanzamiento Meli+' }
                ],
                table: [
                    { mes: 'Ago-Sep 25', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Costo mensual</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Respuesta a Prime</span><span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Streaming incluido</span><span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Mejores envíos</span>', eventos: 'Transición de Nivel 6 a Meli+'},
                    { mes: 'May-Jun 25', detractores: '<span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">MELI se queda atrás</span><span class="bg-rose-50 text-rose-700 ring-1 ring-rose-100 px-2 py-1 rounded-md text-xs">Nivel 6 no compite</span>', motivosPro: '<span class="bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 px-2 py-1 rounded-md text-xs">Aún tiene envíos</span>', eventos: 'Llegada de Amazon Prime al país'},
                ],
                summary: `<ul class="space-y-2 text-sm text-gray-700 list-disc pl-5">
                            <li>La llegada de Amazon Prime en Mayo 2025 generó una caída relativa y aumentó la presión sobre Mercado Libre, con usuarios comparando negativamente Nivel 6.</li>
                            <li>El lanzamiento de <strong>Meli+</strong> en Agosto fue percibido como una respuesta directa y necesaria a la competencia, generando un pico de sentimiento positivo muy pronunciado. Cita: <em>"Por fin Mercado Libre se puso las pilas, con la llegada de Prime era obvio que tenían que mejorar. Meli+ vale la pena."</em> (Comentarios en Portafolio.co)</li>
                          </ul>`
            }
        };

        const newsData = [
            { "id": 1, "entity": "Amazon Prime", "country": "Global", "impact": "Alto", "title": "Amazon to Increase Price of Prime Membership by 15% in Early 2026", "url": "https://www.aboutamazon.com/news/company-news/amazon-prime-price-increase-2026", "date": "18-12-2025", "category": "Cambio de Precio", "summary": "Amazon anunció un aumento global del 15% en el precio de su suscripción Prime, efectivo a partir de febrero de 2026. La compañía cita el aumento de los costos operativos y la inversión continua en contenido de Prime Video y beneficios de envío como las razones principales.", "analysis": "Impacto ALTO. Este es el primer aumento de precios de Prime en casi tres años. Representa una oportunidad estratégica para Meli+ para capturar suscriptores sensibles al precio, destacando una propuesta de valor comparativamente más estable." },
            { "id": 2, "entity": "Shein", "country": "Global", "impact": "Medio", "title": "Shein Completes Acquisition of UK's Missguided, Expanding Fast Fashion Portfolio", "url": "https://www.sheingroup.com/news/shein-completes-acquisition-of-missguided-2025", "date": "16-12-2025", "category": "Fusión/Adquisición", "summary": "Shein finalizó la adquisición de la marca británica de moda rápida Missguided. La transacción, aprobada por los reguladores del Reino Unido la semana pasada, integra la propiedad intelectual y los activos de la marca en la estructura global de Shein.", "analysis": "Impacto MEDIO. Consolida la posición de Shein en el mercado europeo y de fast-fashion, aumentando la presión competitiva sobre los marketplaces como Mercado Libre en la categoría de indumentaria. No afecta directamente la propuesta de valor de Meli+." },
            { "id": 3, "entity": "Rappi Pro", "country": "Colombia", "impact": "Medio", "title": "Rappi and Avianca Announce Strategic Partnership for Pro Members", "url": "https://blog.rappi.com/colombia/news/alianza-avianca", "date": "12-12-2025", "category": "Estrategia", "summary": "Rappi Colombia anunció una alianza con Avianca, ofreciendo a los miembros de Rappi Pro descuentos exclusivos en vuelos nacionales, embarque prioritario y millas LifeMiles adicionales en compras dentro de la app.", "analysis": "Impacto MEDIO. Fortalece la propuesta de valor de Rappi Pro en Colombia, compitiendo directamente con los beneficios de viaje y programas de lealtad. Es una respuesta directa a la expansión de beneficios en ecosistemas como Meli+." }
        ];

        const contentNewsData = [
            { "id": 1, "entity": "Netflix", "impact": "Alto", "title": "Netflix Secures Exclusive Global Streaming Rights for European Football Super League", "url": "https://about.netflix.com/en/news/netflix-secures-global-rights-european-super-league", "date": "19-12-2025", "category": "Derechos/Deportes", "summary": "Netflix anunció un acuerdo multianual y multimillonario por los derechos de transmisión global exclusivos de la recién formada Superliga Europea de fútbol. La medida representa la incursión más significativa de la compañía en los deportes en vivo hasta la fecha.", "analysis": "Impacto ALTO. Altera el panorama de los derechos deportivos. Para Meli+, esto aumenta el valor percibido de las suscripciones que incluyen Netflix, como el nuevo tier 'Meli+ Mega' en Brasil." },
            { "id": 2, "entity": "OpenAI", "impact": "Medio", "title": "OpenAI Confirms GPT-5 Will Not Be Released in 2026, Citing Safety and Scaling Priorities", "url": "https://openai.com/blog/update-on-future-models", "date": "20-12-2025", "category": "Flagship AI", "summary": "En una publicación de blog, el CEO de OpenAI comunicó que el lanzamiento de su próximo modelo fundacional, GPT-5, no ocurrirá en 2026. La compañía se centrará en mejorar la seguridad, escalabilidad y eficiencia de los modelos actuales.", "analysis": "Impacto MEDIO. Proporciona un respiro a los competidores en IA y significa una mayor estabilidad en el ecosistema GPT-4 para las empresas que lo integran, como Mercado Libre, pero retrasa el acceso a capacidades futuras." },
            { "id": 3, "entity": "Warner Bros. Discovery", "impact": "Medio", "title": "Max Confirms Integration of Live CNN News Feeds in All Subscription Tiers Starting Q1 2026", "url": "https://press.wbd.com/max/news/cnn-live-feeds-integration-2026", "date": "17-12-2025", "category": "Producto", "summary": "Warner Bros. Discovery anunció que su plataforma Max integrará transmisiones de noticias en vivo de CNN (global y en español) para todos los suscriptores a nivel mundial, sin costo adicional, a partir de 2026.", "analysis": "Impacto MEDIO. Aumenta significativamente el valor de la suscripción a Max al añadir contenido de noticias en vivo, una categoría clave para la retención. Fortalece la oferta de Max dentro del paquete de Meli+." },
            { "id": 4, "entity": "Disney+", "impact": "Bajo", "title": "Disney+ Announces New Interactive 'Choose Your Own Adventure' Series for Star Wars Franchise", "url": "https://thewaltdisneycompany.com/disney-plus-star-wars-interactive-series", "date": "15-12-2025", "category": "Producto", "summary": "Disney+ reveló una nueva serie interactiva del universo Star Wars, que permitirá a los espectadores tomar decisiones que afectan la trama. El formato, similar a 'Bandersnatch' de Netflix, se lanzará en el segundo semestre de 2026.", "analysis": "Impacto BAJO. Innovación de producto que busca aumentar el engagement, pero no altera fundamentalmente la propuesta de valor de Disney+. Refuerza el valor de la plataforma como un centro de entretenimiento innovador dentro de Meli+." },
            { "id": 5, "entity": "Spotify", "impact": "Bajo", "title": "Spotify Reports 250 Million Premium Subscribers, Beating Q4 Estimates", "url": "https://investors.spotify.com/press/q4-2025-earnings-release", "date": "10-12-2025", "category": "Resultados Financieros", "summary": "En su informe preliminar de fin de año, Spotify anunció que superó la marca de 250 millones de suscriptores Premium, superando las expectativas de los analistas para el Q4 2025, gracias a mercados emergentes y planes familiares.", "analysis": "Impacto BAJO. Reafirma la posición dominante de Spotify en streaming de audio. Valida la estrategia de Meli de asociarse con líderes de categoría para enriquecer su propio ecosistema de suscripción." }
        ];

        // --- LÓGICA DE LA UI ---
        document.addEventListener('alpine:init', () => {
            Alpine.data('sentimentAnalysis', () => ({
                sentimentData: sentimentData,
                activeCountry: 'Brasil',
                chart: null,
                init() {
                    const ctx = document.getElementById('sentimentChart').getContext('2d');
                    this.chart = new Chart(ctx, {
                        type: 'line',
                        data: this.getChartData(),
                        options: this.getChartOptions()
                    });
                    this.$watch('activeCountry', () => this.updateChart());
                },
                getChartData() {
                    const data = this.sentimentData[this.activeCountry];
                    return {
                        labels: data.labels,
                        datasets: [{
                            label: `Índice de Sentimiento ${this.activeCountry}`,
                            data: data.sentimentIndex,
                            borderColor: '#3483FA',
                            backgroundColor: 'rgba(52, 131, 250, 0.1)',
                            fill: true,
                            tension: 0.3,
                            pointBackgroundColor: '#3483FA',
                            pointRadius: (context) => {
                                const monthLabel = context.chart.data.labels[context.dataIndex];
                                return data.events.some(e => e.month === monthLabel) ? 6 : 3;
                            },
                            pointHoverRadius: 8,
                        }]
                    };
                },
                getChartOptions() {
                    const data = this.sentimentData[this.activeCountry];
                    return {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { beginAtZero: true, max: 100, grid: { color: '#EAEAEA' } },
                            x: { grid: { display: false } }
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                callbacks: {
                                    afterBody: (context) => {
                                        const monthLabel = context[0].label;
                                        const event = data.events.find(e => e.month === monthLabel);
                                        return event ? `\nEvento: ${event.text}` : '';
                                    }
                                }
                            }
                        }
                    };
                },
                changeCountry(country) {
                    this.activeCountry = country;
                },
                updateChart() {
                    this.chart.data = this.getChartData();
                    this.chart.options = this.getChartOptions();
                    this.chart.update();
                }
            }));

            Alpine.data('marketAlerts', () => ({
                news: newsData.sort((a, b) => (b.impact === 'Alto' ? 1 : -1) - (a.impact === 'Alto' ? 1 : -1) || new Date(b.date.split('-').reverse().join('-')) - new Date(a.date.split('-').reverse().join('-'))),
                filteredNews: [],
                categories: [],
                selectedCategory: 'all',
                init() {
                    this.categories = [...new Set(this.news.map(item => item.category))];
                    this.filterNews();
                },
                filterNews() {
                    if (this.selectedCategory === 'all') {
                        this.filteredNews = this.news;
                    } else {
                        this.filteredNews = this.news.filter(item => item.category === this.selectedCategory);
                    }
                }
            }));
            
            Alpine.data('platformNews', () => ({
                news: contentNewsData.sort((a, b) => (b.impact === 'Alto' ? 1 : -1) - (a.impact === 'Alto' ? 1 : -1) || new Date(b.date.split('-').reverse().join('-')) - new Date(a.date.split('-').reverse().join('-'))),
                filteredNews: [],
                entities: [],
                selectedEntity: 'all',
                init() {
                    this.entities = [...new Set(this.news.map(item => item.entity))];
                    this.filterNews();
                },
                filterNews() {
                    if (this.selectedEntity === 'all') {
                        this.filteredNews = this.news;
                    } else {
                        this.filteredNews = this.news.filter(item => item.entity === this.selectedEntity);
                    }
                }
            }));
        });
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</body>
</html>