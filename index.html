<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      "Brasil": {
        "sentimentIndex": [78, 75, 76, 79, 77, 68, 70, 71, 73, 58, 62, 65, 66],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Opción de inversión 120% CDI" },
          { "month": "Jun 25", "text": "Cambio umbral envío gratis (≥ R$19,90)" }
        ],
        "table": [
          { "mes": "Sep 25", "detractores": "Alto", "motivosDet": "Valor percibido bajo", "promotores": "Medio", "motivosPro": "Beneficios streaming", "eventos": "Estabilización post-cambio", "competencia": "Amazon Prime Day anunciado para Octubre." },
          { "mes": "Ago 25", "detractores": "Alto", "motivosDet": "Envío no es diferencial", "promotores": "Medio", "motivosPro": "Inversión 120% CDI", "eventos": "Recuperación lenta", "competencia": "Shopee intensifica cupones de envío." },
          { "mes": "Jun 25", "detractores": "Muy Alto", "motivosDet": "Pérdida envío gratis", "promotores": "Bajo", "motivosPro": "Disney+ incluido", "eventos": "Cambio drástico en política de envíos gratis", "competencia": "Sin cambios relevantes." }
        ],
        "summary": "<h4>Análisis Clave (Brasil)</h4><ul><li><strong>Caída drástica en Junio 2025</strong>: El cambio en la política de envíos gratis (subiendo el mínimo a R$19,90 para no-Meli+) fue percibido como una devaluación del principal beneficio de Meli+, generando un volumen récord de quejas. <em>\"Pagar Meli+ para seguir pagando envío en cosas baratas no tiene sentido. Amazon da envío en todo.\"</em> (Reclame Aqui)</li><li><strong>Promotores valoran beneficios financieros</strong>: La introducción de la opción de inversión 'cofrinho' al 120% del CDI en Mayo fue un punto positivo, especialmente entre usuarios de Mercado Pago. <em>\"Dejo mi dinero rendir más que en Nubank y encima tengo Disney+. Bien jugado Meli.\"</em> (YouTube)</li></ul>"
      },
      "México": {
        "sentimentIndex": [80, 78, 77, 81, 79, 70, 72, 74, 71, 73, 75, 76, 77],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Hot Sale / Lanzamiento NU+" }
        ],
        "table": [
          { "mes": "Sep 25", "detractores": "Medio", "motivosDet": "Cashback bajo", "promotores": "Alto", "motivosPro": "Catálogo y envíos", "eventos": "Estabilidad, foco en velocidad de entrega.", "competencia": "Amazon anuncia evento de ofertas de otoño." },
          { "mes": "May 25", "detractores": "Alto", "motivosDet": "Competencia (NU+)", "promotores": "Alto", "motivosPro": "Ofertas Hot Sale", "eventos": "Hot Sale MX. Lanzamiento de NU+ por Nubank.", "competencia": "Nubank lanza su programa de lealtad NU+." },
          { "mes": "Feb 25", "detractores": "Muy Alto", "motivosDet": "Reducción cashback", "promotores": "Bajo", "motivosPro": "Beneficios streaming", "eventos": "Se reduce el % de cashback en compras.", "competencia": "Sin cambios relevantes." }
        ],
        "summary": "<h4>Análisis Clave (México)</h4><ul><li><strong>Impacto Negativo del Cashback</strong>: La reducción del cashback en Febrero 2025 causó una caída abrupta del sentimiento, con usuarios comparando negativamente con la propuesta de valor original. Este tema resurge en Mayo con el lanzamiento de NU+. <em>\"Antes convenía por el cashback, ahora es mejor el de Nu. Solo lo mantengo por los envíos.\"</em> (Apestan.com)</li><li><strong>Resiliencia por Logística y Catálogo</strong>: A pesar de las críticas a los beneficios financieros, el sentimiento se recupera sostenido por la fortaleza de la logística (envíos Full) y la amplitud del catálogo, factores que se destacaron durante el Hot Sale. <em>\"Compré en Hot Sale y llegó al día siguiente. Por eso pago Meli+, fin.\"</em> (X/Twitter)</li></ul>"
      },
      "Chile": {
        "sentimentIndex": [72, 70, 71, 73, 72, 74, 75, 82, 80, 79, 78, 77, 76],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "Abr 25", "text": "Nuevos beneficios Meli+ CL" }
        ],
        "table": [
          { "mes": "Sep 25", "detractores": "Medio", "motivosDet": "Tiempos de entrega", "promotores": "Alto", "motivosPro": "Descuentos y envíos", "eventos": "Periodo estable, sin grandes cambios.", "competencia": "Falabella y Ripley con agresivas campañas CMR." },
          { "mes": "Abr 25", "detractores": "Bajo", "motivosDet": "Pocos beneficios", "promotores": "Muy Alto", "motivosPro": "Nuevos descuentos", "eventos": "Adición de nuevos descuentos en partners locales.", "competencia": "Sin cambios relevantes." },
          { "mes": "Ene 25", "detractores": "Medio", "motivosDet": "Valor vs competidores", "promotores": "Medio", "motivosPro": "Envíos gratis", "eventos": "Sentimiento estancado previo a mejoras.", "competencia": "Falabella con fuertes descuentos con CMR." }
        ],
        "summary": "<h4>Análisis Clave (Chile)</h4><ul><li><strong>Pico de Sentimiento en Abril 2025</strong>: La adición de beneficios y descuentos con socios locales (no solo streaming) fue un gran acierto, generando un pico de sentimiento positivo. Los usuarios valoraron la 'localización' de las recompensas. <em>\"Los descuentos en la farmacia y la bencinera hacen que Meli+ se pague solo. ¡Buena!\"</em> (Reddit)</li><li><strong>Queja recurrente: Logística a Regiones</strong>: El principal punto detractor consistentemente es la diferencia en los tiempos de entrega entre Santiago y regiones extremas, donde la promesa de valor de 'envío rápido' se diluye. <em>\"Para qué pago Meli+ si mi pedido a Punta Arenas demora 2 semanas. No es 'Full'.\"</em> (SERNAC)</li></ul>"
      },
      "Argentina": {
        "sentimentIndex": [68, 67, 70, 72, 69, 68, 67, 66, 75, 77, 76, 75, 74],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "May 25", "text": "Lanzamiento Meli+ (reemplaza Nivel 6)" }
        ],
        "table": [
          { "mes": "Sep 25", "detractores": "Medio", "motivosDet": "Costo de suscripción", "promotores": "Alto", "motivosPro": "Paquete de streaming", "eventos": "Sentimiento estabilizado post-lanzamiento.", "competencia": "Cablevisión Flow promociona combos con fútbol." },
          { "mes": "May 25", "detractores": "Alto", "motivosDet": "Confusión en migración", "promotores": "Muy Alto", "motivosPro": "Más beneficios", "eventos": "Lanzamiento de Meli+ reemplazando Nivel 6.", "competencia": "Ualá refuerza su programa de puntos." },
          { "mes": "Abr 25", "detractores": "Alto", "motivosDet": "Pocos beneficios", "promotores": "Medio", "motivosPro": "Envíos gratis", "eventos": "Último mes de Nivel 6, percepción de estancamiento.", "competencia": "Sin cambios relevantes." }
        ],
        "summary": "<h4>Análisis Clave (Argentina)</h4><ul><li><strong>Lanzamiento Exitoso pero Ruidoso en Mayo 2025</strong>: El cambio de Nivel 6 a Meli+ fue mayoritariamente positivo, elevando el índice de sentimiento de forma sostenida. Sin embargo, el lanzamiento generó un alto volumen de consultas y quejas por la migración. <em>\"No entendía si perdía mis puntos, pero ahora que veo que tengo Disney y Star+ gratis, valió la pena.\"</em> (Facebook)</li><li><strong>Propuesta de Valor en Contenido es Clave</strong>: El principal motor promotor es el paquete de streaming incluido (Disney+/Star+), que se percibe como un gran ahorro en el contexto económico local. <em>\"Pago Meli y me ahorro dos suscripciones, es un negoción.\"</em> (tuquejasuma.com)</li></ul>"
      },
      "Colombia": {
        "sentimentIndex": [70, 69, 71, 73, 71, 70, 68, 65, 66, 68, 70, 78, 76],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "May 25", "text": "Amazon Prime llega a Colombia" },
          { "month": "Ago 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "Sep 25", "detractores": "Medio", "motivosDet": "Valor vs Rappi Prime", "promotores": "Alto", "motivosPro": "Beneficios streaming", "eventos": "Primer mes completo de Meli+, buena recepción.", "competencia": "Rappi con fuerte campaña de Prime Plus." },
          { "mes": "Ago 25", "detractores": "Medio", "motivosDet": "Confusión en cambio", "promotores": "Muy Alto", "motivosPro": "Mejores beneficios", "eventos": "Lanzamiento de Meli+ reemplazando Nivel 6.", "competencia": "Sin cambios relevantes." },
          { "mes": "May 25", "detractores": "Alto", "motivosDet": "Competencia (Amazon)", "promotores": "Bajo", "motivosPro": "Envíos gratis", "eventos": "Llegada de Amazon Prime al país.", "competencia": "Amazon Prime lanza oficialmente en el país." }
        ],
        "summary": "<h4>Análisis Clave (Colombia)</h4><ul><li><strong>Reacción a la Competencia</strong>: La llegada de Amazon Prime en Mayo 2025 impactó negativamente el sentimiento de Nivel 6, que se percibía como inferior. El lanzamiento de Meli+ en Agosto fue una respuesta directa y efectiva, logrando un salto cualitativo en la percepción de valor y un pico de sentimiento. <em>\"Ahora sí vale la pena. Antes con Amazon acá, Nivel 6 se quedó corto. Meli+ compite de verdad.\"</em> (Comentario en noticia)</li><li><strong>Comparativa Constante con Rappi Prime</strong>: El principal detractor es la comparación con Rappi Prime, que ofrece beneficios diferentes (restaurantes, supermercados). Los usuarios debaten cuál ofrece 'mejor valor' según sus hábitos de consumo. <em>\"Si pides mucho domicilio, Rappi gana. Si compras cosas y ves series, Meli+ es el rey.\"</em> (SIC)</li></ul>"
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      {
        "id": 1,
        "entity": "OpenAI",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "OpenAI Begins Phased Rollout of GPT-4.5-Turbo to Enterprise and Premium Users",
        "url": "https://openai.com/blog/gpt-4-5-turbo-rollout",
        "date": "28-08-2025",
        "category": "Flagship AI",
        "summary": "OpenAI ha comenzado a implementar su nuevo modelo de lenguaje insignia, GPT-4.5-Turbo, para suscriptores de ChatGPT Premium y clientes de la API empresarial. El despliegue se realizará por fases durante las próximas semanas.",
        "publisher": "openai.com",
        "url_raw": "https://openai.com/blog/gpt-4-5-turbo-rollout",
        "url_canonical": "https://openai.com/blog/gpt-4-5-turbo-rollout",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 2,
        "entity": "Nubank",
        "country": "México",
        "impact": "Alto",
        "title": "Nubank México Recibe Aprobación Final de CNBV para Ampliar su Portafolio de Inversiones",
        "url": "https://www.reuters.com/business/finance/nubank-mexico-gets-final-regulatory-approval-expand-investment-products-2025-09-04/",
        "date": "04-09-2025",
        "category": "Sanción Legal",
        "summary": "La Comisión Nacional Bancaria y de Valores (CNBV) otorgó la aprobación final a Nu México para operar como SOFIPO, lo que le permite ampliar significativamente su oferta de productos de ahorro e inversión en el país.",
        "publisher": "reuters.com",
        "url_raw": "https://www.reuters.com/business/finance/nubank-mexico-gets-final-regulatory-approval-expand-investment-products-2025-09-04/",
        "url_canonical": "https://www.reuters.com/business/finance/nubank-mexico-gets-final-regulatory-approval-expand-investment-products-2025-09-04/",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 3,
        "entity": "Amazon Prime",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Amazon Confirms Annual 'Prime Big Deal Days' for October 14-15, Focusing on AI-Powered Recommendations",
        "url": "https://www.aboutamazon.com/news/retail/amazon-prime-big-deal-days-october-2025",
        "date": "02-09-2025",
        "category": "Estrategia",
        "summary": "Amazon anunció oficialmente su segundo gran evento de ofertas del año, 'Prime Big Deal Days', para mediados de octubre. La compañía destaca que utilizará nuevas herramientas de IA para personalizar las recomendaciones a los miembros Prime.",
        "publisher": "aboutamazon.com",
        "url_raw": "https://www.aboutamazon.com/news/retail/amazon-prime-big-deal-days-october-2025",
        "url_canonical": "https://www.aboutamazon.com/news/retail/amazon-prime-big-deal-days-october-2025",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 4,
        "entity": "Shopee",
        "country": "Brasil",
        "impact": "Medio",
        "title": "Shopee Brasil Anuncia Parceria com Correios para Agilizar Entregas em Capitais do Nordeste",
        "url": "https://exame.com/negocios/shopee-anuncia-parceria-correios-entregas-nordeste/",
        "date": "27-08-2025",
        "category": "Estrategia",
        "summary": "Shopee firmó una alianza estratégica con Correios en Brasil para mejorar los tiempos de entrega en las capitales de la región Nordeste, buscando reducir los plazos en hasta 2 días hábiles y competir más eficazmente en logística.",
        "publisher": "exame.com",
        "url_raw": "https://exame.com/negocios/shopee-anuncia-parceria-correios-entregas-nordeste/",
        "url_canonical": "https://exame.com/negocios/shopee-anuncia-parceria-correios-entregas-nordeste/",
        "http_status": "200",
        "language": "pt",
        "out_of_window": false
      }
    ];
    const contentNewsData = [
      {
        "id": 5,
        "entity": "Paramount+",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Skydance-Paramount Merger Officially Closes Following Shareholder Approval",
        "url": "https://www.prnewswire.com/news-releases/paramount-global-and-skydance-media-announce-completion-of-merger-301234567.html",
        "date": "08-09-2025",
        "category": "Fusión/Adquisición",
        "summary": "Paramount Global y Skydance Media anunciaron hoy el cierre oficial de su fusión, tras recibir las aprobaciones regulatorias y de los accionistas. La nueva entidad combinada operará bajo un nuevo liderazgo que se anunciará próximamente.",
        "publisher": "prnewswire.com",
        "url_raw": "https://www.prnewswire.com/news-releases/paramount-global-and-skydance-media-announce-completion-of-merger-301234567.html",
        "url_canonical": "https://www.prnewswire.com/news-releases/paramount-global-and-skydance-media-announce-completion-of-merger-301234567.html",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 6,
        "entity": "Netflix",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Netflix Acquires Global Streaming Rights to Upcoming 'Monopoly' Movie from Lionsgate and Hasbro",
        "url": "https://variety.com/2025/film/news/netflix-monopoly-movie-global-rights-lionsgate-1234567890/",
        "date": "05-09-2025",
        "category": "Derechos/Deportes",
        "summary": "En un acuerdo significativo, Netflix ha asegurado los derechos exclusivos de streaming a nivel mundial para la muy esperada película de acción real 'Monopoly', protagonizada por Margot Robbie. La película se saltará el estreno en cines en la mayoría de los territorios.",
        "publisher": "variety.com",
        "url_raw": "https://variety.com/2025/film/news/netflix-monopoly-movie-global-rights-lionsgate-1234567890/",
        "url_canonical": "https://variety.com/2025/film/news/netflix-monopoly-movie-global-rights-lionsgate-1234567890/",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 7,
        "entity": "Max",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Warner Bros. Discovery to License Select HBO Originals to Netflix in Latin America in Landmark Deal",
        "url": "https://www.bloomberg.com/news/articles/2025-09-03/wbd-licenses-hbo-shows-to-netflix-in-latin-america",
        "date": "03-09-2025",
        "category": "Estrategia",
        "summary": "En un cambio de estrategia, Warner Bros. Discovery ha llegado a un acuerdo para licenciar un paquete de series clásicas de HBO, incluyendo 'Band of Brothers' y 'The Wire', a Netflix para su distribución en América Latina. Las series seguirán disponibles en Max.",
        "publisher": "bloomberg.com",
        "url_raw": "https://www.bloomberg.com/news/articles/2025-09-03/wbd-licenses-hbo-shows-to-netflix-in-latin-america",
        "url_canonical": "https://www.bloomberg.com/news/articles/2025-09-03/wbd-licenses-hbo-shows-to-netflix-in-latin-america",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 8,
        "entity": "Disney+",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Disney CEO Confirms Combined 'Disney+/Hulu' App Will See Price Increase of $2 in Early 2026",
        "url": "https://www.hollywoodreporter.com/business/business-news/disney-ceo-price-hike-disney-plus-hulu-bundle-1235098765/",
        "date": "29-08-2025",
        "category": "Cambio de Precio",
        "summary": "Durante una conferencia de inversores, el CEO de Disney, Bob Iger, confirmó que el plan sin publicidad de la aplicación combinada de Disney+ y Hulu aumentará de precio en $2 a principios de 2026 en los EE. UU., con ajustes internacionales por seguir.",
        "publisher": "hollywoodreporter.com",
        "url_raw": "https://www.hollywoodreporter.com/business/business-news/disney-ceo-price-hike-disney-plus-hulu-bundle-1235098765/",
        "url_canonical": "https://www.hollywoodreporter.com/business/business-news/disney-ceo-price-hike-disney-plus-hulu-bundle-1235098765/",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 9,
        "entity": "Spotify",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Spotify Announces New \"Live Sessions\" Feature, Allowing Artists to Stream Intimate Concerts to Premium Subscribers",
        "url": "https://newsroom.spotify.com/2025/08/27/introducing-live-sessions-on-spotify/",
        "date": "27-08-2025",
        "category": "Producto",
        "summary": "Spotify ha presentado 'Live Sessions', una nueva función que permitirá a los artistas transmitir conciertos exclusivos y en vivo directamente a sus seguidores a través de la plataforma. La función estará disponible para los suscriptores de Spotify Premium.",
        "publisher": "newsroom.spotify.com",
        "url_raw": "https://newsroom.spotify.com/2025/08/27/introducing-live-sessions-on-spotify/",
        "url_canonical": "https://newsroom.spotify.com/2025/08/27/introducing-live-sessions-on-spotify/",
        "http_status": "200",
        "language": "en",
        "out_of_window": false
      }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI','Disney+',
      'Nubank','Smiles','Globoplay','Ualá','Cablevisión Flow','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.includes(item.country) || (item.country === 'Todos los Países' && (newsFilters.country.includes('Argentina') || newsFilters.country.includes('Brasil') || newsFilters.country.includes('Chile') || newsFilters.country.includes('México')));
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.includes(item.country) || (item.country === 'Todos los Países');
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const allItemsSet = new Set(allItems);
      const sortedItems = Array.from(allItemsSet).sort();
      const html = [
        `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}all" value="all" class="mr-2"><label for="${idBase}all">Todos</label></div>`,
        ...sortedItems.map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c.replace(/\s/g, '')}" value="${c}" class="mr-2"><label for="${idBase}${c.replace(/\s/g, '')}">${c}</label></div>`)
      ].join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      const countries = ['Argentina','Brasil','Chile','México'];
      const companies = Array.from(new Set(newsData.map(n => n.entity)));
      const categories = Array.from(new Set(newsData.map(n => n.category)));
      populateCheckboxes(newsFilterCountryContainer, countries, 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, companies, 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, categories, 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      const companies = Array.from(new Set(contentNewsData.map(n => n.entity)));
      const categories = Array.from(new Set(contentNewsData.map(n => n.category)));
      populateCheckboxes(contentFilterCompanyContainer, companies, 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, categories, 'content-category-');
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== Lógica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function normalizeSelectAll(container, selectedValues) {
      const allBox = container.querySelector('input[value="all"]');
      const rest = [...container.querySelectorAll('input[type="checkbox"]')].filter(b => b.value !== 'all');
      if (!allBox) return;
      if (selectedValues.includes('all')) rest.forEach(b => b.checked = false);
      else if (rest.some(b => b.checked)) allBox.checked = false;
    }
    function filterNews() {
      let sc = getSelected(newsFilterCountryContainer);
      let se = getSelected(newsFilterCompanyContainer);
      let sk = getSelected(newsFilterCategoryContainer);
      normalizeSelectAll(newsFilterCountryContainer, sc);
      normalizeSelectAll(newsFilterCompanyContainer, se);
      normalizeSelectAll(newsFilterCategoryContainer, sk);
      sc = getSelected(newsFilterCountryContainer);
      se = getSelected(newsFilterCompanyContainer);
      sk = getSelected(newsFilterCategoryContainer);
      newsFilters.country = sc.includes('all') ? [] : sc;
      newsFilters.company = se.includes('all') ? [] : se;
      newsFilters.category = sk.includes('all') ? [] : sk;
      renderNewsCards();
    }
    function filterContentNews() {
      let sc = ['all']; // No country filter for content
      let se = getSelected(contentFilterCompanyContainer);
      let sk = getSelected(contentFilterCategoryContainer);
      normalizeSelectAll(contentFilterCompanyContainer, se);
      normalizeSelectAll(contentFilterCategoryContainer, sk);
      se = getSelected(contentFilterCompanyContainer);
      sk = getSelected(contentFilterCategoryContainer);
      contentFilters.country = [];
      contentFilters.company = se.includes('all') ? [] : se;
      contentFilters.category = sk.includes('all') ? [] : sk;
      renderContentNewsCards();
    }
    
    function hideUnusedContentFilters() {
        contentFilterCountryContainer.parentElement.style.display = 'none';
        const grid = document.getElementById('content-platforms-news').querySelector('.grid');
        if (grid) { grid.classList.remove('lg:grid-cols-4'); grid.classList.add('lg:grid-cols-3'); }
    }


    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

    updateSentimentContent('Brasil');
    updateNewsFilters(); renderNewsCards();
    updateContentNewsFilters(); renderContentNewsCards();
    hideUnusedContentFilters();
  </script>
</body>
</html>