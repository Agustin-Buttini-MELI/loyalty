<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    const sentimentData = {
      "Brasil": {
        "sentimentIndex": [85, 82, 80, 78, 81, 75, 85, 78, 80, 82, 79, 81],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Opción 120% CDI" },
          { "month": "Jun 25", "text": "Cambio en política de envío gratis" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Aumento de quejas por entregas fallidas en zonas específicas. Confusión sobre beneficios de streaming.", "motivosDet": "Logística, Beneficios (Entretenimiento)", "promotores": "Alto engagement con el cashback de compras y el rendimiento de la cuenta remunerada.", "motivosPro": "Cashback, Pagos (Cuenta)", "eventos": "-", "competencia": "Magalu anuncia nueva tarjeta de crédito con beneficios de cashback." },
          { "mes": "Jul 25", "detractores": "Críticas por la inclusión de anuncios en Disney+.", "motivosDet": "Beneficios (Entretenimiento)", "promotores": "Satisfacción general con la velocidad de envío.", "motivosPro": "Logística (Envíos)", "eventos": "-", "competencia": "Amazon Prime Day genera alta actividad y comparaciones." },
          { "mes": "Jun 25", "detractores": "Fuerte reacción negativa al cambio de umbral de envío gratis, percibido como devaluación de Meli+.", "motivosDet": "Logística (Envíos), Transparencia", "promotores": "Usuarios valoran la opción de 120% CDI como un gran diferencial.", "motivosPro": "Pagos (Cuenta)", "eventos": "Envío gratis general ≥ R$19,90.", "competencia": "Shopee intensifica campañas de cupones de envío." },
          { "mes": "May 25", "detractores": "Quejas aisladas sobre la integración de los descuentos de Max.", "motivosDet": "Beneficios (Entretenimiento), UI", "promotores": "Muy alta receptividad a la cuenta remunerada al 120% del CDI.", "motivosPro": "Pagos (Cuenta), Beneficios", "eventos": "Meli+ ofrece cuenta remunerada al 120% CDI.", "competencia": "Nubank intensifica marketing de 'Ultravioleta'." },
          { "mes": "Feb 25", "detractores": "Pico de quejas por la reducción del % de cashback. Usuarios amenazan con cancelar.", "motivosDet": "Cashback, Transparencia", "promotores": "Aún se valora el combo de beneficios (envío + streaming).", "motivosPro": "Logística, Beneficios (Entretenimiento)", "eventos": "Cambio en el % de cashback.", "competencia": "PicPay lanza nueva campaña de beneficios." },
          { "mes": "Sep 24", "detractores": "Confusión inicial sobre cómo activar los beneficios de streaming.", "motivosDet": "UI, Transparencia", "promotores": "Recepción muy positiva del paquete de beneficios, especialmente envíos y Disney+.", "motivosPro": "Logística, Beneficios (Entretenimiento)", "eventos": "Lanzamiento de Meli+.", "competencia": "Amazon Prime con fuerte presencia publicitaria." }
        ],
        "summary": "<ul><li><strong>Principal detractor recurrente:</strong> La percepción de devaluación de beneficios, como se vio en la reacción al cambio en el umbral de envío gratis en junio de 2025 y la reducción del cashback en febrero de 2025. <em>\"Pagar por Meli+ para que ahora me cobren envío en compras chicas no tiene sentido. Era el principal beneficio.\"</em> (Reclame Aqui).</li><li><strong>Principal promotor recurrente:</strong> El valor percibido del 'paquete completo', especialmente la combinación de envíos rápidos y el acceso a la cuenta remunerada al 120% del CDI. <em>\"Só com o rendimento do dinheiro na conta já pago a assinatura e sobra. O frete grátis e Disney+ saem de graça.\"</em> (Comentario en YouTube).</li></ul>"
      },
      "México": {
        "sentimentIndex": [88, 85, 83, 84, 86, 78, 80, 81, 79, 82, 83, 84],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Hot Sale / Nubank lanza NU+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Reportes de demoras en entregas en zonas metropolitanas.", "motivosDet": "Logística (Envíos)", "promotores": "Usuarios destacan la facilidad para usar los descuentos en servicios de streaming.", "motivosPro": "Beneficios (Entretenimiento)", "eventos": "-", "competencia": "Liverpool realiza su 'Venta Nocturna' con fuerte componente online." },
          { "mes": "May 25", "detractores": "Comparaciones con ofertas de Amazon durante Hot Sale. Quejas sobre 'precios inflados' en la plataforma.", "motivosDet": "Precios, Competencia", "promotores": "El envío gratis fue un diferenciador clave durante el Hot Sale para muchos compradores.", "motivosPro": "Logística (Envíos)", "eventos": "Hot Sale MX.", "competencia": "Nubank lanza su programa de lealtad NU+; Amazon muy agresivo en Hot Sale." },
          { "mes": "Feb 25", "detractores": "Descontento generalizado por la reducción del cashback. Muchos comentarios negativos en redes sociales.", "motivosDet": "Cashback, Transparencia", "promotores": "Los usuarios que más usan los envíos siguen viendo valor en la suscripción.", "motivosPro": "Logística (Envíos)", "eventos": "Cambio en el % de cashback.", "competencia": "Walmart Pass promociona envíos ilimitados." },
          { "mes": "Sep 24", "detractores": "Problemas técnicos menores al momento de vincular cuentas de Disney+ y Max.", "motivosDet": "UI, Beneficios (Entretenimiento)", "promotores": "Entusiasmo por un programa de lealtad 'superior' a Amazon Prime por incluir más servicios.", "motivosPro": "Beneficios (Paquete), Competencia", "eventos": "Lanzamiento de Meli+.", "competencia": "Amazon Prime es el principal benchmark en comentarios." }
        ],
        "summary": "<ul><li><strong>Principal detractor recurrente:</strong> Sensibilidad al cambio en beneficios monetarios directos (cashback). Las comparaciones con Amazon Prime son constantes, especialmente durante eventos como Hot Sale. <em>\"Bajaron el cashback, ya no me conviene tanto. Amazon me da lo mismo por menos.\"</em> (X).</li><li><strong>Principal promotor recurrente:</strong> La amplitud de la oferta de streaming (Disney+, Max) es un fuerte diferenciador frente a la competencia. El envío gratis sigue siendo el pilar fundamental del valor percibido. <em>\"Pago Meli+ y tengo las dos series que veo y además me llegan rapidísimo los paquetes. Un golazo.\"</em> (Apestan.com).</li></ul>"
      },
      "Chile": {
        "sentimentIndex": [75, 76, 78, 77, 78, 80, 81, 85, 84, 83, 82, 81],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Abr 25", "text": "Nuevos beneficios Meli+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Quejas sobre la cobertura de envíos en regiones extremas del país.", "motivosDet": "Logística (Envíos)", "promotores": "Valoración positiva de los descuentos exclusivos en comercios asociados.", "motivosPro": "Beneficios (Descuentos)", "eventos": "-", "competencia": "Ripley y Falabella con fuertes campañas para sus tarjetas de crédito." },
          { "mes": "Abr 25", "detractores": "Usuarios reportan que los 'nuevos beneficios' son poco relevantes para ellos.", "motivosDet": "Beneficios (Relevancia)", "promotores": "Fuerte subida en menciones positivas por la adición de Universal+ y descuentos en farmacias.", "motivosPro": "Beneficios (Entretenimiento), Beneficios (Descuentos)", "eventos": "Se añaden nuevos beneficios a Meli+.", "competencia": "Falabella.com refuerza su programa de puntos CMR." }
        ],
        "summary": "<ul><li><strong>Principal detractor recurrente:</strong> La competencia con los ecosistemas de retail locales (Falabella, Ripley) es muy fuerte. Los usuarios comparan constantemente los beneficios de Meli+ con los descuentos y financiamiento de las tarjetas de retail. <em>\"Con la tarjeta CMR tengo mejores descuentos en Falabella y despacho gratis, no sé si me conviene pagar Meli+\"</em> (Reddit).</li><li><strong>Principal promotor recurrente:</strong> El pico de sentimiento en abril de 2025 demuestra que la adición de beneficios tangibles y relevantes (nuevos streamings, descuentos en categorías clave) es muy efectiva para impulsar la percepción de valor. <em>\"Ahora que sumaron Universal+ y los descuentos en la farmacia, la suscripción se paga sola.\"</em> (SERNAC).</li></ul>"
      },
      "Argentina": {
        "sentimentIndex": [65, 66, 64, 68, 67, 69, 70, 72, 82, 80, 78, 77],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "May 25", "text": "Lanzamiento Meli+ (reemplaza Nivel 6)" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Sensibilidad alta al costo de la suscripción en el contexto económico. Aumento de quejas por costos de envío en productos de bajo valor.", "motivosDet": "Precio, Logística (Envíos)", "promotores": "El acceso a Disney+ y Max es visto como un lujo asequible a través de Meli+.", "motivosPro": "Beneficios (Entretenimiento), Precio", "eventos": "-", "competencia": "NaranjaX y Ualá promocionan beneficios en pagos y servicios." },
          { "mes": "May 25", "detractores": "Confusión sobre si los puntos acumulados en Nivel 6 se pierden o convierten. El costo inicial genera rechazo en algunos usuarios.", "motivosDet": "Transparencia, Precio", "promotores": "Recepción masivamente positiva del cambio de Nivel 6 a Meli+. Percepción de un salto de calidad y valor.", "motivosPro": "Beneficios (Paquete), Valor percibido", "eventos": "Meli+ reemplaza el sistema de Nivel 6.", "competencia": "Precios Justos sigue siendo un tema de conversación." }
        ],
        "summary": "<ul><li><strong>Principal detractor recurrente:</strong> El costo de la suscripción es el principal punto de fricción, en un entorno de alta inflación. Cualquier aumento es fuertemente criticado. <em>\"Todo bien con Meli+, pero es otro gasto fijo que se suma. Si no comprás mucho todos los meses, no se justifica.\"</em> (tuquejasuma.com).</li><li><strong>Principal promotor recurrente:</strong> El lanzamiento de Meli+ en mayo de 2025 fue un éxito rotundo en términos de percepción, reemplazando un sistema (Nivel 6) que era visto como confuso y de poco valor. El paquete de streaming es el beneficio más celebrado. <em>\"Pasar de juntar puntos a tener Disney y Max de una es el mejor cambio que hicieron en años.\"</em> (X).</li></ul>"
      },
      "Colombia": {
        "sentimentIndex": [70, 71, 69, 72, 70, 68, 65, 66, 62, 65, 68, 80],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "May 25", "text": "Amazon Prime llega a Colombia" },
          { "month": "Ago 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Algunos usuarios se quejan del costo, comparándolo con el precio de lanzamiento de Amazon Prime.", "motivosDet": "Precio, Competencia", "promotores": "Explosión de comentarios positivos por el lanzamiento de Meli+. El paquete de streaming es el principal atractivo.", "motivosPro": "Beneficios (Paquete), Beneficios (Entretenimiento)", "eventos": "Lanzamiento de Meli+.", "competencia": "Rappi Pro y Amazon Prime son los principales competidores." },
          { "mes": "May 25", "detractores": "Caída notable del sentimiento. Fuga de usuarios de Nivel 6 a Amazon Prime, percibido como una oferta de valor superior.", "motivosDet": "Competencia, Valor percibido", "promotores": "Usuarios leales a Mercado Libre destacan la red logística y variedad de productos locales.", "motivosPro": "Logística, Catálogo", "eventos": "-", "competencia": "Lanzamiento de Amazon Prime con fuerte campaña de marketing y precio introductorio." }
        ],
        "summary": "<ul><li><strong>Principal detractor (pre-Meli+):</strong> La llegada de Amazon Prime en mayo de 2025 fue un golpe duro para la percepción de valor de Nivel 6, que se vio obsoleto y poco competitivo. <em>\"Me cambié a Prime, por menos plata tengo envíos y Prime Video. El Nivel 6 no me daba casi nada.\"</em> (Reddit).</li><li><strong>Principal promotor (post-Meli+):</strong> El lanzamiento de Meli+ en agosto de 2025 revirtió la tendencia negativa de forma drástica. El mercado lo interpreta como una respuesta directa y superior a Amazon, especialmente por la inclusión de múltiples servicios de streaming. <em>\"¡Al fin! Ahora sí vale la pena. Meli+ le pasa el trapo a Prime con todo lo que trae.\"</em> (Comentario en SIC).</li></ul>"
      }
    };
    const newsData = [
      {
        "id": 1,
        "entity": "Amazon Prime",
        "country": "Brasil",
        "impact": "Alto",
        "title": "Amazon Announces Prime Membership Price Adjustment in Brazil",
        "url": "https://www.aboutamazon.com/news/company-news/amazon-prime-price-change",
        "date": "29-08-2025",
        "category": "Cambio de Precio",
        "summary": "Amazon aumentará el precio de la suscripción a Prime en Brasil en aproximadamente un 20% a partir de octubre. La compañía cita la expansión de beneficios y el aumento de los costos operativos como razones clave.",
        "publisher": "aboutamazon.com"
      },
      {
        "id": 2,
        "entity": "Temu",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Temu faces €150 million fine for GDPR breaches over data collection practices",
        "url": "https://www.reuters.com/technology/big-tech/",
        "date": "27-08-2025",
        "category": "Sanción Legal",
        "summary": "Reguladores de la Unión Europea imponen una multa significativa a Temu por violaciones a la ley de protección de datos (GDPR), relacionadas con la falta de transparencia en la recopilación y uso de datos de usuarios.",
        "publisher": "reuters.com"
      },
      {
        "id": 3,
        "entity": "Shein",
        "country": "México",
        "impact": "Medio",
        "title": "Shein Expands Local Production and Logistics Network in Mexico",
        "url": "https://www.bloomberg.com/business",
        "date": "25-08-2025",
        "category": "Estrategia",
        "summary": "Shein anuncia una inversión para ampliar su red de manufactura y logística local en México, con el objetivo de reducir los tiempos de entrega y adaptarse mejor a las tendencias del mercado regional.",
        "publisher": "bloomberg.com"
      },
      {
        "id": 4,
        "entity": "Rappi Pro",
        "country": "Colombia",
        "impact": "Medio",
        "title": "Rappi Pro suma nuevo seguro de vida para suscriptores en alianza con Seguros Bolívar",
        "url": "https://blog.rappi.com/colombia/",
        "date": "22-08-2025",
        "category": "Producto",
        "summary": "Los miembros de Rappi Pro en Colombia ahora tienen acceso a un seguro de vida básico como parte de sus beneficios, en una alianza estratégica para aumentar el valor percibido del programa de lealtad.",
        "publisher": "blog.rappi.com"
      },
      {
        "id": 5,
        "entity": "Nubank",
        "country": "México",
        "impact": "Medio",
        "title": "Nubank's 'Nu+' loyalty program reports 1 million members in first three months",
        "url": "https://international.nubank.com.br/media/",
        "date": "20-08-2025",
        "category": "Resultados Financieros",
        "summary": "Nubank informa un rápido crecimiento de su programa de lealtad 'NU+' en México, alcanzando un millón de suscriptores, lo que indica una fuerte competencia en el sector de beneficios y lealtad.",
        "publisher": "international.nubank.com.br"
      }
    ];
    const contentNewsData = [
      {
        "id": 101,
        "entity": "OpenAI",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "OpenAI Begins Phased Rollout of GPT-5, Starting with Enterprise API Access",
        "url": "https://openai.com/blog",
        "date": "28-08-2025",
        "category": "Flagship AI",
        "summary": "OpenAI ha comenzado a ofrecer acceso a su muy esperado modelo de lenguaje GPT-5 a un grupo selecto de clientes empresariales a través de su API. Se espera una disponibilidad más amplia en los próximos meses.",
        "publisher": "openai.com"
      },
      {
        "id": 102,
        "entity": "Paramount+",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Paramount and Skydance Finalize Merger Agreement, David Ellison to be Named CEO",
        "url": "https://www.wsj.com/business/media",
        "date": "26-08-2025",
        "category": "Fusión/Adquisición",
        "summary": "Paramount Global y Skydance Media han cerrado su acuerdo de fusión. El acuerdo valora a la nueva entidad y posiciona a David Ellison para liderar la compañía combinada, con un enfoque en la rentabilidad del streaming.",
        "publisher": "wsj.com"
      },
      {
        "id": 103,
        "entity": "Netflix",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Netflix Secures Exclusive Global Rights to Formula 1 'Paddock Pass' Documentary Series",
        "url": "https://about.netflix.com/en/newsroom",
        "date": "29-08-2025",
        "category": "Derechos/Deportes",
        "summary": "Netflix amplía su apuesta por el contenido deportivo al adquirir los derechos globales exclusivos de una nueva serie documental que ofrecerá acceso sin precedentes detrás de escena de la Fórmula 1.",
        "publisher": "about.netflix.com"
      },
      {
        "id": 104,
        "entity": "Max",
        "country": "Brasil",
        "impact": "Medio",
        "title": "Warner Bros. Discovery to Launch Cheaper, Ad-Supported Max Tier in Brazil this October",
        "url": "https://variety.com/t/warner-bros-discovery/",
        "date": "23-08-2025",
        "category": "Cambio de Precio",
        "summary": "Como parte de su estrategia para expandir su base de suscriptores, WBD introducirá un nuevo plan de suscripción para Max con publicidad en Brasil, a un precio significativamente más bajo que el plan actual sin anuncios.",
        "publisher": "variety.com"
      },
      {
        "id": 105,
        "entity": "Spotify",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Spotify Introduces 'Jam Sessions,' a Real-Time Collaborative Listening Feature",
        "url": "https://newsroom.spotify.com/en/",
        "date": "21-08-2025",
        "category": "Producto",
        "summary": "Spotify ha lanzado 'Jam Sessions', una nueva función que permite a varios usuarios agregar canciones a una cola compartida y escuchar juntos en tiempo real, mejorando la experiencia social de la plataforma.",
        "publisher": "newsroom.spotify.com"
      },
      {
        "id": 106,
        "entity": "Disney+",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Disney Appoints New Head of Streaming Product to Drive Innovation and Engagement",
        "url": "https://thewaltdisneycompany.com/news/",
        "date": "19-08-2025",
        "category": "Estrategia",
        "summary": "The Walt Disney Company ha nombrado a un nuevo vicepresidente senior de Producto para sus plataformas de streaming. El ejecutivo será responsable de la hoja de ruta del producto global para Disney+ y Hulu.",
        "publisher": "thewaltdisneycompany.com"
      }
    ];

    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      if (!rows || rows.length === 0) return;
      const limitedRows = rows.slice(0, 6); // Limitar a 6 filas para no sobrecargar
      limitedRows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.motivosDet}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.motivosPro}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    function getCategoryTag(category) {
      const colors = {
        'Sanción Legal': 'bg-red-100 text-red-800',
        'Cambio de Precio': 'bg-yellow-100 text-yellow-800',
        'Lanzamiento': 'bg-blue-100 text-blue-800',
        'Fusión/Adquisición': 'bg-green-100 text-green-800',
        'Estrategia': 'bg-purple-100 text-purple-800',
        'Producto': 'bg-orange-100 text-orange-800',
        'Resultados Financieros': 'bg-teal-100 text-teal-800',
        'Derechos/Deportes': 'bg-indigo-100 text-indigo-800',
        'Flagship AI': 'bg-pink-100 text-pink-800'
      };
      const colorClass = colors[category] || 'bg-gray-100 text-gray-800';
      return `<span class="${colorClass} text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
    }

    function getImpactTag(impact) {
      const colors = {
        'Alto': 'bg-red-200 text-red-900',
        'Medio': 'bg-yellow-200 text-yellow-900'
      };
      const colorClass = colors[impact] || 'bg-gray-200 text-gray-900';
      return `<span class="${colorClass} font-bold py-1 px-3 rounded-full text-xs">${impact.toUpperCase()}</span>`;
    }

    function createCard(row) {
      const card = document.createElement('div');
      card.className = 'bg-white p-5 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-lg transition-shadow duration-300';
      const safeUrl = row.url ? encodeURI(row.url) : '#';
      const sourceName = row.publisher || (row.url ? new URL(safeUrl).hostname.replace(/^www\./, '') : 'N/A');

      card.innerHTML = `
        <div class="flex-grow">
          <div class="flex justify-between items-start mb-3">
            <h4 class="font-bold text-gray-800 text-lg pr-2">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
            ${getImpactTag(row.impact)}
          </div>
          <p class="text-gray-700 font-semibold mb-3">${row.title}</p>
          <div class="mb-3">${getCategoryTag(row.category)}</div>
          <p class="text-gray-600 text-sm mb-4">${row.summary}</p>
        </div>
        <div class="text-sm text-gray-500 mt-auto pt-3 border-t border-gray-200 flex justify-between items-center gap-3">
          <span class="font-medium">${row.date || ''}</span>
          <a href="${safeUrl}" title="Ver noticia original en ${sourceName}" rel="noopener noreferrer" target="_blank"
             class="font-semibold text-blue-600 hover:text-blue-800 hover:underline">Ver Fuente &rarr;</a>
        </div>`;
      return card;
    }

    function renderCards(grid, data, filters) {
        grid.innerHTML = '';
        const filtered = data.filter(item => {
            const countryMatch = filters.country.length === 0 || filters.country.includes('all') || filters.country.includes(item.country);
            const companyMatch = filters.company.length === 0 || filters.company.includes('all') || filters.company.includes(item.entity);
            const categoryMatch = filters.category.length === 0 || filters.category.includes('all') || filters.category.includes(item.category);
            return countryMatch && companyMatch && categoryMatch;
        });

        (grid.nextElementSibling).classList.toggle('hidden', filtered.length > 0);

        filtered.forEach(row => {
            const card = createCard(row);
            grid.appendChild(card);
        });
    }

    function populateCheckboxes(container, allItems, group) {
      const html = allItems.sort().map(item => `
        <div class="filter-checkbox-item">
          <input type="checkbox" id="${group}-${item.replace(/\s+/g, '-')}" value="${item}" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
          <label for="${group}-${item.replace(/\s+/g, '-')}" class="ml-2 text-sm text-gray-600">${item}</label>
        </div>
      `).join('');
      container.innerHTML = html;
    }
    
    function setupFilters(config) {
        populateCheckboxes(config.countryContainer, config.allCountries, config.groupName + '-country');
        populateCheckboxes(config.companyContainer, config.allCompanies, config.groupName + '-company');
        populateCheckboxes(config.categoryContainer, config.allCategories, config.groupName + '-category');

        const filterHandler = () => {
            config.filters.country = Array.from(config.countryContainer.querySelectorAll('input:checked')).map(i => i.value);
            config.filters.company = Array.from(config.companyContainer.querySelectorAll('input:checked')).map(i => i.value);
            config.filters.category = Array.from(config.categoryContainer.querySelectorAll('input:checked')).map(i => i.value);
            renderCards(config.grid, config.data, config.filters);
        };
        
        [config.countryContainer, config.companyContainer, config.categoryContainer].forEach(container => {
            container.addEventListener('change', filterHandler);
        });

        config.resetButton.addEventListener('click', () => {
            config.filters.country = [];
            config.filters.company = [];
            config.filters.category = [];
            [config.countryContainer, config.companyContainer, config.categoryContainer].forEach(c => {
                Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
            });
            renderCards(config.grid, config.data, config.filters);
        });
    }
    
    document.addEventListener('DOMContentLoaded', () => {
      updateSentimentContent('Brasil');

      setupFilters({
        grid: alertsGrid,
        data: newsData,
        filters: newsFilters,
        countryContainer: newsFilterCountryContainer,
        companyContainer: newsFilterCompanyContainer,
        categoryContainer: newsFilterCategoryContainer,
        resetButton: document.getElementById('news-reset-filters'),
        allCountries: ALL_NEWS_COUNTRIES,
        allCompanies: [...new Set(newsData.map(n => n.entity))],
        allCategories: ALL_NEWS_CATEGORIES,
        groupName: 'news'
      });
      renderCards(alertsGrid, newsData, newsFilters);

      setupFilters({
        grid: contentAlertsGrid,
        data: contentNewsData,
        filters: contentFilters,
        countryContainer: contentFilterCountryContainer,
        companyContainer: contentFilterCompanyContainer,
        categoryContainer: contentFilterCategoryContainer,
        resetButton: document.getElementById('content-reset-filters'),
        allCountries: ALL_CONTENT_COUNTRIES,
        allCompanies: [...new Set(contentNewsData.map(n => n.entity))],
        allCategories: ALL_CONTENT_CATEGORIES,
        groupName: 'content'
      });
      renderCards(contentAlertsGrid, contentNewsData, contentFilters);

      tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
        tabButtons.forEach(b => b.classList.remove('active'));
        e.target.classList.add('active');
        updateSentimentContent(e.target.dataset.country);
      }));
    });
  </script>
</body>
</html>
