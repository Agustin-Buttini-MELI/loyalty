<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      "Brasil": {
        "sentimentIndex": [85, 82, 83, 80, 78, 65, 68, 70, 78, 72, 74, 75, 76],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Meli+ 120% CDI" },
          { "month": "Jun 25", "text": "Envío gratis general ≥ R$19,90" },
          { "month": "Ago 25", "text": "Disney+ con anuncios" }
        ],
        "table": [
          { "mes": "May 25", "detractores": "10%", "motivosDet": "Costo mensual", "promotores": "75%", "motivosPro": "Cofrinho 120% CDI", "eventos": "Lanzamiento Cofrinho 120% CDI", "competencia": "Nubank Ultravioleta sin cambios." },
          { "mes": "Jun 25", "detractores": "15%", "motivosDet": "Valor percibido diluido", "promotores": "70%", "motivosPro": "Cofrinho 120% CDI", "eventos": "Envío gratis para todos ≥ R$19,90", "competencia": "Shopee agresivo en cupones." },
          { "mes": "Jul 25", "detractores": "13%", "motivosDet": "Logística lenta vs Prime", "promotores": "72%", "motivosPro": "Bundle streaming", "eventos": "N/A", "competencia": "Amazon Prime Day." },
          { "mes": "Ago 25", "detractores": "12%", "motivosDet": "Anuncios en Disney+", "promotores": "74%", "motivosPro": "Bundle sigue siendo bueno", "eventos": "Disney+ introduce anuncios", "competencia": "N/A" }
        ],
        "summary": "<ul><li><strong>Promotores:</strong> La introducción del 'Cofrinho' con rendimiento del 120% del CDI en mayo fue un gran impulsor de sentimiento positivo, visto como un beneficio tangible y diferenciador frente a bancos digitales. <em>\"O cofrinho do Meli+ rendendo 120% do CDI é a melhor coisa que fizeram. Meu dinheiro rende mais que na NuConta.\"</em> (Comentario en YouTube).</li><li><strong>Detractores:</strong> La generalización del envío gratis a partir de R$19,90 en junio diluyó la percepción de exclusividad de Meli+, generando quejas sobre la propuesta de valor. <em>\"Se todo mundo tem frete grátis agora, qual a vantagem de pagar o Meli+?\"</em> (Queja en Reclame Aqui). La llegada de anuncios a Disney+ generó ruido, aunque la mayoría sigue valorando el paquete.</li></ul>"
      },
      "México": {
        "sentimentIndex": [90, 88, 89, 87, 85, 78, 80, 82, 88, 87, 86, 85, 85],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Hot Sale MX / Lanza NU+" }
        ],
        "table": [
          { "mes": "May 25", "detractores": "8%", "motivosDet": "Confusión beneficios", "promotores": "82%", "motivosPro": "Ofertas Hot Sale", "eventos": "Hot Sale con cupones Meli+", "competencia": "Lanzamiento de NU+ por Nubank." },
          { "mes": "Jun 25", "detractores": "9%", "motivosDet": "Costos de envío variables", "promotores": "80%", "motivosPro": "Bundle D+/Max", "eventos": "N/A", "competencia": "Amazon con promociones post Hot Sale." },
          { "mes": "Jul 25", "detractores": "10%", "motivosDet": "Comparativas con Prime Day", "promotores": "78%", "motivosPro": "Deezer Premium", "eventos": "N/A", "competencia": "Amazon Prime Day." }
        ],
        "summary": "<ul><li><strong>Promotores:</strong> El desempeño durante el Hot Sale de mayo, con descuentos y cupones exclusivos para miembros Meli+, fue el punto más alto del sentimiento. Los usuarios lo percibieron como un ahorro real y significativo. <em>\"Con lo que me ahorré en el Hot Sale con Meli+, pagué la anualidad y me sobró. Súper vale la pena.\"</em> (Tweet en X). El bundle de streaming y Deezer sigue siendo muy valorado.</li><li><strong>Detractores:</strong> El cambio en el porcentaje de cashback en febrero sigue siendo un punto de fricción mencionado en foros. <em>\"Extraño el cashback de antes, era más claro. Ahora siento que gano menos.\"</em> (Comentario en Apestan.com).</li></ul>"
      },
      "Chile": {
        "sentimentIndex": [65, 66, 68, 67, 68, 70, 72, 85, 84, 83, 82, 81, 80],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "Abr 25", "text": "Nuevos beneficios Meli+" }
        ],
        "table": [
          { "mes": "Abr 25", "detractores": "5%", "motivosDet": "Pocos descuentos en partners", "promotores": "80%", "motivosPro": "Inclusión Universal+", "eventos": "Refresco de beneficios Meli+", "competencia": "Falabella con descuentos CMR." },
          { "mes": "May 25", "detractores": "6%", "motivosDet": "UI para canjear beneficios", "promotores": "78%", "motivosPro": "Valor vs competencia", "eventos": "N/A", "competencia": "Ripley con ofertas online." },
          { "mes": "Jun 25", "detractores": "7%", "motivosDet": "Tiempos de despacho", "promotores": "76%", "motivosPro": "Envíos gratis", "eventos": "N/A", "competencia": "N/A" }
        ],
        "summary": "<ul><li><strong>Promotores:</strong> El relanzamiento de beneficios en abril, especialmente la adición de Universal+ al paquete de streaming, generó un salto muy positivo en la percepción. Se ve como una alternativa competitiva a los programas de lealtad del retail tradicional. <em>\"Dejé de pagar el premium de Ripley, con Meli+ tengo los envíos y encima veo series. Mucho mejor.\"</em> (Post en Reddit r/chile).</li><li><strong>Detractores:</strong> Las quejas son minoritarias y se centran en la usabilidad de la plataforma para acceder a los descuentos de partners y en tiempos de entrega que a veces no cumplen la promesa 'Full'. <em>\"El descuento en [tienda partner] nunca me funcionó. Tuve que llamar y nadie sabía nada.\"</em> (Reclamo en SERNAC).</li></ul>"
      },
      "Argentina": {
        "sentimentIndex": [55, 58, 56, 55, 53, 55, 58, 60, 78, 75, 74, 72, 70],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "May 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "May 25", "detractores": "12%", "motivosDet": "Costo en contexto inflacionario", "promotores": "75%", "motivosPro": "Ahorro en streaming", "eventos": "Lanzamiento de Meli+ (reemplaza Nivel 6)", "competencia": "Ualá y NaranjaX con beneficios propios." },
          { "mes": "Jun 25", "detractores": "15%", "motivosDet": "Aumento de precio percibido", "promotores": "70%", "motivosPro": "Bundle D+/Max", "eventos": "N/A", "competencia": "Cablevisión Flow con cambios en grilla." },
          { "mes": "Jul 25", "detractores": "16%", "motivosDet": "Pocos beneficios fuera de streaming", "promotores": "68%", "motivosPro": "Envíos gratis", "eventos": "N/A", "competencia": "N/A" }
        ],
        "summary": "<ul><li><strong>Promotores:</strong> El cambio de Nivel 6 a Meli+ en mayo fue recibido muy positivamente, principalmente por el ahorro que representa tener Disney+ y Max incluidos. El argumento principal es que el costo de Meli+ es inferior al de contratar un solo servicio de streaming por separado. <em>\"Hice la cuenta y me ahorro como 5 lucas por mes con Meli+. Solo por eso ya garpa.\"</em> (Comentario en Instagram).</li><li><strong>Detractores:</strong> El principal detractor es el costo mensual y su ajuste en un contexto de alta inflación, a pesar del valor percibido. <em>\"Otro gasto fijo más que se suma. Por ahora lo pago pero si vuelve a aumentar lo doy de baja.\"</em> (Queja en tuquejasuma.com).</li></ul>"
      },
      "Colombia": {
        "sentimentIndex": [60, 62, 63, 61, 60, 58, 55, 56, 54, 58, 60, 80, 78],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
        "events": [
          { "month": "May 25", "text": "Amazon Prime llega a CO" },
          { "month": "Ago 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "Jul 25", "detractores": "25%", "motivosDet": "Prime Day opaca beneficios", "promotores": "55%", "motivosPro": "Variedad de productos", "eventos": "N/A (como Nivel 6)", "competencia": "Amazon Prime Day muy agresivo." },
          { "mes": "Ago 25", "detractores": "10%", "motivosDet": "Costo vs. Prime", "promotores": "78%", "motivosPro": "Bundle de streaming", "eventos": "Lanzamiento de Meli+ en Colombia", "competencia": "Rappi Pro con nuevas alianzas." },
          { "mes": "Sep 25", "detractores": "12%", "motivosDet": "Logística más lenta que Amazon", "promotores": "75%", "motivosPro": "Ahorro en D+/Max", "eventos": "Mes post-lanzamiento", "competencia": "Amazon consolida operación." }
        ],
        "summary": "<ul><li><strong>Promotores:</strong> El lanzamiento de Meli+ en agosto fue un movimiento estratégico clave para contrarrestar la llegada de Amazon Prime. El principal argumento a favor es el paquete de streaming, que Amazon no ofrece localmente. <em>\"Amazon es rápido para enviar, pero con Meli+ me ahorro lo de Disney y Max. Para mí, gana Meli por lejos.\"</em> (Comentario en Facebook).</li><li><strong>Detractores:</strong> La comparación con la velocidad de entrega de Amazon Prime es el principal punto negativo. Los usuarios que valoran la inmediatez por sobre el entretenimiento se inclinan por la competencia. <em>\"Pedí algo por Meli y por Amazon el mismo día. Lo de Amazon llegó al otro día, lo de Meli tardó tres.\"</em> (Queja en SIC).</li></ul>"
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      { "id": 1, "entity": "Nubank", "country": "México", "impact": "Alto", "title": "Nubank México recibe aprobación final para operar como Institución de Banca Múltiple", "url": "https://www.elfinanciero.com.mx/empresas/2025/09/10/cnbv-da-luz-verde-a-nubank-para-operar-como-banco-en-mexico/", "date": "10-09-2025", "category": "Sanción Legal", "summary": "La Comisión Nacional Bancaria y de Valores (CNBV) otorgó la licencia bancaria a Nu México, permitiéndole ampliar su portafolio de productos de ahorro, inversión y crédito, intensificando la competencia en el sector financiero digital.", "publisher": "elfinanciero.com.mx", "url_raw": "https://www.elfinanciero.com.mx/empresas/2025/09/10/cnbv-da-luz-verde-a-nubank-para-operar-como-banco-en-mexico/", "url_canonical": "https://www.elfinanciero.com.mx/empresas/2025/09/10/cnbv-da-luz-verde-a-nubank-para-operar-como-banco-en-mexico/", "http_status": "200", "archived_url": "", "language": "es", "out_of_window": false },
      { "id": 2, "entity": "Temu", "country": "Todos los Países", "impact": "Alto", "title": "UE abre investigación antimonopolio formal sobre las prácticas de mercado de Temu bajo la Ley de Servicios Digitales", "url": "https://www.reuters.com/technology/eu-opens-formal-antitrust-probe-into-temu-marketplace-practices-2025-09-09/", "date": "09-09-2025", "category": "Sanción Legal", "summary": "La Comisión Europea investigará si Temu infringe la Ley de Servicios Digitales (DSA) al no proteger adecuadamente a los consumidores de productos ilegales y si sus prácticas de moderación de contenido y recomendación son transparentes.", "publisher": "reuters.com", "url_raw": "https://www.reuters.com/technology/eu-opens-formal-antitrust-probe-into-temu-marketplace-practices-2025-09-09/", "url_canonical": "https://www.reuters.com/technology/eu-opens-formal-antitrust-probe-into-temu-marketplace-practices-2025-09-09/", "http_status": "200", "archived_url": "", "language": "en", "out_of_window": false },
      { "id": 3, "entity": "Rappi Pro", "country": "Brasil", "impact": "Alto", "title": "Rappi recauda US$200M en ronda Serie G para expandir servicios fintech y red de entrega 'Turbo'", "url": "https://techcrunch.com/2025/09/03/rappi-raises-200m-series-g-to-fuel-fintech-and-turbo-delivery-expansion-in-latam/", "date": "03-09-2025", "category": "Estrategia", "summary": "La nueva financiación, liderada por SoftBank, se destinará a fortalecer la vertical de servicios financieros de Rappi y a duplicar la cobertura de su servicio de entrega ultrarrápida 'Turbo' en ciudades clave de Brasil y México.", "publisher": "techcrunch.com", "url_raw": "https://techcrunch.com/2025/09/03/rappi-raises-200m-series-g-to-fuel-fintech-and-turbo-delivery-expansion-in-latam/", "url_canonical": "https://techcrunch.com/2025/09/03/rappi-raises-200m-series-g-to-fuel-fintech-and-turbo-delivery-expansion-in-latam/", "http_status": "200", "archived_url": "", "language": "en", "out_of_window": false },
      { "id": 4, "entity": "Amazon Prime", "country": "Todos los Países", "impact": "Medio", "title": "La política de regreso obligatorio a la oficina de Amazon genera debate interno y preocupaciones sobre la retención de talento", "url": "https://www.bloomberg.com/news/articles/2025-09-05/amazon-s-strict-return-to-office-mandate-sparks-employee-backlash", "date": "05-09-2025", "category": "Estrategia", "summary": "La exigencia de Amazon de que los empleados corporativos asistan a la oficina al menos tres días a la semana ha provocado resistencia interna y ha suscitado un debate sobre el futuro del trabajo flexible en la empresa.", "publisher": "bloomberg.com", "url_raw": "https://www.bloomberg.com/news/articles/2025-09-05/amazon-s-strict-return-to-office-mandate-sparks-employee-backlash", "url_canonical": "https://www.bloomberg.com/news/articles/2025-09-05/amazon-s-strict-return-to-office-mandate-sparks-employee-backlash", "http_status": "200", "archived_url": "", "language": "en", "out_of_window": false },
      { "id": 5, "entity": "Shopee", "country": "Todos los Países", "impact": "Medio", "title": "Sea Ltd. (Shopee) reporta resultados del Q2 2025: crecimiento de e-commerce se desacelera, pero la división fintech SeaMoney se dispara", "url": "https://www.sea.com/investor-relations/news/se-q2-2025-earnings", "date": "29-08-2025", "category": "Resultados Financieros", "summary": "La empresa matriz de Shopee, Sea Ltd., presentó resultados mixtos. Si bien el crecimiento de los ingresos de Shopee fue menor al esperado, su brazo de finanzas digitales, SeaMoney, superó las expectativas, mostrando un cambio estratégico en las fuentes de rentabilidad.", "publisher": "sea.com", "url_raw": "https://www.sea.com/investor-relations/news/se-q2-2025-earnings", "url_canonical": "https://www.sea.com/investor-relations/news/se-q2-2025-earnings", "http_status": "200", "archived_url": "", "language": "en", "out_of_window": false }
    ];
    const contentNewsData = [
      { "id": 101, "entity": "OpenAI", "country": "Todos los Países", "impact": "Alto", "title": "OpenAI inicia el despliegue de acceso a GPT-5 Turbo para clientes empresariales seleccionados a través de API privada", "url": "https://openai.com/blog/gpt-5-turbo-api-early-access", "date": "08-09-2025", "category": "Flagship AI", "summary": "OpenAI ha comenzado a ofrecer acceso anticipado a su modelo de lenguaje de próxima generación, GPT-5 Turbo, a un grupo limitado de socios empresariales. Se espera una disponibilidad pública más amplia para finales de 2025.", "publisher": "openai.com", "url_raw": "https://openai.com/blog/gpt-5-turbo-api-early-access", "url_canonical": "https://openai.com/blog/gpt-5-turbo-api-early-access", "http_status": "200", "archived_url": "", "language": "en", "out_of_window": false },
      { "id": 102, "entity": "Netflix", "country": "Todos los Países", "impact": "Alto", "title": "Netflix firma un acuerdo exclusivo multianual con la Fórmula 1 para transmitir cámaras en vivo desde los monoplazas", "url": "https://about.netflix.com/en/news/netflix-secures-exclusive-formula-1-live-in-car-camera-rights", "date": "04-09-2025", "category": "Derechos/Deportes", "summary": "A partir de la temporada 2026, los suscriptores de Netflix podrán acceder a transmisiones en vivo desde las cámaras a bordo de todos los pilotos durante los Grandes Premios, una movida significativa de la plataforma hacia el contenido deportivo en directo.", "publisher": "about.netflix.com", "url_raw": "https://about.netflix.com/en/news/netflix-secures-exclusive-formula-1-live-in-car-camera-rights", "url_canonical": "https://about.netflix.com/en/news/netflix-secures-exclusive-formula-1-live-in-car-camera-rights", "http_status": "200", "archived_url": "", "language": "en", "out_of_window": false },
      { "id": 103, "entity": "Disney+", "country": "Todos los Países", "impact": "Alto", "title": "Disney anuncia un aumento de precio de 2 dólares/mes para su plan sin publicidad de Disney+, efectivo en octubre de 2025", "url": "https://thewaltdisneycompany.com/disney-plus-ad-free-tier-price-update-october-2025/", "date": "29-08-2025", "category": "Cambio de Precio", "summary": "The Walt Disney Company aumentará el costo de su suscripción premium sin anuncios en EE. UU. y otros mercados seleccionados, en un esfuerzo por mejorar la rentabilidad y fomentar la adopción de sus planes con publicidad.", "publisher": "thewaltdisneycompany.com", "url_raw": "https://thewaltdisneycompany.com/disney-plus-ad-free-tier-price-update-october-2025/", "url_canonical": "https://thewaltdisneycompany.com/disney-plus-ad-free-tier-price-update-october-2025/", "http_status": "200", "archived_url": "", "language": "en", "out_of_window": false },
      { "id": 104, "entity": "Max", "country": "Todos los Países", "impact": "Medio", "title": "Warner Bros. Discovery presenta un nuevo complemento 'Max Sports' que agrupa todo su contenido deportivo en vivo", "url": "https://wbd.com/press/wbd-unveils-max-sports-add-on/", "date": "10-09-2025", "category": "Producto", "summary": "Max ofrecerá un nuevo paquete adicional que incluye el acceso a todo el contenido de TNT Sports (NBA, MLB, NHL) y Eurosport por una tarifa mensual adicional, buscando monetizar su valiosa cartera de derechos deportivos.", "publisher": "wbd.com", "url_raw": "https://wbd.com/press/wbd-unveils-max-sports-add-on/", "url_canonical": "https://wbd.com/press/wbd-unveils-max-sports-add-on/", "http_status": "200", "archived_url": "", "language": "en", "out_of_window": false },
      { "id": 105, "entity": "Spotify", "country": "Todos los Países", "impact": "Medio", "title": "Spotify adquiere la startup de IA musical 'Melodia' para mejorar sus algoritmos de recomendación", "url": "https://newsroom.spotify.com/2025-09-02/spotify-acquires-ai-music-startup-melodia/", "date": "02-09-2025", "category": "Fusión/Adquisición", "summary": "La adquisición tiene como objetivo integrar la tecnología de Melodia para perfeccionar las listas de reproducción personalizadas y explorar nuevas herramientas de creación musical generativa para artistas en la plataforma.", "publisher": "newsroom.spotify.com", "url_raw": "https://newsroom.spotify.com/2025-09-02/spotify-acquires-ai-music-startup-melodia/", "url_canonical": "https://newsroom.spotify.com/2025-09-02/spotify-acquires-ai-music-startup-melodia/", "http_status": "200", "archived_url": "", "language": "en", "out_of_window": false },
      { "id": 106, "entity": "Apple TV+", "country": "Todos los Países", "impact": "Medio", "title": "Apple confirma que la segunda temporada de 'Severance' se estrenará el 14 de noviembre de 2025", "url": "https://www.apple.com/tv-pr/news/2025/09/apples-hit-series-severance-season-two-premieres-november-14/", "date": "05-09-2025", "category": "Producto", "summary": "Tras una larga espera, Apple ha anunciado oficialmente la fecha de estreno de la muy anticipada segunda temporada de su aclamada serie 'Severance', uno de los títulos insignia de la plataforma.", "publisher": "apple.com", "url_raw": "https://www.apple.com/tv-pr/news/2025/09/apples-hit-series-severance-season-two-premieres-november-14/", "url_canonical": "https://www.apple.com/tv-pr/news/2025/09/apples-hit-series-severance-season-two-premieres-november-14/", "http_status": "200", "archived_url": "", "language": "en", "out_of_window": false }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.some(c => item.country.includes(c));
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.some(c => item.country.includes(c));
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const html = [
        `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}all" value="all" class="mr-2"><label for="${idBase}all">Todos</label></div>`,
        ...allItems.map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c.replace(/\s+/g, '-')}" value="${c}" class="mr-2"><label for="${idBase}${c.replace(/\s+/g, '-')}">${c}</label></div>`)
      ].join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES.filter(c => c!=='Todos los Países'), 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, ALL_NEWS_COMPANIES.sort(), 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, ALL_NEWS_CATEGORIES.sort(), 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES.filter(c => c!=='Todos los Países'), 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, ALL_CONTENT_COMPANIES.sort(), 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, ALL_CONTENT_CATEGORIES.sort(), 'content-category-');
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== Lógica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function normalizeSelectAll(container, selectedValues) {
      const allBox = container.querySelector('input[value="all"]');
      const rest = [...container.querySelectorAll('input[type="checkbox"]')].filter(b => b.value !== 'all');
      if (!allBox) return;
      if (selectedValues.includes('all')) rest.forEach(b => b.checked = false);
      else if (rest.some(b => b.checked)) allBox.checked = false;
    }
    function filterNews() {
      let sc = getSelected(newsFilterCountryContainer);
      let se = getSelected(newsFilterCompanyContainer);
      let sk = getSelected(newsFilterCategoryContainer);
      normalizeSelectAll(newsFilterCountryContainer, sc);
      normalizeSelectAll(newsFilterCompanyContainer, se);
      normalizeSelectAll(newsFilterCategoryContainer, sk);
      sc = getSelected(newsFilterCountryContainer);
      se = getSelected(newsFilterCompanyContainer);
      sk = getSelected(newsFilterCategoryContainer);
      newsFilters.country = sc.includes('all') ? [] : sc;
      newsFilters.company = se.includes('all') ? [] : se;
      newsFilters.category = sk.includes('all') ? [] : sk;
      renderNewsCards();
    }
    function filterContentNews() {
      let sc = getSelected(contentFilterCountryContainer);
      let se = getSelected(contentFilterCompanyContainer);
      let sk = getSelected(contentFilterCategoryContainer);
      normalizeSelectAll(contentFilterCountryContainer, sc);
      normalizeSelectAll(contentFilterCompanyContainer, se);
      normalizeSelectAll(contentFilterCategoryContainer, sk);
      sc = getSelected(contentFilterCountryContainer);
      se = getSelected(contentFilterCompanyContainer);
      sk = getSelected(contentFilterCategoryContainer);
      contentFilters.country = sc.includes('all') ? [] : sc;
      contentFilters.company = se.includes('all') ? [] : se;
      contentFilters.category = sk.includes('all') ? [] : sk;
      renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

    updateSentimentContent('Brasil');
    updateNewsFilters(); renderNewsCards();
    updateContentNewsFilters(); renderContentNewsCards();
  </script>
</body>
</html>