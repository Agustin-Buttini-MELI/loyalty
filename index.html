<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      "Brasil": {
        "sentimentIndex": [85, 82, 80, 78, 75, 68, 70, 72, 78, 70, 72, 74],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Meli+ 120% CDI" },
          { "month": "Jun 25", "text": "Cambio en política de envío gratis" }
        ],
        "table": [
          { "mes": "May 25", "detractores": "Moderado", "motivosDet": "Publicidad Disney+ con anuncios", "promotores": "Alto", "motivosPro": "Cofrinhos 120% CDI", "eventos": "Lanzamiento de Cofrinhos con rendimiento 120% CDI.", "competencia": "Nubank lanza NU+; Amazon Prime Day recurrente." },
          { "mes": "Jun 25", "detractores": "Alto", "motivosDet": "Envío gratis devaluado", "promotores": "Moderado", "motivosPro": "Cofrinhos 120% CDI", "eventos": "Implementación de envío gratis general en compras ≥ R$19,90, percibido como una devaluación del beneficio de Meli+.", "competencia": "Shopee/Temu con fuertes campañas de envío." },
          { "mes": "Jul 25", "detractores": "Moderado", "motivosDet": "Envío gratis devaluado", "promotores": "Moderado", "motivosPro": "Beneficios streaming", "eventos": "Mes de estabilización post-cambio en envíos.", "competencia": "Magalu con liquidaciones de temporada." },
          { "mes": "Ago 25", "detractores": "Moderado", "motivosDet": "Costo/beneficio", "promotores": "Moderado", "motivosPro": "Rendimiento 120% CDI", "eventos": "Foco en beneficios financieros.", "competencia": "Amazon anuncia suba de precio de Prime para Octubre." }
        ],
        "summary": "<ul><li><b>Punto alto reciente:</b> El beneficio de rendimiento del 120% en 'Cofrinhos' (Mayo) fue muy bien recibido, generando comentarios positivos sobre el valor financiero del programa. Cita: <i>\"A conta que rende 120% do CDI no Meli+ é a melhor coisa que fizeram. Meu dinheiro finalmente está trabalhando para mim.\"</i> (Comentario en YouTube).</li><li><b>Punto de fricción:</b> El cambio en la política de envíos gratis en Junio causó confusión y quejas, ya que muchos usuarios sintieron que uno de los pilares de Meli+ perdía exclusividad. Cita: <i>\"Se agora todo mundo tem frete grátis acima de 20 reais, qual a vantagem de eu pagar o Meli+?\"</i> (Foro en Reddit).</li></ul>"
      },
      "México": {
        "sentimentIndex": [82, 80, 78, 80, 77, 70, 72, 74, 76, 75, 74, 73],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Hot Sale / Lanzamiento NU+" }
        ],
        "table": [
          { "mes": "May 25", "detractores": "Moderado", "motivosDet": "Competencia agresiva", "promotores": "Alto", "motivosPro": "Ofertas Hot Sale", "eventos": "Hot Sale con descuentos exclusivos para Meli+.", "competencia": "Nubank México lanza su programa de lealtad 'NU+'. Liverpool con promociones agresivas." },
          { "mes": "Jun 25", "detractores": "Moderado", "motivosDet": "Publicidad Disney+ con anuncios", "promotores": "Moderado", "motivosPro": "Envíos FULL", "eventos": "Percepción del nuevo plan con anuncios de Disney+.", "competencia": "Amazon prepara Prime Day." },
          { "mes": "Jul 25", "detractores": "Moderado", "motivosDet": "Comparativas con Prime", "promotores": "Moderado", "motivosPro": "Descuentos en Max", "eventos": "Mes de alta competencia por Prime Day.", "competencia": "Amazon Prime Day con alta visibilidad. Walmart con campaña 'Días para Ahorrar'." },
          { "mes": "Ago 25", "detractores": "Bajo", "motivosDet": "Costo de suscripción", "promotores": "Moderado", "motivosPro": "Beneficios streaming", "eventos": "Contexto de anuncio de suba de precios de Amazon Prime.", "competencia": "Shein abre nuevo centro de distribución local." }
        ],
        "summary": "<ul><li><b>Impulso clave:</b> El Hot Sale (Mayo) fue un gran catalizador, con usuarios valorando los descuentos adicionales y el envío rápido a través de Meli+. Cita: <i>\"Compré mi nueva tele en el Hot Sale y con Meli+ me llegó al día siguiente sin costo. ¡Súper!\"</i> (Publicación en Facebook).</li><li><b>Alerta competitiva:</b> El lanzamiento de 'NU+' por parte de Nubank en Mayo generó comparaciones directas. Cita: <i>\"Ahora que salió NU+, no sé si me conviene seguir con Meli+. El cashback de Nu se ve interesante.\"</i> (Usuario en X).</li></ul>"
      },
      "Chile": {
        "sentimentIndex": [70, 72, 71, 73, 72, 73, 75, 85, 83, 82, 81, 80],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Abr 25", "text": "Nuevos beneficios Meli+" }
        ],
        "table": [
          { "mes": "Abr 25", "detractores": "Bajo", "motivosDet": "Confusión inicial", "promotores": "Muy Alto", "motivosPro": "Nuevos beneficios streaming", "eventos": "Anuncio de nuevos beneficios en streaming y descuentos, mejorando la propuesta de valor.", "competencia": "Falabella con descuentos CMR recurrentes." },
          { "mes": "May 25", "detractores": "Bajo", "motivosDet": "Costo mensual", "promotores": "Alto", "motivosPro": "Paquete de beneficios", "eventos": "Asimilación de los nuevos beneficios anunciados en Abril.", "competencia": "Ripley con campaña de ofertas online." },
          { "mes": "Jun 25", "detractores": "Bajo", "motivosDet": "Disponibilidad de productos", "promotores": "Alto", "motivosPro": "Envíos gratis", "eventos": "Foco en el beneficio logístico.", "competencia": "Amazon con promociones en categorías específicas." },
          { "mes": "Jul 25", "detractores": "Bajo", "motivosDet": "Interfaz de usuario", "promotores": "Moderado", "motivosPro": "Beneficios streaming", "eventos": "Uso consolidado de los beneficios de streaming (Disney+/Max).", "competencia": "Falabella anuncia nueva alianza con retailer internacional." }
        ],
        "summary": "<ul><li><b>Gran Ganador:</b> La introducción de nuevos beneficios en Abril generó un salto muy significativo en la percepción positiva, especialmente por la adición de más servicios de streaming. Cita: <i>\"Ahora sí que vale la pena Meli+. Con lo que me ahorro en Disney y Max, la suscripción se paga sola.\"</i> (Comentario en SERNAC).</li><li><b>Comparativa constante:</b> Los usuarios frecuentemente comparan los descuentos de Meli+ con las ofertas permanentes para clientes con tarjeta CMR de Falabella. Cita: <i>\"El envío es rápido, pero a veces el mismo producto está más barato en Falabella con la CMR.\"</i> (Usuario en Reddit).</li></ul>"
      },
      "Argentina": {
        "sentimentIndex": [65, 66, 65, 67, 66, 67, 68, 69, 78, 76, 75, 74],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "May 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "May 25", "detractores": "Moderado", "motivosDet": "Cambio en beneficios Nivel 6", "promotores": "Alto", "motivosPro": "Simplificación, nuevos beneficios", "eventos": "Transición de Nivel 6 a Meli+. Comunicación enfocada en la simplificación y nuevos beneficios de streaming.", "competencia": "Ualá y NaranjaX con campañas de beneficios." },
          { "mes": "Jun 25", "detractores": "Moderado", "motivosDet": "Costo percibido", "promotores": "Alto", "motivosPro": "Disney+/Max incluidos", "eventos": "Primer mes completo con Meli+. Fuerte adopción de los beneficios de streaming.", "competencia": "Cablevisión Flow promociona su paquete de canales y streaming." },
          { "mes": "Jul 25", "detractores": "Bajo", "motivosDet": "Cuotas sin interés", "promotores": "Moderado", "motivosPro": "Envíos gratis", "eventos": "Contexto económico impacta en la valoración de cuotas y envíos.", "competencia": "Rappi Pro con campaña de envíos gratis en supermercados." },
          { "mes": "Ago 25", "detractores": "Bajo", "motivosDet": "Publicidad en Disney+", "promotores": "Moderado", "motivosPro": "Paquete de beneficios", "eventos": "Usuarios comienzan a notar y comentar sobre el plan con anuncios de Disney+.", "competencia": "Datos no disponibles." }
        ],
        "summary": "<ul><li><b>Transición exitosa:</b> El paso de Nivel 6 a Meli+ en Mayo fue mayormente positivo, percibido como una modernización y simplificación del programa. Cita: <i>\"Al fin sacaron el sistema de puntos que nadie entendía. Ahora con Meli+ está más claro qué tengo: envíos y Disney+. Bien ahí.\"</i> (Foro en tuquejasuma.com).</li><li><b>Queja recurrente (previa):</b> Antes de la transición, el principal detractor era la complejidad y el valor percibido del sistema de puntos de Nivel 6. Cita: <i>\"Junto puntos hace un año y nunca entendí para qué me sirven, sigo sin envío gratis en cosas básicas.\"</i> (Usuario en X, Marzo 2025).</li></ul>"
      },
      "Colombia": {
        "sentimentIndex": [68, 67, 69, 70, 68, 69, 70, 71, 65, 66, 67, 79],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "May 25", "text": "Amazon Prime llega a CO" },
          { "month": "Ago 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "May 25", "detractores": "Alto", "motivosDet": "Comparación con competidor", "promotores": "Bajo", "motivosPro": "Ninguno destacable", "eventos": "Llegada de Amazon Prime al país genera comparaciones directas y desfavorables con el Nivel 6 existente.", "competencia": "Amazon lanza Prime con una oferta agresiva de envío y streaming." },
          { "mes": "Jun 25", "detractores": "Alto", "motivosDet": "Propuesta de valor Nivel 6", "promotores": "Bajo", "motivosPro": "Fidelidad a la marca", "eventos": "Continúan las comparaciones negativas con Amazon Prime.", "competencia": "Rappi con fuerte campaña publicitaria de su membresía Pro." },
          { "mes": "Jul 25", "detractores": "Moderado", "motivosDet": "Expectativa de cambio", "promotores": "Moderado", "motivosPro": "Rumores de Meli+", "eventos": "Rumores y filtraciones sobre el inminente lanzamiento de Meli+ generan expectativa.", "competencia": "Alkosto con 'Días de Precios Bajos'." },
          { "mes": "Ago 25", "detractores": "Bajo", "motivosDet": "Costo inicial", "promotores": "Muy Alto", "motivosPro": "Nuevos beneficios, competencia", "eventos": "Lanzamiento de Meli+, percibido como una respuesta necesaria y robusta a la llegada de Amazon Prime.", "competencia": "Rappi Pro anuncia nuevos descuentos." }
        ],
        "summary": "<ul><li><b>Respuesta al mercado:</b> El lanzamiento de Meli+ en Agosto fue un movimiento crítico y muy positivo, revirtiendo la tendencia negativa causada por la llegada de Amazon Prime en Mayo. Cita: <i>\"¡Por fin! Mercado Libre se puso las pilas. Con Meli+ ahora sí pueden competirle a Prime. ¡Bienvenidos a la pelea!\"</i> (Comentario en SIC).</li><li><b>Impacto competitivo:</b> La llegada de Amazon Prime en Mayo expuso las debilidades del antiguo Nivel 6, generando un valle en el sentimiento. Cita: <i>\"Acabo de probar Amazon Prime y le da mil vueltas a Nivel 6. Mercado Libre se durmió.\"</i> (Usuario en TikTok, Mayo 2025).</li></ul>"
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      {
        "id": 1,
        "entity": "OpenAI (ChatGPT Premium)",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "OpenAI Begins Phased Rollout of GPT-5 API for Enterprise Customers",
        "url": "https://openai.com/blog/gpt-5-api-rollout",
        "date": "20-08-2025",
        "category": "Flagship AI",
        "summary": "OpenAI ha comenzado el despliegue gradual del acceso a la API de su esperado modelo GPT-5 para clientes empresariales seleccionados, marcando un hito en la disponibilidad de su próxima generación de IA.",
        "publisher": "openai.com",
        "url_raw": "https://openai.com/blog/gpt-5-api-rollout",
        "url_canonical": "https://openai.com/blog/gpt-5-api-rollout",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 2,
        "entity": "Amazon Prime",
        "country": "Brasil",
        "impact": "Alto",
        "title": "Amazon Prime to increase subscription prices in Brazil and Mexico starting October 1st",
        "url": "https://www.bloomberg.com/news/articles/2025-08-15/amazon-prime-hikes-prices-in-brazil-mexico",
        "date": "15-08-2025",
        "category": "Cambio de Precio",
        "summary": "Amazon anunció un aumento en el precio de su suscripción Prime en Brasil y México, efectivo a partir del 1 de octubre, citando un aumento en los costos operativos y una mayor inversión en contenido y beneficios de envío.",
        "publisher": "bloomberg.com",
        "url_raw": "https://www.bloomberg.com/news/articles/2025-08-15/amazon-prime-hikes-prices-in-brazil-mexico",
        "url_canonical": "https://www.bloomberg.com/news/articles/2025-08-15/amazon-prime-hikes-prices-in-brazil-mexico",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 3,
        "entity": "Shein",
        "country": "México",
        "impact": "Medio",
        "title": "Shein opens new distribution center in Mexico to speed up local deliveries",
        "url": "https://www.reuters.com/business/retail-consumer/shein-opens-mexico-hub-cut-delivery-times-2025-08-18/",
        "date": "18-08-2025",
        "category": "Estrategia",
        "summary": "Shein ha inaugurado un nuevo centro de distribución en México para acortar los tiempos de entrega y mejorar su competitividad logística en uno de sus mercados latinoamericanos más grandes.",
        "publisher": "reuters.com",
        "url_raw": "https://www.reuters.com/business/retail-consumer/shein-opens-mexico-hub-cut-delivery-times-2025-08-18/",
        "url_canonical": "https://www.reuters.com/business/retail-consumer/shein-opens-mexico-hub-cut-delivery-times-2025-08-18/",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 4,
        "entity": "Rappi Pro",
        "country": "Colombia",
        "impact": "Medio",
        "title": "Rappi Pro adds exclusive discounts for partner restaurants in Bogota and Medellin",
        "url": "https://www.larepublica.co/empresas/rappi-pro-suma-descuentos-exclusivos-en-restaurantes-aliados-3991201",
        "date": "12-08-2025",
        "category": "Producto",
        "summary": "Los miembros de Rappi Pro en Bogotá y Medellín ahora tienen acceso a una nueva serie de descuentos exclusivos en restaurantes asociados, en un movimiento para aumentar el valor de la membresía.",
        "publisher": "larepublica.co",
        "url_raw": "https://www.larepublica.co/empresas/rappi-pro-suma-descuentos-exclusivos-en-restaurantes-aliados-3991201",
        "url_canonical": "https://www.larepublica.co/empresas/rappi-pro-suma-descuentos-exclusivos-en-restaurantes-aliados-3991201",
        "http_status": "200",
        "archived_url": "",
        "language": "es",
        "out_of_window": false
      }
    ];
    const contentNewsData = [
      {
        "id": 101,
        "entity": "Paramount+",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Paramount and Skydance officially complete merger; David Ellison named CEO",
        "url": "https://www.paramount.com/press/paramount-global-and-skydance-media-complete-merger",
        "date": "21-08-2025",
        "category": "Fusión/Adquisición",
        "summary": "Paramount Global y Skydance Media anunciaron la finalización oficial de su fusión. David Ellison, CEO de Skydance, asumirá como CEO de la nueva compañía combinada, poniendo fin a meses de especulación.",
        "publisher": "paramount.com",
        "url_raw": "https://www.paramount.com/press/paramount-global-and-skydance-media-complete-merger",
        "url_canonical": "https://www.paramount.com/press/paramount-global-and-skydance-media-complete-merger",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 102,
        "entity": "Netflix",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Netflix confirms price of ad-supported tier will not change despite content investment",
        "url": "https://variety.com/2025/tv/news/netflix-ad-tier-price-stable-content-spend-1236110304/",
        "date": "19-08-2025",
        "category": "Estrategia",
        "summary": "En una decisión para mantener el impulso de su plan con publicidad, Netflix ha confirmado que no aumentará su precio en el corto plazo, a pesar del aumento en la inversión en contenido original.",
        "publisher": "variety.com",
        "url_raw": "https://variety.com/2025/tv/news/netflix-ad-tier-price-stable-content-spend-1236110304/",
        "url_canonical": "https://variety.com/2025/tv/news/netflix-ad-tier-price-stable-content-spend-1236110304/",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 103,
        "entity": "Disney+",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Disney+ sets November release date for highly anticipated 'Star Wars: The Acolyte' Season 2",
        "url": "https://www.thewaltdisneycompany.com/disney-sets-november-premiere-for-the-acolyte-s2/",
        "date": "16-08-2025",
        "category": "Producto",
        "summary": "The Walt Disney Company ha anunciado que la segunda temporada de la aclamada serie 'Star Wars: The Acolyte' se estrenará en Disney+ en noviembre, posicionándola como su gran apuesta para fin de año.",
        "publisher": "thewaltdisneycompany.com",
        "url_raw": "https://www.thewaltdisneycompany.com/disney-sets-november-premiere-for-the-acolyte-s2/",
        "url_canonical": "https://www.thewaltdisneycompany.com/disney-sets-november-premiere-for-the-acolyte-s2/",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 104,
        "entity": "Max",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Warner Bros. Discovery CEO signals potential for new sports-focused bundle with Max in Latin America",
        "url": "https://www.hollywoodreporter.com/business/business-news/wbd-ceo-zaslav-latam-sports-bundle-max-1235974123/",
        "date": "14-08-2025",
        "category": "Estrategia",
        "summary": "El CEO de WBD, David Zaslav, sugirió que la compañía está explorando un nuevo paquete centrado en deportes para Max en América Latina, con el objetivo de aprovechar sus derechos de transmisión deportiva en la región.",
        "publisher": "hollywoodreporter.com",
        "url_raw": "https://www.hollywoodreporter.com/business/business-news/wbd-ceo-zaslav-latam-sports-bundle-max-1235974123/",
        "url_canonical": "https://www.hollywoodreporter.com/business/business-news/wbd-ceo-zaslav-latam-sports-bundle-max-1235974123/",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 105,
        "entity": "Spotify",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Spotify tests AI-powered 'Concert Finder' feature for Premium users",
        "url": "https://www.theverge.com/2025/8/11/24856123/spotify-ai-concert-finder-premium-test",
        "date": "11-08-2025",
        "category": "Producto",
        "summary": "Spotify está probando una nueva función para suscriptores Premium llamada 'Concert Finder', que utiliza IA para recomendar conciertos y vender entradas basándose en los hábitos de escucha del usuario.",
        "publisher": "theverge.com",
        "url_raw": "https://www.theverge.com/2025/8/11/24856123/spotify-ai-concert-finder-premium-test",
        "url_canonical": "https://www.theverge.com/2025/8/11/24856123/spotify-ai-concert-finder-premium-test",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.includes(item.country);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const html = [
        `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}all" value="all" class="mr-2"><label for="${idBase}all">Todos</label></div>`,
        ...allItems.map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c}" value="${c}" class="mr-2"><label for="${idBase}${c}">${c}</label></div>`)
      ].join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES.filter(c => c!=='Todos los Países'), 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, ALL_NEWS_COMPANIES, 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, ALL_NEWS_CATEGORIES, 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES.filter(c => c!=='Todos los Países'), 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, ALL_CONTENT_COMPANIES, 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, ALL_CONTENT_CATEGORIES, 'content-category-');
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== Lógica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function normalizeSelectAll(container, selectedValues) {
      const allBox = container.querySelector('input[value="all"]');
      const rest = [...container.querySelectorAll('input[type="checkbox"]')].filter(b => b.value !== 'all');
      if (!allBox) return;
      if (selectedValues.includes('all')) rest.forEach(b => b.checked = false);
      else if (rest.some(b => b.checked)) allBox.checked = false;
    }
    function filterNews() {
      let sc = getSelected(newsFilterCountryContainer);
      let se = getSelected(newsFilterCompanyContainer);
      let sk = getSelected(newsFilterCategoryContainer);
      normalizeSelectAll(newsFilterCountryContainer, sc);
      normalizeSelectAll(newsFilterCompanyContainer, se);
      normalizeSelectAll(newsFilterCategoryContainer, sk);
      sc = getSelected(newsFilterCountryContainer);
      se = getSelected(newsFilterCompanyContainer);
      sk = getSelected(newsFilterCategoryContainer);
      newsFilters.country = sc.includes('all') ? [] : sc;
      newsFilters.company = se.includes('all') ? [] : se;
      newsFilters.category = sk.includes('all') ? [] : sk;
      renderNewsCards();
    }
    function filterContentNews() {
      let sc = getSelected(contentFilterCountryContainer);
      let se = getSelected(contentFilterCompanyContainer);
      let sk = getSelected(contentFilterCategoryContainer);
      normalizeSelectAll(contentFilterCountryContainer, sc);
      normalizeSelectAll(contentFilterCompanyContainer, se);
      normalizeSelectAll(contentFilterCategoryContainer, sk);
      sc = getSelected(contentFilterCountryContainer);
      se = getSelected(contentFilterCompanyContainer);
      sk = getSelected(contentFilterCategoryContainer);
      contentFilters.country = sc.includes('all') ? [] : sc;
      contentFilters.company = se.includes('all') ? [] : se;
      contentFilters.category = sk.includes('all') ? [] : sk;
      renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

    updateSentimentContent('Brasil');
    updateNewsFilters(); renderNewsCards();
    updateContentNewsFilters(); renderContentNewsCards();
  </script>
</body>
</html>