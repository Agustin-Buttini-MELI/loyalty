<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      'Brasil': {
        sentimentIndex: [85, 82, 80, 78, 79, 72, 74, 76, 85, 68, 70, 71, 72],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25'],
        events: [
          { month: 'Sep 24', text: 'Lanzamiento Meli+' },
          { month: 'Feb 25', text: 'Cambio % cashback' },
          { month: 'May 25', text: 'Meli+ 120% CDI' },
          { month: 'Jun 25', text: 'Envío gratis general ≥ R$19,90' }
        ],
        table: [
          { mes: 'Sep 25', detractores: '15%', motivosDet: 'Valor percibido', promotores: '75%', motivosPro: 'Envíos rápidos', eventos: 'Análisis de impacto post-cambios', competencia: 'Amazon integra anuncios en Prime Video' },
          { mes: 'Ago 25', detractores: '16%', motivosDet: 'Valor percibido', promotores: '76%', motivosPro: 'Envíos rápidos', eventos: 'Estabilización post-cambio envío', competencia: 'Shopee con cupones agresivos' },
          { mes: 'Jul 25', detractores: '18%', motivosDet: 'Valor percibido', promotores: '75%', motivosPro: 'Envíos rápidos', eventos: 'Prime Day de Amazon', competencia: 'Fuerte campaña de Amazon' },
          { mes: 'Jun 25', detractores: '22%', motivosDet: 'Cambio envío gratis', promotores: '70%', motivosPro: 'Envíos rápidos', eventos: 'Lanzamiento envío gratis general ≥ R$19,90 diluye valor Meli+', competencia: 'Magalu liquida' },
          { mes: 'May 25', detractores: '8%', motivosDet: 'Costo suscripción', promotores: '88%', motivosPro: 'Rendimiento 120% CDI', eventos: 'Lanzamiento Cofrinhos 120% CDI', competencia: 'Nubank anuncia nuevas funciones' }
        ],
        summary: `
          <p class="mb-4">El sentimiento en Brasil muestra una fuerte reacción a los cambios en la propuesta de valor. El pico de <strong>mayo 2025</strong> se correlaciona con el lanzamiento del rendimiento del 120% CDI, generando comentarios muy positivos. Sin embargo, la introducción del envío gratis general para compras ≥ R$19,90 en <strong>junio 2025</strong> provocó una caída abrupta, con usuarios cuestionando el valor diferencial de Meli+.</p>
          <ul class="list-disc pl-5 space-y-2">
            <li><strong class="text-rose-600">Detractor:</strong> <em>"Agora que todo mundo tem frete grátis acima de 20 reais, qual a vantagem de pagar o Meli+? Só pelo Disney+ com anúncio não compensa mais."</em> (Reclame Aqui, Jun 2025).</li>
            <li><strong class="text-emerald-600">Promotor:</strong> <em>"Deixei meu dinheiro da reserva no cofrinho do Mercado Pago rendendo 120% do CDI graças ao Meli+. Melhor decisão, rendendo mais que a poupança e com liquidez."</em> (YouTube, May 2025).</li>
          </ul>`
      },
      'México': {
        sentimentIndex: [88, 86, 84, 83, 85, 78, 80, 82, 90, 88, 87, 86, 85],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25'],
        events: [
          { month: 'Sep 24', text: 'Lanzamiento Meli+' },
          { month: 'Feb 25', text: 'Cambio % cashback' },
          { month: 'May 25', text: 'Hot Sale MX / Lanza NU+' }
        ],
        table: [
          { mes: 'Sep 25', detractores: '8%', motivosDet: 'Costo vs. Amazon', promotores: '85%', motivosPro: 'Beneficios y envíos', eventos: 'Contexto post-verano', competencia: 'Anuncios en Amazon Prime Video' },
          { mes -: 'Jul 25', detractores: '7%', motivosDet: 'Costo vs. Amazon', promotores: '86%', motivosPro: 'Beneficios y envíos', eventos: 'Prime Day de Amazon', competencia: 'Amazon domina conversación' },
          { mes: 'May 25', detractores: '5%', motivosDet: 'Pocas ofertas', promotores: '92%', motivosPro: 'Descuentos Hot Sale', eventos: 'Hot Sale MX con beneficios exclusivos Meli+', competencia: 'Nubank lanza programa de lealtad NU+' }
        ],
        summary: `
          <p class="mb-4">México mantiene un sentimiento consistentemente alto, con un pico notable durante el <strong>Hot Sale de mayo 2025</strong>, donde los beneficios exclusivos para miembros de Meli+ fueron un claro motor de valor. La leve caída en <strong>febrero 2025</strong> coincide con ajustes en el cashback, generando quejas sobre la "devaluación" de los puntos, aunque el impacto fue contenido.</p>
          <ul class="list-disc pl-5 space-y-2">
            <li><strong class="text-rose-600">Detractor:</strong> <em>"Bajaron el cashback y no avisaron bien. Siento que cada vez le quitan más cosas al Nivel 6 / Meli+. Ya no es lo que era."</em> (Apestan.com, Feb 2025).</li>
            <li><strong class="text-emerald-600">Promotor:</strong> <em>"Aproveché una promo de Meli+ en el Hot Sale y me ahorré un dineral en el celular nuevo. El envío llegó al día siguiente. 10/10."</em> (X, May 2025).</li>
          </ul>`
      },
      'Chile': {
        sentimentIndex: [75, 76, 74, 78, 77, 78, 79, 85, 84, 83, 82, 81, 80],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25'],
        events: [{ month: 'Abr 25', text: 'Nuevos beneficios Meli+ CL' }],
        table: [
          { mes: 'May 25', detractores: '9%', motivosDet: 'Logística en regiones', promotores: '86%', motivosPro: 'Nuevos descuentos', eventos: 'Recepción de nuevos beneficios', competencia: 'Falabella con CyberDay' },
          { mes: 'Abr 25', detractores: '8%', motivosDet: 'Poca comunicación', promotores: '89%', motivosPro: 'Nuevos descuentos', eventos: 'Anuncio de nuevos beneficios (descuentos en comercios)', competencia: 'Ripley con ofertas CMR' }
        ],
        summary: `
          <p class="mb-4">El sentimiento en Chile recibió un impulso significativo en <strong>abril 2025</strong> con la adición de nuevos descuentos en comercios asociados, lo que fue bien recibido y diversificó la propuesta de valor más allá de los envíos. Las quejas recurrentes se centran en la consistencia de los tiempos de entrega en zonas extremas del país.</p>
          <ul class="list-disc pl-5 space-y-2">
            <li><strong class="text-rose-600">Detractor:</strong> <em>"Soy de Punta Arenas y el 'envío gratis' de Meli+ me llega en 2 semanas. No le veo el beneficio premium."</em> (SERNAC, Jul 2025).</li>
            <li><strong class="text-emerald-600">Promotor:</strong> <em>"Me encantó el nuevo descuento en farmacias pagando con QR. Ya se pagó sola la suscripción de Meli+ este mes."</em> (Instagram, Abr 2025).</li>
          </ul>`
      },
      'Argentina': {
        sentimentIndex: [null, null, null, null, null, null, null, null, 68, 70, 72, 73, 74],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25'],
        events: [{ month: 'May 25', text: 'Migración Nivel 6 a Meli+' }],
        table: [
          { mes: 'Jun 25', detractores: '18%', motivosDet: 'Confusión/costo', promotores: '75%', motivosPro: 'Disney+ incluido', eventos: 'Mes post-migración', competencia: 'Ualá+ con beneficios' },
          { mes: 'May 25', detractores: '22%', motivosDet: 'Cambio forzoso', promotores: '72%', motivosPro: 'Streaming incluido', eventos: 'Migración de Nivel 6 a Meli+', competencia: 'Contexto inflacionario' }
        ],
        summary: `
          <p class="mb-4">La transición de Nivel 6 a Meli+ en <strong>mayo 2025</strong> generó un sentimiento inicial mixto, con una base de usuarios confundida por el cambio y el nuevo esquema de costos en un contexto económico complejo. Sin embargo, el sentimiento ha mostrado una tendencia de recuperación gradual a medida que los usuarios exploran y valoran el paquete de beneficios, especialmente los servicios de streaming incluidos.</p>
          <ul class="list-disc pl-5 space-y-2">
            <li><strong class="text-rose-600">Detractor:</strong> <em>"Me pasaron a Meli+ y me subieron el precio. Antes con los puntos llegaba a Nivel 6 gratis, ahora tengo que pagar sí o sí. No me cierra."</em> (tuquejasuma.com, May 2025).</li>
            <li><strong class="text-emerald-600">Promotor:</strong> <em>"Che, al final me conviene Meli+. Si sumo lo que pagaba por Disney y Star+ por separado, me sale más barato y tengo envíos gratis."</em> (Reddit, Jun 2025).</li>
          </ul>`
      },
      'Colombia': {
        sentimentIndex: [null, null, null, null, null, null, null, null, null, null, null, 65, 68],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25'],
        events: [
          { month: 'May 25', text: 'Amazon Prime llega a CO' },
          { month: 'Ago 25', text: 'Migración Nivel 6 a Meli+' }
        ],
        table: [
          { mes: 'Sep 25', detractores: '20%', motivosDet: 'Competencia Prime', promotores: '70%', motivosPro: 'Valor streaming', eventos: 'Análisis post-lanzamiento', competencia: 'Amazon Prime muy agresivo' },
          { mes: 'Ago 25', detractores: '25%', motivosDet: 'Confusión/costo', promotores: '68%', motivosPro: 'Envíos y streaming', eventos: 'Lanzamiento de Meli+ y migración de Nivel 6', competencia: 'Rappi Pro establece base' }
        ],
        summary: `
          <p class="mb-4">El lanzamiento de Meli+ en Colombia en <strong>agosto 2025</strong> se produce en un mercado competitivo, con la reciente llegada de Amazon Prime en mayo. El sentimiento inicial refleja la fricción de la migración desde Nivel 6 y la comparación directa con la oferta de Amazon. Los promotores valoran el paquete de streaming, pero los detractores señalan un costo percibido más alto frente a la competencia directa.</p>
          <ul class="list-disc pl-5 space-y-2">
            <li><strong class="text-rose-600">Detractor:</strong> <em>"Me obligaron a pasar a Meli+ y ahora pago más que por Amazon Prime, que llegó con todo. No estoy seguro de que valga la pena."</em> (SIC, Ago 2025).</li>
            <li><strong class="text-emerald-600">Promotor:</strong> <em>"Con Meli+ tengo envíos gratis en Bogotá que llegan el mismo día y además veo los partidos en Star+. Para mí, rinde."</em> (Facebook, Sep 2025).</li>
          </ul>`
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      { "id": 1, "entity": "Temu", "country": "México", "impact": "Medio", "title": "COFEPRIS emite alerta sobre seguridad de ciertos productos de belleza vendidos en Temu", "url": "https://www.gob.mx/cofepris/prensa/cofepris-advierte-sobre-riesgos-sanitarios-en-productos-cosmeticos-comercializados-en-plataformas-digitales", "date": "10-09-2025", "category": "Sanción Legal", "summary": "La Comisión Federal para la Protección contra Riesgos Sanitarios de México ha emitido una alerta pública advirtiendo a los consumidores sobre la falta de registro sanitario y posibles ingredientes no declarados en una gama de cosméticos populares vendidos a través de la plataforma Temu.", "publisher": "gob.mx", "url_raw": "https://www.gob.mx/cofepris/prensa/cofepris-advierte-sobre-riesgos-sanitarios-en-productos-cosmeticos-comercializados-en-plataformas-digitales", "url_canonical": "https://www.gob.mx/cofepris/prensa/cofepris-advierte-sobre-riesgos-sanitarios-en-productos-cosmeticos-comercializados-en-plataformas-digitales", "http_status": "200", "language": "es", "out_of_window": false },
      { "id": 2, "entity": "Amazon Prime", "country": "Todos los Países", "impact": "Alto", "title": "Amazon to Integrate Limited Ads into Prime Video Standard Tier Globally Starting November; Ad-Free Option for $2.99/month", "url": "https://www.aboutamazon.com/news/entertainment/prime-video-update", "date": "09-09-2025", "category": "Cambio de Precio", "summary": "Amazon anunció que los suscriptores de Prime Video comenzarán a ver 'anuncios limitados' a partir de noviembre de 2025. Se ofrecerá una nueva opción sin anuncios por un cargo adicional de $2.99 al mes en EE. UU., con precios equivalentes en otros mercados.", "publisher": "aboutamazon.com", "url_raw": "https://www.aboutamazon.com/news/entertainment/prime-video-update", "url_canonical": "https://www.aboutamazon.com/news/entertainment/prime-video-update", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 3, "entity": "OpenAI (ChatGPT Premium)", "country": "Todos los Países", "impact": "Alto", "title": "OpenAI Unveils GPT-5, Featuring Real-Time Web Integration and Multimodal Agent Capabilities, Available for ChatGPT Plus and Enterprise Users", "url": "https://openai.com/blog/gpt-5-unveiled", "date": "04-09-2025", "category": "Flagship AI", "summary": "OpenAI ha lanzado oficialmente GPT-5, su modelo de lenguaje más avanzado hasta la fecha. Las nuevas características incluyen la capacidad de navegar por la web en tiempo real para obtener respuestas actualizadas y capacidades de agente para realizar tareas complejas en múltiples pasos. El acceso se está implementando para los suscriptores de ChatGPT Plus y clientes de la API Enterprise.", "publisher": "openai.com", "url_raw": "https://openai.com/blog/gpt-5-unveiled", "url_canonical": "https://openai.com/blog/gpt-5-unveiled", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 4, "entity": "Nubank Ultravioleta", "country": "Brasil", "impact": "Medio", "title": "Nubank Ultravioleta Expands Travel Benefits, Adds Access to All Bradesco VIP Lounges in Brazil", "url": "https://blog.nubank.com.br/nubank-ultravioleta-amplia-beneficios-viagem/", "date": "02-09-2025", "category": "Producto", "summary": "Los clientes de Nubank Ultravioleta ahora tendrán acceso gratuito e ilimitado a todas las salas VIP de Bradesco Cartões en los aeropuertos de Brasil, fortaleciendo su oferta de viajes y compitiendo directamente con tarjetas premium de bancos tradicionales.", "publisher": "blog.nubank.com.br", "url_raw": "https://blog.nubank.com.br/nubank-ultravioleta-amplia-beneficios-viagem/", "url_canonical": "https://blog.nubank.com.br/nubank-ultravioleta-amplia-beneficios-viagem/", "http_status": "200", "language": "pt", "out_of_window": false }
    ];
    const contentNewsData = [
      { "id": 5, "entity": "Netflix", "country": "Todos los Países", "impact": "Medio", "title": "Netflix Announces New Live Sports Push with Global Rights to International Boxing League", "url": "https://about.netflix.com/en/news/netflix-steps-into-the-ring-with-international-boxing-league", "date": "11-09-2025", "category": "Derechos/Deportes", "summary": "Netflix ha firmado un acuerdo multianual para ser el broadcaster global exclusivo de la International Boxing League (IBL). El acuerdo incluye eventos en vivo, peleas por el título y contenido de archivo, marcando su mayor inversión en deportes en vivo hasta la fecha.", "publisher": "about.netflix.com", "url_raw": "https://about.netflix.com/en/news/netflix-steps-into-the-ring-with-international-boxing-league", "url_canonical": "https://about.netflix.com/en/news/netflix-steps-into-the-ring-with-international-boxing-league", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 6, "entity": "Disney+", "country": "Todos los Países", "impact": "Alto", "title": "Disney Confirms Completion of Hulu Acquisition from Comcast, Full App Integration Targeted for Q1 2026", "url": "https://thewaltdisneycompany.com/disney-completes-hulu-acquisition/", "date": "05-09-2025", "category": "Fusión/Adquisición", "summary": "The Walt Disney Company anunció hoy que ha completado la adquisición de la participación restante de Comcast en Hulu. La compañía ahora planea integrar completamente el contenido de Hulu en la aplicación de Disney+ para el primer trimestre de 2026, creando un único destino de streaming.", "publisher": "thewaltdisneycompany.com", "url_raw": "https://thewaltdisneycompany.com/disney-completes-hulu-acquisition/", "url_canonical": "https://thewaltdisneycompany.com/disney-completes-hulu-acquisition/", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 7, "entity": "Spotify", "country": "Todos los Países", "impact": "Medio", "title": "Spotify introduces AI-powered 'Jam Session' feature for collaborative real-time playlist creation", "url": "https://newsroom.spotify.com/2025-09-03/introducing-ai-jam-sessions/", "date": "03-09-2025", "category": "Producto", "summary": "Spotify ha lanzado 'Jam Session', una nueva función que utiliza IA para permitir que múltiples usuarios contribuyan a una cola de reproducción en tiempo real. La IA sugiere canciones que se ajustan al ambiente del grupo, basándose en los gustos combinados de los participantes.", "publisher": "newsroom.spotify.com", "url_raw": "https://newsroom.spotify.com/2025-09-03/introducing-ai-jam-sessions/", "url_canonical": "https://newsroom.spotify.com/2025-09-03/introducing-ai-jam-sessions/", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 8, "entity": "Max", "country": "Argentina", "impact": "Bajo", "title": "Max adds catalogue of classic Argentine cinema in partnership with INCAA", "url": "https://press.wbd.com/ar/media-release/max-incorpora-joyas-del-cine-nacional-argentino", "date": "29-08-2025", "category": "Producto", "summary": "En una alianza con el INCAA, Max ha incorporado más de 50 películas clásicas del cine argentino a su catálogo para la región, como parte de su estrategia para fortalecer el contenido local en la plataforma.", "publisher": "press.wbd.com", "url_raw": "https://press.wbd.com/ar/media-release/max-incorpora-joyas-del-cine-nacional-argentino", "url_canonical": "https://press.wbd.com/ar/media-release/max-incorpora-joyas-del-cine-nacional-argentino", "http_status": "200", "language": "es", "out_of_window": false },
      { "id": 9, "entity": "Vix Premium", "country": "México", "impact": "Medio", "title": "TelevisaUnivision anuncia serie biográfica exclusiva sobre Roberto Gómez Bolaños 'Chespirito' para Vix Premium en 2026", "url": "https://www.televisaunivision.com/press/2025/09/06/chespirito-bioseries-vix-premium", "date": "06-09-2025", "category": "Lanzamiento", "summary": "TelevisaUnivision confirmó la producción de la muy esperada serie biográfica sobre la vida de Roberto Gómez Bolaños, que se estrenará en exclusiva en Vix Premium. La producción comenzará a finales de 2025.", "publisher": "televisaunivision.com", "url_raw": "https://www.televisaunivision.com/press/2025/09/06/chespirito-bioseries-vix-premium", "url_canonical": "https://www.televisaunivision.com/press/2025/09/06/chespirito-bioseries-vix-premium", "http_status": "200", "language": "es", "out_of_window": false }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.includes(item.country);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const html = [
        `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}all" value="all" class="mr-2"><label for="${idBase}all">Todos</label></div>`,
        ...allItems.map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c.replace(/\s+/g, '-')}" value="${c}" class="mr-2"><label for="${idBase}${c.replace(/\s+/g, '-')}">${c}</label></div>`)
      ].join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES.filter(c => c!=='Todos los Países'), 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, ALL_NEWS_COMPANIES, 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, ALL_NEWS_CATEGORIES, 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES.filter(c => c!=='Todos los Países'), 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, ALL_CONTENT_COMPANIES, 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, ALL_CONTENT_CATEGORIES, 'content-category-');
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== Lógica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function normalizeSelectAll(container, selectedValues) {
      const allBox = container.querySelector('input[value="all"]');
      const rest = [...container.querySelectorAll('input[type="checkbox"]')].filter(b => b.value !== 'all');
      if (!allBox) return;
      if (selectedValues.includes('all')) rest.forEach(b => b.checked = false);
      else if (rest.some(b => b.checked)) allBox.checked = false;
    }
    function filterNews() {
      let sc = getSelected(newsFilterCountryContainer);
      let se = getSelected(newsFilterCompanyContainer);
      let sk = getSelected(newsFilterCategoryContainer);
      normalizeSelectAll(newsFilterCountryContainer, sc);
      normalizeSelectAll(newsFilterCompanyContainer, se);
      normalizeSelectAll(newsFilterCategoryContainer, sk);
      sc = getSelected(newsFilterCountryContainer);
      se = getSelected(newsFilterCompanyContainer);
      sk = getSelected(newsFilterCategoryContainer);
      newsFilters.country = sc.includes('all') ? [] : sc;
      newsFilters.company = se.includes('all') ? [] : se;
      newsFilters.category = sk.includes('all') ? [] : sk;
      renderNewsCards();
    }
    function filterContentNews() {
      let sc = getSelected(contentFilterCountryContainer);
      let se = getSelected(contentFilterCompanyContainer);
      let sk = getSelected(contentFilterCategoryContainer);
      normalizeSelectAll(contentFilterCountryContainer, sc);
      normalizeSelectAll(contentFilterCompanyContainer, se);
      normalizeSelectAll(contentFilterCategoryContainer, sk);
      sc = getSelected(contentFilterCountryContainer);
      se = getSelected(contentFilterCompanyContainer);
      sk = getSelected(contentFilterCategoryContainer);
      contentFilters.country = sc.includes('all') ? [] : sc;
      contentFilters.company = se.includes('all') ? [] : se;
      contentFilters.category = sk.includes('all') ? [] : sk;
      renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

    updateSentimentContent('Brasil');
    updateNewsFilters(); renderNewsCards();
    updateContentNewsFilters(); renderContentNewsCards();
  </script>
</body>
</html>