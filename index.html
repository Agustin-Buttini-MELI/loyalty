<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      "Brasil": {
        "sentimentIndex": [85, 82, 80, 83, 81, 75, 77, 78, 82, 74, 76, 78],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Beneficio 120% CDI" },
          { "month": "Jun 25", "text": "Envío gratis ≥ R$19,90" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Estables", "motivosDet": "Confusión envíos", "promotores": "Crecimiento", "motivosPro": "Beneficios integrados", "eventos": "-", "competencia": "Amazon/Shopee agresivos en precios" },
          { "mes": "Jul 25", "detractores": "Baja", "motivosDet": "Disney+ c/ anuncios", "promotores": "Estables", "motivosPro": "120% CDI", "eventos": "-", "competencia": "Prime Day (Amazon)" },
          { "mes": "Jun 25", "detractores": "Pico", "motivosDet": "Cambio umbral envío", "promotores": "Baja", "motivosPro": "Disney+", "eventos": "Envío gratis ≥ R$19,90", "competencia": "Shopee con cupones de envío" },
          { "mes": "May 25", "detractores": "Baja", "motivosDet": "Precio suscripción", "promotores": "Pico", "motivosPro": "120% CDI", "eventos": "Lanzamiento Cofrinhos 120% CDI", "competencia": "Nubank con nuevos beneficios" }
        ],
        "summary": "<ul><li><strong>Detractores:</strong> El cambio en el umbral de envío gratis en Junio 2025 generó un pico de quejas, percibido como una devaluación del beneficio principal. <em>\"Agora tenho que gastar mais pra ter frete grátis mesmo sendo Meli+? Não faz sentido, o benefício era justamente esse.\"</em> (Fuente: Reclame Aqui).</li><li><strong>Promotores:</strong> El beneficio de rendimiento del 120% del CDI en 'Cofrinhos' (Mayo 2025) fue muy bien recibido, atrayendo a usuarios que valoran los servicios financieros integrados. <em>\"O rendimento de 120% CDI junto com os descontos e frete grátis é o melhor pacote do mercado hoje.\"</em> (Fuente: YouTube).</li></ul>"
      },
      "México": {
        "sentimentIndex": [88, 85, 84, 86, 83, 78, 80, 81, 79, 81, 80, 82],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Hot Sale / Lanza NU+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Estables", "motivosDet": "Costo/Beneficio", "promotores": "Crecimiento", "motivosPro": "Paquete de servicios", "eventos": "-", "competencia": "Amazon con ofertas agresivas" },
          { "mes": "Jul 25", "detractores": "Baja", "motivosDet": "Disney+ c/ anuncios", "promotores": "Estables", "motivosPro": "Envíos rápidos", "eventos": "-", "competencia": "Prime Day (Amazon)" },
          { "mes": "Jun 25", "detractores": "Estables", "motivosDet": "Cashback bajo", "promotores": "Estables", "motivosPro": "Descuentos en Max", "eventos": "-", "competencia": "Liverpool con ventas nocturnas" },
          { "mes": "May 25", "detractores": "Pico", "motivosDet": "Ofertas Hot Sale", "promotores": "Baja", "motivosPro": "Disney+/Max", "eventos": "Hot Sale, lanzamiento NU+", "competencia": "Nubank lanza NU+, Amazon agresivo" }
        ],
        "summary": "<ul><li><strong>Detractores:</strong> La percepción de valor disminuyó durante el Hot Sale (Mayo 2025), donde las ofertas de competidores como Amazon y Liverpool fueron percibidas como más agresivas. <em>\"Para el Hot Sale no sentí ninguna ventaja real por ser Meli+, Amazon tenía mejores precios en lo que buscaba.\"</em> (Fuente: Reddit r/MexicoFinanciero).</li><li><strong>Promotores:</strong> La conveniencia de tener envíos gratis, Disney+ y Max en un solo paquete sigue siendo el principal motor de lealtad. <em>\"Pago Meli+ y ya no me preocupo por el envío y de paso tengo las series que ven mis hijos, me ahorra varias suscripciones.\"</em> (Fuente: X).</li></ul>"
      },
      "Chile": {
        "sentimentIndex": [70, 72, 71, 73, 74, 75, 78, 85, 83, 82, 81, 80],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Abr 25", "text": "Nuevos beneficios Meli+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Estables", "motivosDet": "Tiempos de envío", "promotores": "Estables", "motivosPro": "Beneficios streaming", "eventos": "-", "competencia": "Falabella con descuentos CMR" },
          { "mes": "Jul 25", "detractores": "Estables", "motivosDet": "Pocas cuotas", "promotores": "Estables", "motivosPro": "Descuentos", "eventos": "-", "competencia": "Cyberday" },
          { "mes": "Jun 25", "detractores": "Baja", "motivosDet": "Costo", "promotores": "Estables", "motivosPro": "Universal+", "eventos": "-", "competencia": "Ripley con ofertas" },
          { "mes": "Abr 25", "detractores": "Baja", "motivosDet": "Comunicación cambio", "promotores": "Pico", "motivosPro": "Nuevos beneficios", "eventos": "Lanzamiento beneficios Meli+", "competencia": "-" }
        ],
        "summary": "<ul><li><strong>Promotores:</strong> El pico de sentimiento positivo en Abril 2025 se correlaciona directamente con la adición de nuevos beneficios de streaming y descuentos, lo que fue comunicado como una mejora sustancial del programa. <em>\"Ahora que Meli+ incluye Universal+ y más descuentos vale totalmente la pena, antes estaba en duda.\"</em> (Fuente: Facebook).</li><li><strong>Detractores:</strong> Las quejas recurrentes, aunque minoritarias, se centran en la competencia de retailers tradicionales como Falabella, cuyos descuentos con tarjeta CMR a veces son percibidos como más atractivos para compras grandes. <em>\"Entre el descuento con CMR en Falabella y el envío de Meli+, a veces conviene más Falabella.\"</em> (Fuente: SERNAC).</li></ul>"
      },
      "Argentina": {
        "sentimentIndex": [68, 65, 66, 69, 67, 68, 70, 72, 75, 74, 76, 77],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "May 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Estables", "motivosDet": "Precio vs inflación", "promotores": "Crecimiento", "motivosPro": "Claridad de beneficios", "eventos": "-", "competencia": "Promociones bancarias" },
          { "mes": "Jul 25", "detractores": "Estables", "motivosDet": "Costo envío", "promotores": "Estables", "motivosPro": "Disney+", "eventos": "-", "competencia": "NaranjaX con descuentos" },
          { "mes": "Jun 25", "detractores": "Baja", "motivosDet": "Confusión inicial", "promotores": "Estables", "motivosPro": "Envíos gratis", "eventos": "-", "competencia": "Hot Sale" },
          { "mes": "May 25", "detractores": "Pico inicial", "motivosDet": "Fin Nivel 6", "promotores": "Pico", "motivosPro": "Nuevo Meli+", "eventos": "Lanzamiento Meli+ (reemplaza Nivel 6)", "competencia": "-" }
        ],
        "summary": "<ul><li><strong>Promotores:</strong> El cambio de 'Nivel 6' a 'Meli+' en Mayo 2025, aunque con una fricción inicial, resultó en una tendencia positiva a mediano plazo. Los usuarios valoran la simplicidad y la claridad del nuevo programa. <em>\"Al principio no entendía el cambio de Nivel 6, pero ahora con Meli+ está todo más claro: pagás esto y tenés esto, punto.\"</em> (Fuente: tuquejasuma.com).</li><li><strong>Detractores:</strong> La principal fuente de sentimiento negativo es el contexto inflacionario del país, que lleva a los usuarios a cuestionar constantemente el costo del servicio frente a su poder adquisitivo. <em>\"Aumenta Meli+, aumenta todo... se hace difícil justificar el gasto fijo.\"</em> (Fuente: X).</li></ul>"
      },
      "Colombia": {
        "sentimentIndex": [65, 66, 64, 67, 68, 69, 67, 66, 63, 65, 68, 75],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "May 25", "text": "Amazon Prime llega a CO" },
          { "month": "Ago 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Pico inicial", "motivosDet": "Confusión cambio", "promotores": "Pico", "motivosPro": "Nuevos beneficios", "eventos": "Lanzamiento Meli+ (reemplaza Nivel 6)", "competencia": "Amazon Prime muy presente" },
          { "mes": "Jul 25", "detractores": "Estables", "motivosDet": "Valor vs Prime", "promotores": "Baja", "motivosPro": "Ecosistema Meli", "eventos": "-", "competencia": "Prime Day (Amazon)" },
          { "mes": "Jun 25", "detractores": "Estables", "motivosDet": "Comparativas con Prime", "promotores": "Baja", "motivosPro": "Envíos", "eventos": "-", "competencia": "Rappi Pro con ofertas" },
          { "mes": "May 25", "detractores": "Pico", "motivosDet": "Llegada Amazon Prime", "promotores": "Baja", "motivosPro": "Beneficios Nivel 6", "eventos": "Amazon Prime lanza en Colombia", "competencia": "Fuerte campaña de lanzamiento de Amazon" }
        ],
        "summary": "<ul><li><strong>Contexto clave:</strong> El sentimiento hacia el programa de lealtad de Mercado Libre se vio impactado negativamente en Mayo 2025 con el agresivo lanzamiento de Amazon Prime en el país. El índice de sentimiento tocó su punto más bajo en ese mes.</li><li><strong>Promotores:</strong> El reciente lanzamiento de Meli+ en Agosto 2025 ha generado un repunte significativo, con comentarios positivos sobre la inclusión de Disney+ y Max. <em>\"¡Por fin! Con el Meli+ nuevo ahora sí le compite de frente a Prime. Me cambio de una por el combo con Max.\"</em> (Fuente: Instagram).</li><li><strong>Detractores:</strong> Las quejas post-lanzamiento de Meli+ se centran en la experiencia de usuario durante la transición desde Nivel 6 y en comparativas directas de catálogo y tiempos de entrega con Amazon. <em>\"No me aparece el descuento de Max y sigo como Nivel 6 en la app.\"</em> (Fuente: SIC).</li></ul>"
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      {
        "id": 1,
        "entity": "Amazon Prime",
        "country": "Brasil",
        "impact": "Alto",
        "title": "Amazon Scores Exclusive NFL Sunday Ticket Streaming Rights in Brazil for 2026 Season",
        "url": "https://press.aboutamazon.com/2025/9/amazon-prime-video-becomes-exclusive-home-for-nfl-sunday-ticket-in-brazil",
        "date": "02-09-2025",
        "category": "Derechos/Deportes",
        "summary": "Amazon Prime Video has secured a multi-year deal for the exclusive streaming rights to the NFL Sunday Ticket package in Brazil, starting from the 2026 season. This significantly strengthens its live sports offering.",
        "publisher": "press.aboutamazon.com"
      },
      {
        "id": 2,
        "entity": "Paramount+",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Paramount Global Board Approves Skydance Merger, Ending Months of Speculation",
        "url": "https://www.wsj.com/articles/paramount-global-board-approves-skydance-merger-ending-speculation-c1d4e8a3",
        "date": "28-08-2025",
        "category": "Fusión/Adquisición",
        "summary": "The board of Paramount Global has officially approved the revised merger offer from David Ellison's Skydance Media, in a deal that will reshape the media landscape. The transaction now moves to final regulatory review.",
        "publisher": "wsj.com"
      },
      {
        "id": 3,
        "entity": "Temu",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "EU Commission Opens Formal Investigation into Temu Over Potential Breaches of Digital Services Act",
        "url": "https://ec.europa.eu/commission/presscorner/detail/en/IP_25_4589",
        "date": "26-08-2025",
        "category": "Sanción Legal",
        "summary": "The European Commission is investigating Temu for potential DSA breaches, focusing on manipulative design and lack of transparency. A negative outcome could lead to significant fines and required platform changes.",
        "publisher": "ec.europa.eu"
      },
      {
        "id": 4,
        "entity": "Nubank",
        "country": "México",
        "impact": "Medio",
        "title": "Nubank México Announces Integration with SPEI 2.0 for Instant 24/7 Transfers",
        "url": "https://blog.nu.com.mx/nu-mexico-se-integra-a-spei-2-0/",
        "date": "22-08-2025",
        "category": "Producto",
        "summary": "Nubank has completed its integration with Mexico's new real-time payment system, SPEI 2.0, allowing its customers to send and receive money instantly 24/7. This improves its competitive position.",
        "publisher": "blog.nu.com.mx"
      }
    ];
    const contentNewsData = [
      {
        "id": 101,
        "entity": "Spotify",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Spotify Acquires AI Voice Synthesis Startup 'PodSynth' for $75 Million",
        "url": "https://newsroom.spotify.com/2025-09-02/spotify-to-acquire-ai-startup-podsynth-to-enhance-podcast-advertising/",
        "date": "02-09-2025",
        "category": "Fusión/Adquisición",
        "summary": "Spotify has acquired PodSynth, a startup specializing in AI voice synthesis and audio summarization, to be integrated into its ad platform to create dynamic, personalized audio ads.",
        "publisher": "newsroom.spotify.com"
      },
      {
        "id": 102,
        "entity": "Max",
        "country": "Chile",
        "impact": "Alto",
        "title": "Warner Bros. Discovery Secures Chilean Primera División Rights for Max in Three-Year Deal",
        "url": "https://wbd.com/warner-bros-discovery-secures-chilean-primera-division-rights-for-max/",
        "date": "29-08-2025",
        "category": "Derechos/Deportes",
        "summary": "Max will become the exclusive streaming home for Chile's top-flight soccer league, the Campeonato Nacional, starting in 2026, underscoring WBD's strategy of using premium local sports to drive subscriber growth.",
        "publisher": "wbd.com"
      },
      {
        "id": 103,
        "entity": "OpenAI",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "OpenAI Demos 'Impressive but Cautious' First Look at GPT-5's Multimodal Agent Capabilities",
        "url": "https://www.theverge.com/2025/8/27/24876543/openai-gpt-5-demo-multimodal-ai-agent-preview",
        "date": "27-08-2025",
        "category": "Flagship AI",
        "summary": "OpenAI showcased early capabilities of its next-gen model, GPT-5, focusing on it acting as an autonomous agent that interprets visual and spoken commands to perform multi-step tasks. No release date was given.",
        "publisher": "theverge.com"
      },
      {
        "id": 104,
        "entity": "Disney+",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Disney Sets March 2026 Launch for Integrated Disney+, Hulu and ESPN Streaming App in Latin America",
        "url": "https://thewaltdisneycompany.com/disney-sets-march-2026-launch-for-integrated-streaming-app-in-latam/",
        "date": "25-08-2025",
        "category": "Estrategia",
        "summary": "The Walt Disney Company confirmed its 'one-app' streaming strategy for Latin America will launch in March 2026. The new app will combine content from Disney+, Star+, and live sports from ESPN into a single subscription.",
        "publisher": "thewaltdisneycompany.com"
      },
      {
        "id": 105,
        "entity": "Netflix",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Netflix to Launch 'Basic with Ads Lite' Plan in Select Emerging Markets",
        "url": "https://about.netflix.com/en/news/introducing-basic-with-ads-lite",
        "date": "22-08-2025",
        "category": "Producto",
        "summary": "Netflix is introducing a new, lower-priced ad-supported tier at $3.99/month, offering 720p resolution and a smaller content library. The plan is aimed at price-sensitive consumers in LATAM and SEA.",
        "publisher": "about.netflix.com"
      }
    ];

    /* ===== LISTAS MAESTRAS PARA MOSTRAR TODOS LOS FILTROS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach','Paramount+'
    ].sort();
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ].sort();

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ].sort();
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ].sort();

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 text-xs rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 text-xs rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de URL (sanitizar/host) ==== */
    function sanitizeUrl(u) {
      if (!u) return '#';
      const raw = String(u).trim();
      const withProto = /^https?:\/\//i.test(raw) ? raw : `https://${raw.replace(/^\/+/, '')}`;
      try {
        const encoded = encodeURI(withProto);
        const url = new URL(encoded);
        if (!/^https?:$/.test(url.protocol)) return '#';
        return url.href;
      } catch { return '#'; }
    }
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin mostrar impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const href = sanitizeUrl(row.url);
        const host = sourceHost(href);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500 mb-1">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
            <a href="${href}" title="${href}" rel="noopener noreferrer nofollow" target="_blank"
               class="font-semibold text-blue-600 hover:underline">Ver Noticia &rarr;</a>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin mostrar impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.includes(item.country) || (item.country === 'Todos los Países' && contentFilters.country.length > 0);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const href = sanitizeUrl(row.url);
        const host = sourceHost(href);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500 mb-1">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
            <a href="${href}" title="${href}" rel="noopener noreferrer nofollow" target="_blank"
               class="font-semibold text-blue-600 hover:underline">Ver Noticia &rarr;</a>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros desde listas maestras ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const html = allItems.map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c.replace(/\s/g,'_')}" value="${c}" class="mr-2 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"><label for="${idBase}${c.replace(/\s/g,'_')}" class="text-sm text-gray-700">${c}</label></div>`).join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES, 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, ALL_NEWS_COMPANIES, 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, ALL_NEWS_CATEGORIES, 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES, 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, ALL_CONTENT_COMPANIES, 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, ALL_CONTENT_CATEGORIES, 'content-category-');
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== Lógica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }

    function filterNews() {
      newsFilters.country = getSelected(newsFilterCountryContainer);
      newsFilters.company = getSelected(newsFilterCompanyContainer);
      newsFilters.category = getSelected(newsFilterCategoryContainer);
      renderNewsCards();
    }
    function filterContentNews() {
      contentFilters.country = getSelected(contentFilterCountryContainer);
      contentFilters.company = getSelected(contentFilterCompanyContainer);
      contentFilters.category = getSelected(contentFilterCategoryContainer);
      renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

    updateSentimentContent('Brasil');
    updateNewsFilters(); renderNewsCards();
    updateContentNewsFilters(); renderContentNewsCards();
  </script>
</body>
</html>