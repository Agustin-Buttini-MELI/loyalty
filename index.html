<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
"Brasil": {
"sentimentIndex": [80, 82, 79, 78, 77, 72, 73, 75, 85, 65, 68, 70, 71],
"labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
"events": [{"month": "Sep 24", "text": "Lanzamiento Meli+"}, {"month": "Feb 25", "text": "Cambio % cashback"}, {"month": "May 25", "text": "Meli+ 120% CDI"}, {"month": "Jun 25", "text": "Cambio envío gratis"}],
"table": [
{"mes": "Sep 25", "detractores": "Estabilización", "motivosDet": "Costo/Beneficio", "promotores": "Estable", "motivosPro": "Disney+/Star+", "eventos": "Período post-cambio", "competencia": "Amazon Prime Day reciente genera comparaciones"},
{"mes": "Jun 25", "detractores": "Alto", "motivosDet": "Envío gratis ≥ R$19,90", "promotores": "Bajo", "motivosPro": "Beneficios restantes", "eventos": "Cambio drástico percibido en la propuesta de valor de envíos.", "competencia": "Shopee mantiene envíos competitivos."},
{"mes": "May 25", "detractores": "Bajo", "motivosDet": "UI Cofrinhos", "promotores": "Muy Alto", "motivosPro": "Rendimiento 120% CDI", "eventos": "Lanzamiento del beneficio de inversión con rendimiento superior.", "competencia": "Nubank y PicPay con ofertas de rendimiento estándar."},
{"mes": "Feb 25", "detractores": "Medio", "motivosDet": "Reducción cashback", "promotores": "Estable", "motivosPro": "Envío gratis", "eventos": "Ajuste en el porcentaje de cashback genera quejas.", "competencia": "Amazon mantiene su propuesta de valor estable."}
],
"summary": "<h4>Resumen Brasil</h4><p>El sentimiento en Brasil muestra una alta volatilidad ligada directamente a cambios en los beneficios clave. El lanzamiento fue muy positivo, pero dos eventos generaron caídas notables:</p><ul><li><b>Febrero 2025:</b> La reducción del porcentaje de cashback fue recibida negativamente, aunque el impacto fue moderado.</li><li><b>Junio 2025:</b> El cambio en la política de envío gratis (estableciendo un mínimo de R$19,90) fue el golpe más duro al sentimiento, percibido como una devaluación del beneficio principal.</li></ul><p>Por otro lado, la introducción del rendimiento del 120% del CDI en los 'cofrinhos' en mayo fue un gran acierto, generando un pico de sentimiento promotor y atrayendo a un segmento de usuarios enfocado en finanzas.</p><blockquote><p><i>'O Meli+ era perfeito com frete em tudo. Agora com esse limite de 19,90, já não é a mesma coisa. Perdeu o principal diferencial para mim.'</i> (Usuario, Reclame Aqui, Jun 25)</p></blockquote><blockquote><p><i>'Coloquei meu dinheiro no cofrinho do Meli+ rendendo 120% do CDI, melhor que muito investimento por aí. Só por isso já vale a assinatura.'</i> (Usuario, YouTube, May 25)</p></blockquote>"
},
"México": {
"sentimentIndex": [82, 84, 83, 81, 80, 75, 76, 78, 81, 79, 78, 77, 76],
"labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
"events": [{"month": "Sep 24", "text": "Lanzamiento Meli+"}, {"month": "Feb 25", "text": "Cambio % cashback"}, {"month": "May 25", "text": "Hot Sale MX"}],
"table": [
{"mes": "Sep 25", "detractores": "Estable", "motivosDet": "Costo suscripción", "promotores": "Estable", "motivosPro": "Catálogo Disney+/Star+", "eventos": "Sin cambios mayores", "competencia": "Amazon se prepara para temporada de fin de año."},
{"mes": "May 25", "detractores": "Bajo", "motivosDet": "Bugs en promos", "promotores": "Muy Alto", "motivosPro": "Descuentos Hot Sale", "eventos": "Hot Sale con beneficios exclusivos para Meli+ impulsa la percepción de valor.", "competencia": "Nubank MX lanza NU+, generando ruido en el sector fintech/loyalty."},
{"mes": "Feb 25", "detractores": "Medio", "motivosDet": "Reducción cashback", "promotores": "Estable", "motivosPro": "Envíos FULL", "eventos": "Ajuste en cashback genera quejas, similar a Brasil.", "competencia": "Liverpool y Walmart+ con campañas agresivas."}
],
"summary": "<h4>Resumen México</h4><p>El programa Meli+ en México ha mantenido un sentimiento general más estable que en Brasil. El lanzamiento fue exitoso y los beneficios de streaming son consistentemente valorados. La caída en febrero por el ajuste de cashback fue notable pero se recuperó rápidamente.</p><ul><li><b>Mayo 2025:</b> El evento Hot Sale fue crucial. Los descuentos y beneficios adicionales exclusivos para miembros de Meli+ reforzaron fuertemente la propuesta de valor del programa, resultando en un pico de sentimiento promotor.</li><li><b>Competencia:</b> La llegada de NU+ de Nubank en mayo introdujo un competidor relevante en el ámbito de los programas de lealtad con beneficios financieros, aunque su impacto directo en Meli+ aún es incipiente.</li></ul><blockquote><p><i>'Aproveché el Hot Sale con Meli+ y me ahorré una lana en los envíos y con un cupón extra. Así sí conviene pagarlo todo el año.'</i> (Usuario, X, May 25)</p></blockquote><blockquote><p><i>'Bajaron el cashback de las compras... era de lo que más usaba. Ahora ya no estoy tan seguro si lo renovaré.'</i> (Usuario, Apestan.com, Feb 25)</p></blockquote>"
},
"Chile": {
"sentimentIndex": [70, 72, 71, 73, 75, 76, 77, 83, 80, 79, 78, 77, 78],
"labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
"events": [{"month": "Abr 25", "text": "Nuevos beneficios"}],
"table": [
{"mes": "Sep 25", "detractores": "Bajo", "motivosDet": "Pocas cuotas sin interés", "promotores": "Estable", "motivosPro": "Envíos gratis", "eventos": "Período estable.", "competencia": "Falabella y Ripley con agresivas campañas de descuentos con tarjetas CMR/Ripley."},
{"mes": "Abr 25", "detractores": "Bajo", "motivosDet": "Comunicación confusa", "promotores": "Muy Alto", "motivosPro": "Nuevos descuentos", "eventos": "Introducción de nuevos descuentos en comercios asociados impulsa el sentimiento.", "competencia": "Amazon sigue sin tener una presencia logística fuerte."}
],
"summary": "<h4>Resumen Chile</h4><p>En Chile, donde el programa ya estaba maduro, el sentimiento se mantuvo estable hasta la introducción de nuevos beneficios en abril de 2025. Este evento generó un pico significativo en la percepción de valor.</p><ul><li><b>Abril 2025:</b> La adición de descuentos exclusivos en una red de comercios asociados fue muy bien recibida, diversificando los beneficios más allá de los envíos y el streaming.</li><li><b>Competencia:</b> La principal presión competitiva proviene de los ecosistemas de retail como Falabella y Ripley, cuyos programas de lealtad y tarjetas de crédito (CMR, Ripley) ofrecen descuentos agresivos que compiten directamente con los beneficios de Meli+.</li></ul><blockquote><p><i>'Los nuevos descuentos que metieron en Meli+ para farmacias y bencina están súper buenos, ahora sí que se paga solo.'</i> (Usuario, Reddit, Abr 25)</p></blockquote>"
},
"Argentina": {
"sentimentIndex": [null, null, null, null, null, null, null, null, 60, 62, 65, 66, 68],
"labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
"events": [{"month": "May 25", "text": "Lanzamiento Meli+"}],
"table": [
{"mes": "Sep 25", "detractores": "Medio", "motivosDet": "Costo/Beneficio vs Nivel 6", "promotores": "Medio", "motivosPro": "Disney+/Star+", "eventos": "Lenta adaptación al nuevo esquema.", "competencia": "Ualá y otros servicios fintech compiten en beneficios financieros."},
{"mes": "May 25", "detractores": "Alto", "motivosDet": "Confusión en migración", "promotores": "Bajo", "motivosPro": "Acceso a Star+", "eventos": "Migración de Nivel 6 a Meli+. Quejas por falta de claridad, cambios en UI y percepción de pérdida de beneficios.", "competencia": "Contexto económico local influye en la percepción de cualquier costo adicional."}
],
"summary": "<h4>Resumen Argentina</h4><p>La transición de Nivel 6 a Meli+ en mayo de 2025 fue el evento definitorio. El cambio generó una caída inicial significativa en el sentimiento debido a la fricción y confusión entre los usuarios.</p><ul><li><b>Mayo 2025:</b> Los usuarios reportaron dificultades para entender los nuevos términos, encontrar sus beneficios anteriores y justificar el posible cambio de costo. La comunicación fue un punto débil clave.</li><li><b>Recuperación Lenta:</b> En los meses siguientes, el sentimiento ha mostrado una recuperación gradual a medida que los usuarios se familiarizan con la nueva oferta, especialmente valorando el paquete de streaming (Disney+ y Star+).</li></ul><blockquote><p><i>'No entiendo Meli+, yo era Nivel 6 y tenía todo claro. Ahora me cambiaron la interfaz y siento que pago por lo mismo o menos. ¿Dónde están mis beneficios?'</i> (Usuario, tuquejasuma.com, May 25)</p></blockquote>"
},
"Colombia": {
"sentimentIndex": [null, null, null, null, null, null, null, null, null, null, null, 55, 58],
"labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25"],
"events": [{"month": "May 25", "text": "Amazon Prime llega a CO"}, {"month": "Ago 25", "text": "Lanzamiento Meli+"}],
"table": [
{"mes": "Sep 25", "detractores": "Alto", "motivosDet": "Comparación con Prime", "promotores": "Bajo", "motivosPro": "Puntos Meli", "eventos": "Mes post-lanzamiento.", "competencia": "Amazon Prime con una oferta de lanzamiento muy agresiva."},
{"mes": "Ago 25", "detractores": "Muy Alto", "motivosDet": "Confusión en migración", "promotores": "Bajo", "motivosPro": "Acceso a Disney+", "eventos": "Lanzamiento de Meli+ en un mercado con Amazon Prime ya establecido y con una migración desde Nivel 6 que genera fricción.", "competencia": "Amazon Prime domina la conversación sobre suscripciones."}
],
"summary": "<h4>Resumen Colombia</h4><p>El lanzamiento de Meli+ en agosto de 2025 enfrenta el escenario más desafiante. La migración desde Nivel 6 coincidió con la consolidación de la oferta de Amazon Prime, lanzada unos meses antes.</p><ul><li><b>Contexto Competitivo:</b> Amazon Prime llegó a Colombia en mayo de 2025 con una fuerte campaña y una propuesta de valor clara, estableciendo un benchmark muy alto en la mente del consumidor antes del lanzamiento de Meli+.</li><li><b>Agosto 2025:</b> El sentimiento inicial es bajo, combinando la fricción de la migración (similar a Argentina) con una constante y desfavorable comparación con la oferta de Amazon Prime en cuanto a velocidad de envío y catálogo de video.</li></ul><blockquote><p><i>'Para qué voy a pagar Meli+ si Amazon Prime me da envíos más rápidos en Bogotá y tiene su propio streaming por casi lo mismo. La única ventaja es Disney+, pero no sé si alcanza.'</i> (Usuario, Reddit, Ago 25)</p></blockquote>"
}
};

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
{ "id": 1, "entity": "OpenAI", "country": null, "impact": "Alto", "title": "OpenAI Begins Phased Rollout of New GPT-4.5-Turbo Model via API for Enterprise Customers", "url": "https://openai.com/blog/gpt-4-5-turbo-api-rollout", "date": "26-09-2025", "category": "Flagship AI", "publisher": "openai.com" },
{ "id": 2, "entity": "Amazon Prime", "country": "Brasil", "impact": "Medio", "title": "Amazon and Azul Announce Expanded Logistics Partnership for Same-Day Delivery in 10 New Brazilian Capitals", "url": "https://press.aboutamazon.com/news/amazon-and-azul-logistics-partnership", "date": "23-09-2025", "category": "Estrategia", "publisher": "press.aboutamazon.com" },
{ "id": 3, "entity": "Nubank", "country": "México", "impact": "Medio", "title": "Nubank Mexico Receives Regulatory Approval to Expand Investment Product Offerings", "url": "https://blog.nu.com.mx/nubank-mexico-recibe-aprobacion-regulatoria-para-expandir-productos-de-inversion/", "date": "18-09-2025", "category": "Producto", "publisher": "blog.nu.com.mx" },
{ "id": 4, "entity": "Rappi Pro", "country": "Colombia", "impact": "Medio", "title": "Rappi Pro Black Launches with Exclusive Airport Lounge Access and Higher Cashback", "url": "https://blog.rappi.com/rappi-pro-black-launches-in-colombia", "date": "16-09-2025", "category": "Lanzamiento", "publisher": "blog.rappi.com" }
];
    const contentNewsData = [
{ "id": 5, "entity": "Netflix", "country": null, "impact": "Alto", "title": "Netflix Announces 'Cien Años de Soledad' Limited Series to Premiere Globally on December 11th", "url": "https://about.netflix.com/en/news/cien-anos-de-soledad-premiere-date", "date": "27-09-2025", "category": "Lanzamiento", "publisher": "about.netflix.com" },
{ "id": 6, "entity": "Disney+", "country": null, "impact": "Medio", "title": "The Walt Disney Company Confirms Season 3 of 'The Mandalorian' to Begin Production in Early 2026", "url": "https://thewaltdisneycompany.com/news/mandalorian-season-3-production-2026", "date": "25-09-2025", "category": "Estrategia", "publisher": "thewaltdisneycompany.com" },
{ "id": 7, "entity": "Max", "country": "Argentina", "impact": "Medio", "title": "WBD and Telecom Argentina Expand Partnership to Bundle Max Subscription with Flow Flex Plans", "url": "https://wbd.com/press/wbd-telecom-argentina-max-partnership", "date": "24-09-2025", "category": "Estrategia", "publisher": "wbd.com" },
{ "id": 8, "entity": "Spotify", "country": null, "impact": "Medio", "title": "Spotify Introduces 'AI Concert Buddy' to Help Users Discover Live Shows and Coordinate with Friends", "url": "https://newsroom.spotify.com/2025-09-20/spotify-introduces-ai-concert-buddy/", "date": "20-09-2025", "category": "Producto", "publisher": "newsroom.spotify.com" },
{ "id": 9, "entity": "Paramount+", "country": null, "impact": "Medio", "title": "Paramount Global Names New Head of International Streaming Following Executive Departure", "url": "https://www.paramount.com/press/paramount-global-names-new-head-of-international-streaming", "date": "19-09-2025", "category": "Estrategia", "publisher": "paramount.com" },
{ "id": 10, "entity": "Apple TV+", "country": null, "impact": "Medio", "title": "Apple TV+ Secures Global Rights for New Sci-Fi Drama from 'Severance' Creator", "url": "https://www.apple.com/tvpr/news/2025/09/apple-tv-lands-new-sci-fi-drama-from-dan-erickson/", "date": "16-09-2025", "category": "Derechos/Deportes", "publisher": "apple.com" }
];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países', 'Colombia'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI','Disney+',
      'Nubank','Smiles','Globoplay','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach'
    ].sort();
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ].sort();

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países', 'Colombia'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ].sort();
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ].sort();

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      if (!rows || rows.length === 0) {
        sentimentTableBody.innerHTML = '<tr><td colspan="7" class="text-center py-8 text-gray-500">No hay datos disponibles para este período.</td></tr>';
        return;
      }
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html || '<p>No hay un resumen disponible.</p>'; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const itemCountry = item.country || 'Todos los Países';
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('Todos los Países') || newsFilters.country.includes(itemCountry);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('Todos los Países') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('Todos los Países') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      alertsGrid.classList.toggle('hidden', filtered.length === 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const itemCountry = item.country || 'Todos los Países';
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('Todos los Países') || contentFilters.country.includes(itemCountry);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('Todos los Países') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('Todos los Países') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      contentAlertsGrid.classList.toggle('hidden', filtered.length === 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const uniqueItems = [...new Set(allItems)].sort();
      const html = [
        `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}all" value="Todos los Países" class="mr-2"><label for="${idBase}all">Todos</label></div>`,
        ...uniqueItems.filter(i => i !== 'Todos los Países').map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c.replace(/\s/g, '')}" value="${c}" class="mr-2"><label for="${idBase}${c.replace(/\s/g, '')}">${c}</label></div>`)
      ].join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      const usedCountries = [...new Set(newsData.map(i => i.country).filter(Boolean)), 'Todos los Países'];
      const usedCompanies = [...new Set(newsData.map(i => i.entity)), 'Todos los Países'];
      const usedCategories = [...new Set(newsData.map(i => i.category)), 'Todos los Países'];

      populateCheckboxes(newsFilterCountryContainer, usedCountries.sort(), 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, usedCompanies.sort(), 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, usedCategories.sort(), 'news-category-');

      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      const usedCountries = [...new Set(contentNewsData.map(i => i.country).filter(Boolean)), 'Todos los Países'];
      const usedCompanies = [...new Set(contentNewsData.map(i => i.entity)), 'Todos los Países'];
      const usedCategories = [...new Set(contentNewsData.map(i => i.category)), 'Todos los Países'];
      
      populateCheckboxes(contentFilterCountryContainer, usedCountries.sort(), 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, usedCompanies.sort(), 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, usedCategories.sort(), 'content-category-');
      
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== Lógica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function normalizeSelectAll(container, selectedValues) {
      const allBox = container.querySelector('input[value="Todos los Países"]');
      if (!allBox) return;
      const rest = [...container.querySelectorAll('input[type="checkbox"]')].filter(b => b.value !== 'Todos los Países');
      if (selectedValues.includes('Todos los Países')) {
        rest.forEach(b => b.checked = false);
      } else if (rest.every(b => !b.checked)) {
        allBox.checked = true;
      } else if (rest.some(b => b.checked)) {
        allBox.checked = false;
      }
    }
    function filterNews() {
      normalizeSelectAll(newsFilterCountryContainer, getSelected(newsFilterCountryContainer));
      normalizeSelectAll(newsFilterCompanyContainer, getSelected(newsFilterCompanyContainer));
      normalizeSelectAll(newsFilterCategoryContainer, getSelected(newsFilterCategoryContainer));
      newsFilters.country = getSelected(newsFilterCountryContainer);
      newsFilters.company = getSelected(newsFilterCompanyContainer);
      newsFilters.category = getSelected(newsFilterCategoryContainer);
      renderNewsCards();
    }
    function filterContentNews() {
      normalizeSelectAll(contentFilterCountryContainer, getSelected(contentFilterCountryContainer));
      normalizeSelectAll(contentFilterCompanyContainer, getSelected(contentFilterCompanyContainer));
      normalizeSelectAll(contentFilterCategoryContainer, getSelected(contentFilterCategoryContainer));
      contentFilters.country = getSelected(contentFilterCountryContainer);
      contentFilters.company = getSelected(contentFilterCompanyContainer);
      contentFilters.category = getSelected(contentFilterCategoryContainer);
      renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    document.addEventListener('DOMContentLoaded', () => {
      tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
        tabButtons.forEach(b => b.classList.remove('active'));
        e.target.classList.add('active');
        updateSentimentContent(e.target.dataset.country);
      }));
      document.getElementById('news-reset-filters').addEventListener('click', () => {
        [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
          Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
        });
        filterNews();
      });
      document.getElementById('content-reset-filters').addEventListener('click', () => {
        [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
          Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
        });
        filterContentNews();
      });

      updateSentimentContent('Brasil');
      
      updateNewsFilters(); 
      filterNews();

      updateContentNewsFilters(); 
      filterContentNews();
    });
  </script>
</body>
</html>