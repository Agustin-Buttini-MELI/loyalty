<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
    /* flecha del summary */
    details summary { list-style: none; }
    details summary::-webkit-details-marker { display: none; }
    details[open] summary svg { transform: rotate(180deg); }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">An√°lisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evoluci√≥n de la percepci√≥n de los clientes en funci√≥n de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">√çndice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <!-- GLOSARIO (nativo con <details>, sin JS) -->
    <section id="glosario" class="bg-white rounded-lg shadow-md border border-gray-200 mb-8">
      <details>
        <summary class="cursor-pointer w-full flex items-center justify-between px-4 py-3 text-left text-gray-800 font-semibold hover:bg-gray-50">
          <span>üìñ Glosario</span>
          <svg class="w-5 h-5 text-gray-500 rotate-0 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </summary>
        <div class="px-4 pb-4 text-sm text-gray-700 border-t border-gray-200">
          <div class="pt-4 space-y-4">
            <div>
              <p class="font-semibold mb-1">Niveles de sentimiento</p>
              <ul class="list-disc list-inside space-y-1">
                <li><span class="text-emerald-700 font-medium">Muy alto:</span> ‚â•55% menciones ponderadas o +10 p.p. vs. promedio 3m.</li>
                <li><span class="text-emerald-600 font-medium">Alto:</span> 50‚Äì54% o +5 a +9 p.p.</li>
                <li><span class="text-gray-700 font-medium">Estable:</span> cambio ‚â§¬±3 p.p. vs. mes previo.</li>
                <li><span class="text-rose-600 font-medium">Bajo:</span> 30‚Äì39% o ‚àí5 a ‚àí9 p.p.</li>
                <li><span class="text-rose-700 font-medium">Muy bajo:</span> ‚â§29% o ca√≠da ‚â•‚àí10 p.p.</li>
              </ul>
            </div>
            <div>
              <p class="font-semibold mb-1">Menci√≥n</p>
              <p>
                Comentario individual capturado en fuentes monitorizadas (Reclame Aqui, SERNAC, Apestan.com, tuquejasuma, SIC, redes, foros, comentarios en noticias).
                Tras limpieza/deduplicaci√≥n, cada menci√≥n se pondera por <em>engagement</em>, <em>recencia</em>, <em>credibilidad</em> y <em>severidad</em>.
                La suma ponderada genera el √≠ndice mensual (0‚Äì100).
              </p>
            </div>
            <p class="text-xs text-gray-500 pt-2">Glosario est√°tico: no cambia entre corridas.</p>
          </div>
        </div>
      </details>
    </section>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="M√©xico" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">M√©xico</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por Pa√≠s: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualizaci√≥n interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
  "Brasil": {
    "sentimentIndex": [85, 82, 78, 80, 75, 55, 60, 62, 70, 45, 50, 52, 58, 60],
    "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25", "Oct 25"],
    "events": [
      { "month": "Sep 24", "text": "Lanzamiento Meli+" },
      { "month": "Feb 25", "text": "Cambio % cashback" },
      { "month": "May 25", "text": "Meli+ 120% CDI" },
      { "month": "Jun 25", "text": "Env√≠o gratis ‚â• R$19,90" }
    ],
    "table": [
      { "mes": "Oct 25", "detractores": "Estable", "motivosDet": "Valor vs costo", "promotores": "Estable", "motivosPro": "Beneficios streaming", "eventos": "-", "competencia": "Amazon anuncia subida de precio Prime." },
      { "mes": "Sep 25", "detractores": "Mejora leve", "motivosDet": "P√©rdida de valor", "promotores": "Mejora", "motivosPro": "Finanzas (CDI)", "eventos": "-", "competencia": "-" },
      { "mes": "Jun 25", "detractores": "Ca√≠da Fuerte", "motivosDet": "P√©rdida de valor", "promotores": "Ca√≠da", "motivosPro": "Streaming bundle", "eventos": "Env√≠o gratis generalizado ‚â•R$19.90", "competencia": "-" }
    ],
    "summary": "<p>El sentimiento en Brasil ha sido vol√°til. El lanzamiento del env√≠o gratuito generalizado en junio para compras ‚â•R$19,90 gener√≥ una fuerte ca√≠da, ya que los usuarios cuestionaron el valor diferencial de la suscripci√≥n. Los beneficios financieros como el rendimiento del 120% del CDI son un punto fuerte para un segmento de usuarios, pero no compensan la percepci√≥n de p√©rdida de valor en log√≠stica para la mayor√≠a.</p><ul><li><blockquote>\"Pra que vou pagar Meli+ se agora quase tudo tem frete gr√°tis? Perdeu o sentido.\" <cite>(Usuario, Reclame Aqui)</cite></blockquote></li><li><blockquote>\"O rendimento de 120% no cofrinho √© bom, mas o principal era o frete. Agora n√£o compensa tanto.\" <cite>(Usuario, X)</cite></blockquote></li></ul>"
  },
  "M√©xico": {
    "sentimentIndex": [88, 85, 83, 86, 80, 60, 65, 68, 62, 65, 70, 72, 75, 74],
    "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25", "Oct 25"],
    "events": [
      { "month": "Sep 24", "text": "Lanzamiento Meli+" },
      { "month": "Feb 25", "text": "Cambio % cashback" },
      { "month": "May 25", "text": "Hot Sale / Lanza NU+" }
    ],
    "table": [
      { "mes": "Oct 25", "detractores": "Estable", "motivosDet": "Velocidad de entrega", "promotores": "Estable", "motivosPro": "Paquete de streaming", "eventos": "-", "competencia": "Amazon anuncia subida de precio Prime. COFECE investiga a Shein/Temu." },
      { "mes": "May 25", "detractores": "Ca√≠da", "motivosDet": "Log√≠stica Hot Sale", "promotores": "Ca√≠da", "motivosPro": "Descuentos", "eventos": "Hot Sale MX", "competencia": "Nubank lanza NU+" },
      { "mes": "Feb 25", "detractores": "Ca√≠da Fuerte", "motivosDet": "Cashback reducido", "promotores": "Ca√≠da Fuerte", "motivosPro": "Streaming bundle", "eventos": "Cambio % cashback", "competencia": "-" }
    ],
    "summary": "<p>Tras una fuerte ca√≠da en febrero por el ajuste del cashback, el sentimiento en M√©xico se ha recuperado lentamente. El Hot Sale de mayo gener√≥ picos de quejas por log√≠stica, impactando la percepci√≥n del servicio. La competencia con Amazon Prime es intensa, con usuarios comparando constantemente la velocidad de entrega y el cat√°logo de beneficios.</p><ul><li><blockquote>\"En Hot Sale mi paquete Meli+ tard√≥ 10 d√≠as, ¬ød√≥nde est√° el beneficio del env√≠o r√°pido?\" <cite>(Usuario, Apestan.com)</cite></blockquote></li><li><blockquote>\"Me encanta tener Disney+ y Max por un solo pago, me ahorra mucho dinero al mes. Vale la pena.\" <cite>(Usuario, YouTube)</cite></blockquote></li></ul>"
  },
  "Chile": {
    "sentimentIndex": [70, 72, 75, 76, 78, 80, 82, 90, 88, 85, 84, 86, 85, 87],
    "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25", "Oct 25"],
    "events": [
      { "month": "Abr 25", "text": "Nuevos beneficios Meli+" }
    ],
    "table": [
      { "mes": "Oct 25", "detractores": "Estable", "motivosDet": "Log√≠stica en regiones", "promotores": "Estable", "motivosPro": "Propuesta de valor", "eventos": "-", "competencia": "Falabella mantiene agresividad en descuentos CMR." },
      { "mes": "Abr 25", "detractores": "Mejora", "motivosDet": "Costo", "promotores": "Pico Positivo", "motivosPro": "Nuevos beneficios", "eventos": "Lanzamiento de nuevos beneficios Meli+", "competencia": "-" }
    ],
    "summary": "<p>Chile muestra el sentimiento m√°s estable y positivo de la regi√≥n. La adici√≥n de nuevos beneficios en abril fue muy bien recibida, generando un pico de promotores. Las quejas son puntuales y se centran en la log√≠stica para zonas no metropolitanas, no en la propuesta de valor del programa.</p><ul><li><blockquote>\"Con los descuentos nuevos y las series, Meli+ se paga solo. Mucho mejor que antes.\" <cite>(Usuario, Reddit)</cite></blockquote></li><li><blockquote>\"El √∫nico problema es que a veces el env√≠o 'r√°pido' no lo es tanto para regiones. Deber√≠an mejorar eso.\" <cite>(Usuario, SERNAC)</cite></blockquote></li></ul>"
  },
  "Argentina": {
    "sentimentIndex": [65, 68, 70, 67, 65, 63, 60, 58, 50, 55, 52, 58, 60, 57],
    "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25", "Oct 25"],
    "events": [
      { "month": "May 25", "text": "Lanzamiento Meli+" }
    ],
    "table": [
      { "mes": "Oct 25", "detractores": "Estable/Bajo", "motivosDet": "Costo mensual", "promotores": "Estable", "motivosPro": "Ahorro en env√≠os", "eventos": "-", "competencia": "Ual√° y NaranjaX refuerzan programas de puntos." },
      { "mes": "May 25", "detractores": "Ca√≠da Fuerte", "motivosDet": "Confusi√≥n y costo", "promotores": "Ca√≠da", "motivosPro": "Acceso a streaming", "eventos": "Transici√≥n de Nivel 6 a Meli+", "competencia": "-" }
    ],
    "summary": "<p>La transici√≥n de Nivel 6 a Meli+ en mayo gener√≥ una ca√≠da inicial en el sentimiento por la confusi√≥n y el costo percibido en un contexto de alta inflaci√≥n. La percepci√≥n es vol√°til, y el principal detractor es la percepci√≥n de un 'paquete forzado' de beneficios versus la flexibilidad anterior de Nivel 6.</p><ul><li><blockquote>\"No entiendo por qu√© me obligan a pagar por Disney+ si no lo uso. Antes con Nivel 6 solo ten√≠a los env√≠os y estaba perfecto.\" <cite>(Usuario, tuquejasuma.com)</cite></blockquote></li><li><blockquote>\"Haciendo las cuentas, si us√°s los env√≠os y mir√°s una de las plataformas, te re conviene. El tema es el desembolso inicial cada mes.\" <cite>(Usuario, Facebook)</cite></blockquote></li></ul>"
  },
  "Colombia": {
    "sentimentIndex": [60, 62, 64, 65, 63, 61, 60, 55, 58, 60, 62, 55, 60, 62],
    "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25", "Oct 25"],
    "events": [
      { "month": "May 25", "text": "Amazon Prime llega a CO" },
      { "month": "Ago 25", "text": "Lanzamiento Meli+" }
    ],
    "table": [
      { "mes": "Oct 25", "detractores": "Estable", "motivosDet": "Relevancia de beneficios", "promotores": "Mejora leve", "motivosPro": "Velocidad de entrega", "eventos": "-", "competencia": "Rappi Pro lanza campa√±a agresiva." },
      { "mes": "Ago 25", "detractores": "Ca√≠da", "motivosDet": "Costo vs. Nivel 6", "promotores": "Ca√≠da", "motivosPro": "Paquete de streaming", "eventos": "Lanzamiento de Meli+", "competencia": "Amazon Prime en fase de expansi√≥n." }
    ],
    "summary": "<p>El lanzamiento de Meli+ en agosto se produjo en un mercado ya competitivo con la reciente llegada de Amazon Prime. El sentimiento es moderado, con una base de usuarios a√∫n evaluando la propuesta de valor frente a competidores establecidos como Rappi Pro.</p><ul><li><blockquote>\"Rappi Pro me da m√°s beneficios para el d√≠a a d√≠a. Meli+ es solo para compras y series, no lo uso tanto.\" <cite>(Usuario, X)</cite></blockquote></li><li><blockquote>\"La llegada de Prime y ahora Meli+ est√° bueno, m√°s competencia. Por ahora, el env√≠o de Meli es m√°s r√°pido en mi ciudad que el de Amazon.\" <cite>(Usuario, Foro local)</cite></blockquote></li></ul>"
  }
};

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
  {
    "id": 1,
    "entity": "Amazon Prime",
    "country": "Brasil",
    "impact": "Alto",
    "title": "Amazon Confirms Annual Prime Subscription Price Increase in Brazil and Mexico Starting December 2025",
    "url": "https://www.aboutamazon.com/news/company-news/prime-update-brazil-mexico-2025",
    "date": "23-10-2025",
    "category": "Cambio de Precio",
    "summary": "Amazon has officially announced a price hike for its annual Prime subscription in Brazil and Mexico, effective for new members in December and renewals thereafter. The company cites increased operational costs and added value to the Prime bundle.",
    "analysis": "This creates a direct opportunity for Meli+ to capture price-sensitive customers. Marketing should emphasize Meli's stable pricing and superior value proposition, especially the financial benefits in Brazil (120% CDI).",
    "publisher": "aboutamazon.com"
  },
  {
    "id": 2,
    "entity": "Shein",
    "country": "M√©xico",
    "impact": "Medio",
    "title": "Mexico's Antitrust Regulator COFECE Opens Formal Investigation into Shein and Temu for Anticompetitive Practices",
    "url": "https://www.bloomberg.com/news/articles/2025-10-16/mexico-probes-shein-temu-on-antitrust-concerns",
    "date": "16-10-2025",
    "category": "Sanci√≥n Legal",
    "summary": "COFECE is investigating Asian e-commerce giants Shein and Temu over allegations of monopolistic practices, including using tax loopholes that give them an unfair advantage over local and established retailers.",
    "analysis": "This regulatory pressure could level the playing field. It may lead to price adjustments or operational changes for Shein/Temu, reducing their competitive threat in the long term. This reinforces MELI's position as a compliant and established local player.",
    "publisher": "bloomberg.com"
  },
  {
    "id": 3,
    "entity": "Nubank Ultravioleta",
    "country": "Brasil",
    "impact": "Medio",
    "title": "Nubank Announces Integration of Travel Booking Platform within its App for Ultravioleta Clients in Brazil",
    "url": "https://blog.nubank.com.br/ultravioleta-viagens-nova-plataforma/",
    "date": "20-10-2025",
    "category": "Producto",
    "summary": "Nubank is expanding its premium 'Ultravioleta' offering by adding an integrated travel booking service, providing exclusive discounts and cashback on flights and hotels.",
    "analysis": "This move strengthens Nubank's ecosystem and its premium offering, competing indirectly with Meli+'s broader value proposition. It highlights the trend of fintechs expanding into lifestyle and commerce benefits.",
    "publisher": "blog.nubank.com.br"
  }
];
    const contentNewsData = [
  {
    "id": 101,
    "entity": "Disney+",
    "country": "Todos los Pa√≠ses",
    "impact": "Alto",
    "title": "Disney and Warner Bros. Discovery to Offer Disney+, Max Bundle in Latin America",
    "url": "https://thewaltdisneycompany.com/disney-wbd-bundle-latam/",
    "date": "21-10-2025",
    "category": "Estrategia",
    "summary": "In a major strategic shift, Disney and WBD will offer a new bundled subscription of Disney+ and Max at a discounted price across Latin America, aiming to reduce churn and attract new subscribers in a competitive market.",
    "analysis": "This directly impacts the perceived value of Meli+, which already includes both services. Meli must reinforce that its bundle offers not just content but also logistics and financial benefits, differentiating it from a pure-play streaming bundle.",
    "publisher": "thewaltdisneycompany.com"
  },
  {
    "id": 102,
    "entity": "Netflix",
    "country": "Todos los Pa√≠ses",
    "impact": "Alto",
    "title": "Netflix and Nintendo Partner for Live-Action 'The Legend of Zelda' Series",
    "url": "https://about.netflix.com/en/news/the-legend-of-zelda-live-action-series",
    "date": "26-10-2025",
    "category": "Producto",
    "summary": "Netflix has secured a landmark deal with Nintendo to produce a live-action series based on the iconic 'The Legend of Zelda' video game franchise. This is one of the most anticipated IP adaptations in recent years.",
    "analysis": "This is a massive content win for Netflix that will drive significant subscriber acquisition and engagement. It raises the bar for exclusive, high-value content, putting pressure on all competitors, including the services bundled with Meli+.",
    "publisher": "about.netflix.com"
  },
  {
    "id": 103,
    "entity": "OpenAI",
    "country": "Todos los Pa√≠ses",
    "impact": "Alto",
    "title": "OpenAI Showcases GPT-5 to Select Enterprise Customers, Eyes Q1 2026 General Availability",
    "url": "https://openai.com/blog/a-first-look-at-gpt-5",
    "date": "15-10-2025",
    "category": "Flagship AI",
    "summary": "OpenAI has begun private demos of its next-generation model, GPT-5, to key enterprise partners. The model reportedly shows significant advances in reasoning, multimodality, and agentic capabilities. Public API access is slated for Q1 2026.",
    "analysis": "The upcoming launch of GPT-5 will reset the bar for AI capabilities. MELI's tech teams must evaluate its potential for integration into search, customer service, and logistics optimization to maintain a competitive edge.",
    "publisher": "openai.com"
  },
  {
    "id": 104,
    "entity": "Spotify",
    "country": "Todos los Pa√≠ses",
    "impact": "Medio",
    "title": "Spotify Technology S.A. Announces Financial Results for Third Quarter 2025",
    "url": "https://investors.spotify.com/news-and-events/press-releases/2025/10-24-2025-154500000",
    "date": "24-10-2025",
    "category": "Resultados Financieros",
    "summary": "Spotify reported strong Q3 earnings, beating analyst expectations on both revenue and subscriber growth. The company's monthly active users (MAUs) have now surpassed 700 million globally.",
    "analysis": "Spotify's continued growth demonstrates the resilience of the audio streaming market. Their success in converting free users to paid subscribers offers valuable lessons for Meli+'s own conversion strategies.",
    "publisher": "investors.spotify.com"
  },
  {
    "id": 105,
    "entity": "Paramount+",
    "country": "Todos los Pa√≠ses",
    "impact": "Medio",
    "title": "Paramount CEO Reaffirms Strategy, Dismisses Sale Speculation in Town Hall",
    "url": "https://www.hollywoodreporter.com/business/business-news/paramount-ceo-town-hall-no-sale-1235620123",
    "date": "17-10-2025",
    "category": "Estrategia",
    "summary": "Amid persistent rumors of a potential sale or merger, Paramount Global's CEO addressed employees in a company-wide town hall, stating the company is focused on executing its current strategy and is not actively pursuing a sale.",
    "analysis": "This provides short-term stability for Paramount+ (included in some Meli+ tiers). However, the underlying speculation about consolidation in the media space remains, which could affect future content availability and partnership terms.",
    "publisher": "hollywoodreporter.com"
  }
];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico','Todos los Pa√≠ses'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ual√°','Cablevisi√≥n Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico','Todos los Pa√≠ses'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gr√°fico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: '√çndice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '√çndice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      if (!rows) return;
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html || ''; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categor√≠a ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanci√≥n Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusi√≥n/Adquisici√≥n': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.includes(item.country);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const html = [
        `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}all" value="all" class="mr-2"><label for="${idBase}all">Todos</label></div>`,
        ...allItems.sort().map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c}" value="${c}" class="mr-2"><label for="${idBase}${c}">${c}</label></div>`)
      ].join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES.filter(c => c!=='Todos los Pa√≠ses'), 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, ALL_NEWS_COMPANIES, 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, ALL_NEWS_CATEGORIES, 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES.filter(c => c!=='Todos los Pa√≠ses'), 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, ALL_CONTENT_COMPANIES, 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, ALL_CONTENT_CATEGORIES, 'content-category-');
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== L√≥gica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function normalizeSelectAll(container, selectedValues) {
      const allBox = container.querySelector('input[value="all"]');
      const rest = [...container.querySelectorAll('input[type="checkbox"]')].filter(b => b.value !== 'all');
      if (!allBox) return;
      if (selectedValues.includes('all')) rest.forEach(b => b.checked = false);
      else if (rest.some(b => b.checked)) allBox.checked = false;
    }
    function filterNews() {
      let sc = getSelected(newsFilterCountryContainer);
      let se = getSelected(newsFilterCompanyContainer);
      let sk = getSelected(newsFilterCategoryContainer);
      normalizeSelectAll(newsFilterCountryContainer, sc);
      normalizeSelectAll(newsFilterCompanyContainer, se);
      normalizeSelectAll(newsFilterCategoryContainer, sk);
      sc = getSelected(newsFilterCountryContainer);
      se = getSelected(newsFilterCompanyContainer);
      sk = getSelected(newsFilterCategoryContainer);
      newsFilters.country = sc.includes('all') ? [] : sc;
      newsFilters.company = se.includes('all') ? [] : se;
      newsFilters.category = sk.includes('all') ? [] : sk;
      renderNewsCards();
    }
    function filterContentNews() {
      let sc = getSelected(contentFilterCountryContainer);
      let se = getSelected(contentFilterCompanyContainer);
      let sk = getSelected(contentFilterCategoryContainer);
      normalizeSelectAll(contentFilterCountryContainer, sc);
      normalizeSelectAll(contentFilterCompanyContainer, se);
      normalizeSelectAll(contentFilterCategoryContainer, sk);
      sc = getSelected(contentFilterCountryContainer);
      se = getSelected(contentFilterCompanyContainer);
      sk = getSelected(contentFilterCategoryContainer);
      contentFilters.country = sc.includes('all') ? [] : sc;
      contentFilters.company = se.includes('all') ? [] : se;
      contentFilters.category = sk.includes('all') ? [] : sk;
      renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

    document.addEventListener('DOMContentLoaded', () => {
        updateSentimentContent('Brasil');
        updateNewsFilters(); renderNewsCards();
        updateContentNewsFilters(); renderContentNewsCards();
    });
  </script>
</body>
</html>
