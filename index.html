<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
    /* flecha del summary */
    details summary { list-style: none; }
    details summary::-webkit-details-marker { display: none; }
    details[open] summary svg { transform: rotate(180deg); }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">An√°lisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evoluci√≥n de la percepci√≥n de los clientes en funci√≥n de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">√çndice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <!-- GLOSARIO (nativo con <details>, sin JS) -->
    <details id="glosario" class="bg-white rounded-lg shadow-md border border-gray-200 mb-8">
      <summary class="cursor-pointer w-full flex items-center justify-between px-4 py-3 text-left text-gray-800 font-semibold hover:bg-gray-50">
        <span>üìñ Glosario</span>
        <svg class="w-5 h-5 text-gray-500 rotate-0 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
        </svg>
      </summary>
      <div class="px-4 pb-4 text-sm text-gray-700">
        <div class="pt-2 space-y-4">
          <div>
            <p class="font-semibold mb-1">Niveles de sentimiento</p>
            <ul class="list-disc list-inside space-y-1">
              <li><span class="text-emerald-700 font-medium">Muy alto:</span> ‚â•55% menciones ponderadas o +10 p.p. vs. promedio 3m.</li>
              <li><span class="text-emerald-600 font-medium">Alto:</span> 50‚Äì54% o +5 a +9 p.p.</li>
              <li><span class="text-gray-700 font-medium">Estable:</span> cambio ‚â§¬±3 p.p. vs. mes previo.</li>
              <li><span class="text-rose-600 font-medium">Bajo:</span> 30‚Äì39% o ‚àí5 a ‚àí9 p.p.</li>
              <li><span class="text-rose-700 font-medium">Muy bajo:</span> ‚â§29% o ca√≠da ‚â•‚àí10 p.p.</li>
            </ul>
          </div>
          <div>
            <p class="font-semibold mb-1">Menci√≥n</p>
            <p>
              Comentario individual capturado en fuentes monitorizadas (Reclame Aqui, SERNAC, Apestan.com, tuquejasuma, SIC, redes, foros, comentarios en noticias).
              Tras limpieza/deduplicaci√≥n, cada menci√≥n se pondera por <em>engagement</em>, <em>recencia</em>, <em>credibilidad</em> y <em>severidad</em>.
              La suma ponderada genera el √≠ndice mensual (0‚Äì100).
            </p>
          </div>
          <p class="text-xs text-gray-500">Glosario est√°tico: no cambia entre corridas.</p>
        </div>
      </div>
    </details>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="M√©xico" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">M√©xico</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por Pa√≠s: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualizaci√≥n interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      'Brasil': {
        sentimentIndex: [78, 75, 72, 70, 71, 65, 68, 75, 68, 70, 65, 69, 72, 70, 68],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25 (parcial)'],
        events: [{ month: 'Sep 24', text: 'Lanzamiento Meli+' }, { month: 'Feb 25', text: 'Cambio % cashback' }, { month: 'May 25', text: 'Meli+ 120% CDI' }, { month: 'Jun 25', text: 'Env√≠o gratis ‚â• R$19,90' }],
        table: [
          { mes: 'Sep 25', detractores: 'Muy bajo', motivosDet: 'Confusi√≥n env√≠os', promotores: 'Alto', motivosPro: 'Rendimiento 120% CDI', eventos: 'Per√≠odo estable', competencia: 'Prime Day (Jul), Shopee 9.9' },
          { mes: 'Ago 25', detractores: 'Bajo', motivosDet: 'Disney+ con anuncios', promotores: 'Alto', motivosPro: 'Rendimiento 120% CDI', eventos: 'Anuncio D+ con ads', competencia: 'Magalu con ofertas agresivas' },
          { mes: 'Jul 25', detractores: 'Bajo', motivosDet: 'Percepci√≥n valor env√≠o', promotores: 'Alto', motivosPro: 'Beneficios suscripci√≥n', eventos: 'Mes post-cambio de env√≠os', competencia: 'Amazon Prime Day' },
          { mes: 'Jun 25', detractores: 'Medio', motivosDet: 'Cambio umbral env√≠o gratis', promotores: 'Estable', motivosPro: 'Rendimiento 120% CDI', eventos: 'Env√≠o gratis general ‚â• R$19,90', competencia: 'Estable' },
          { mes: 'May 25', detractores: 'Bajo', motivosDet: 'Dudas sobre beneficios', promotores: 'Muy alto', motivosPro: 'Rendimiento 120% CDI', eventos: 'Lanzamiento Meli+ 120% CDI', competencia: 'Nubank Ultravioleta' }
        ],
        summary: `
          <ul class="list-disc pl-5 space-y-2">
            <li><strong class="text-rose-700">Detractores:</strong> El principal foco de quejas en los √∫ltimos 3 meses es la percepci√≥n de devaluaci√≥n del beneficio de env√≠o gratis tras la introducci√≥n del umbral de R$19,90 para no suscriptores. <em>"Pago Meli+ justamente para no preocuparme por el valor del carrito y ahora casi todos tienen env√≠o gratis. ¬øCu√°l es la ventaja?"</em> (Reclame Aqui).</li>
            <li><strong class="text-emerald-700">Promotores:</strong> El rendimiento del 120% del CDI en la cuenta remunerada sigue siendo el principal impulsor de sentimiento positivo, visto como un diferenciador clave frente a otros bancos digitales y plataformas. <em>"El dinero en la cuenta Meli rinde m√°s que en cualquier otro lugar, eso paga la suscripci√≥n sola."</em> (Comentario en YouTube).</li>
          </ul>`
      },
      'M√©xico': {
        sentimentIndex: [80, 78, 76, 75, 73, 68, 70, 72, 78, 76, 74, 75, 76, 77],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25 (parcial)'],
        events: [{ month: 'Sep 24', text: 'Lanzamiento Meli+' }, { month: 'Feb 25', text: 'Cambio % cashback' }, { month: 'May 25', text: 'Hot Sale MX / Lanza NU+' }],
        table: [
          { mes: 'Sep 25', detractores: 'Muy bajo', motivosDet: 'Disney+ con anuncios', promotores: 'Alto', motivosPro: 'Velocidad de entrega', eventos: 'Anuncio D+ con ads', competencia: 'Amazon con ofertas pre-navide√±as' },
          { mes: 'Ago 25', detractores: 'Bajo', motivosDet: 'Fallas en cupones', promotores: 'Alto', motivosPro: 'Cat√°logo de productos', eventos: 'Estabilizaci√≥n post-Hot Sale', competencia: 'Liverpool Ventas Nocturnas' },
          { mes: 'Jul 25', detractores: 'Bajo', motivosDet: 'Precio vs competencia', promotores: 'Alto', motivosPro: 'Env√≠o Full', eventos: 'Recurrencia de Prime Day', competencia: 'Amazon Prime Day' },
          { mes: 'Jun 25', detractores: 'Bajo', motivosDet: 'Confusi√≥n cashback', promotores: 'Muy alto', motivosPro: 'Ofertas y env√≠os Hot Sale', eventos: 'Resaca del Hot Sale', competencia: 'Estable' },
          { mes: 'May 25', detractores: 'Bajo', motivosDet: 'Productos agotados', promotores: 'Muy alto', motivosPro: 'Descuentos Hot Sale', eventos: 'Hot Sale MX', competencia: 'Nubank MX lanza NU+' }
        ],
        summary: `
          <ul class="list-disc pl-5 space-y-2">
            <li><strong class="text-rose-700">Detractores:</strong> Quejas menores y recurrentes sobre la complejidad del programa de cashback y la inclusi√≥n de anuncios en Disney+, percibido como una p√©rdida de valor. <em>"Ya no entiendo cu√°nto me regresan con el cashback, antes era m√°s claro"</em> (X/Twitter).</li>
            <li><strong class="text-emerald-700">Promotores:</strong> La log√≠stica (velocidad y confiabilidad de los env√≠os) sigue siendo el pilar del sentimiento positivo. El evento Hot Sale de mayo gener√≥ un pico de promotores por las ofertas agresivas combinadas con los beneficios del programa. <em>"Compr√© en Hot Sale a las 10pm y a las 9am del d√≠a siguiente ya estaba en mi casa. Incre√≠ble."</em> (Apestan.com).</li>
          </ul>`
      },
      'Chile': {
        sentimentIndex: [70, 71, 72, 70, 73, 74, 75, 82, 80, 79, 78, 77, 76, 75],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25 (parcial)'],
        events: [{ month: 'Abr 25', text: 'Nuevos beneficios Meli+' }],
        table: [
          { mes: 'Sep 25', detractores: 'Bajo', motivosDet: 'Disponibilidad productos', promotores: 'Alto', motivosPro: 'Descuentos con partners', eventos: 'Per√≠odo estable', competencia: 'Falabella con Cyber Day' },
          { mes: 'Ago 25', detractores: 'Bajo', motivosDet: 'Disney+ con anuncios', promotores: 'Alto', motivosPro: 'Nuevos beneficios (Abr)', eventos: 'Anuncio D+ con ads', competencia: 'Ripley con ofertas CMR' },
          { mes: 'Jul 25', detractores: 'Bajo', motivosDet: 'Comparaci√≥n de precios', promotores: 'Alto', motivosPro: 'Beneficios suscripci√≥n', eventos: 'Per√≠odo estable', competencia: 'Amazon Prime Day (efecto indirecto)' }
        ],
        summary: `
          <ul class="list-disc pl-5 space-y-2">
            <li><strong class="text-rose-700">Detractores:</strong> Las cr√≠ticas son minoritarias y se centran en la comparaci√≥n de precios con el retail tradicional (Falabella, Ripley), especialmente durante eventos de descuentos de la competencia. <em>"El mismo producto estaba m√°s barato en Falabella con la tarjeta CMR esta semana"</em> (Foro en Reddit).</li>
            <li><strong class="text-emerald-700">Promotores:</strong> El pico de sentimiento en abril, tras la adici√≥n de nuevos beneficios y descuentos en servicios, se ha mantenido estable. Los usuarios valoran el "paquete" de beneficios m√°s all√° del env√≠o gratis. <em>"Uso el descuento en el cine y la bencina, con eso ya se paga solo el Meli+"</em> (Comentario en Instagram).</li>
          </ul>`
      },
      'Argentina': {
        sentimentIndex: [55, 52, 50, 48, 45, 46, 48, 50, 75, 72, 70, 68, 66, 65],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25 (parcial)'],
        events: [{ month: 'May 25', text: 'Lanzamiento Meli+' }],
        table: [
          { mes: 'Sep 25', detractores: 'Medio', motivosDet: 'Costo de suscripci√≥n', promotores: 'Medio', motivosPro: 'Acceso a Disney+/Max', eventos: 'Contexto inflacionario', competencia: 'NaranjaX y Ual√° con promociones' },
          { mes: 'Ago 25', detractores: 'Medio', motivosDet: 'Disney+ con anuncios', promotores: 'Alto', motivosPro: 'Beneficios vs Nivel 6', eventos: 'Anuncio D+ con ads', competencia: 'Estable' },
          { mes: 'Jul 25', detractores: 'Bajo', motivosDet: 'Confusi√≥n en migraci√≥n', promotores: 'Alto', motivosPro: 'Valor percibido del paquete', eventos: 'Per√≠odo post-lanzamiento', competencia: 'Prime Day no relevante' },
          { mes: 'Jun 25', detractores: 'Bajo', motivosDet: 'Problemas migraci√≥n cuenta', promotores: 'Muy alto', motivosPro: 'Nuevos beneficios (streaming)', eventos: 'Adaptaci√≥n a Meli+', competencia: 'Estable' },
          { mes: 'May 25', detractores: 'Bajo', motivosDet: 'Dudas sobre el cambio', promotores: 'Muy alto', motivosPro: 'Inclusi√≥n D+ y Max', eventos: 'Migraci√≥n Nivel 6 a Meli+', competencia: 'Estable' }
        ],
        summary: `
          <ul class="list-disc pl-5 space-y-2">
            <li><strong class="text-rose-700">Detractores:</strong> La conversaci√≥n negativa, aunque en descenso, se centra en el costo de la suscripci√≥n en un contexto econ√≥mico complejo. El reciente anuncio de Disney+ con publicidades gener√≥ un nuevo pico de cr√≠ticas. <em>"Todo bien con Meli+, pero es un gasto m√°s que se suma a la lista y ahora Disney+ viene con propaganda..."</em> (tuquejasuma.com).</li>
            <li><strong class="text-emerald-700">Promotores:</strong> El lanzamiento de Meli+ en mayo fue un √©xito rotundo en sentimiento, reemplazando la confusi√≥n de Nivel 6 por una propuesta de valor clara. La inclusi√≥n de los servicios de streaming es el principal motor de la percepci√≥n positiva. <em>"Dej√© de pagar D+ y Max por separado, con Meli+ me ahorro un mont√≥n. Golazo."</em> (X/Twitter).</li>
          </ul>`
      },
      'Colombia': {
        sentimentIndex: [60, 58, 55, 56, 54, 55, 53, 55, 52, 60, 65, 80, 78, 76],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25 (parcial)'],
        events: [{ month: 'May 25', text: 'Amazon Prime llega a CO' }, { month: 'Ago 25', text: 'Lanzamiento Meli+' }],
        table: [
          { mes: 'Sep 25', detractores: 'Bajo', motivosDet: 'Disney+ con anuncios', promotores: 'Alto', motivosPro: 'Beneficios vs Nivel 6', eventos: 'Anuncio D+ con ads', competencia: 'Rappi Pro con nuevas alianzas' },
          { mes: 'Ago 25', detractores: 'Bajo', motivosDet: 'Dudas sobre migraci√≥n', promotores: 'Muy alto', motivosPro: 'Paquete de streaming', eventos: 'Migraci√≥n Nivel 6 a Meli+', competencia: 'Amazon Prime afianz√°ndose' },
          { mes: 'Jul 25', detractores: 'Medio', motivosDet: 'Comparaci√≥n con Prime', promotores: 'Medio', motivosPro: 'Env√≠os r√°pidos', eventos: 'Expectativa por Meli+', competencia: 'Amazon Prime Day' }
        ],
        summary: `
          <ul class="list-disc pl-5 space-y-2">
            <li><strong class="text-rose-700">Detractores:</strong> La llegada de Amazon Prime en mayo gener√≥ una base de comparaci√≥n que antes no exist√≠a, con quejas puntuales sobre costos y cat√°logo. El cambio de Nivel 6 a Meli+ gener√≥ algunas dudas iniciales, ya resueltas. <em>"Todav√≠a no s√© si me conviene m√°s Meli+ o Prime, tengo que hacer las cuentas"</em> (Comentario en Facebook).</li>
            <li><strong class="text-emerald-700">Promotores:</strong> El lanzamiento de Meli+ en agosto fue un catalizador de sentimiento muy positivo, percibido como una respuesta directa y superior a la oferta de Amazon. El paquete de beneficios, especialmente el streaming, es el principal argumento de valor. <em>"¬°Al fin! Estaba esperando esto. Con Meli+ tengo env√≠os y las series, Amazon no me da eso."</em> (SIC).</li>
          </ul>`
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      { "id": 1, "entity": "Amazon Prime", "country": "Brasil", "impact": "Alto", "title": "Amazon Announces Prime Price Increase in Brazil and Mexico", "url": "https://www.aboutamazon.com/news/company-news/amazon-prime-price-change", "date": "08-10-2025", "category": "Cambio de Precio", "summary": "Amazon has announced it will increase the price of its Prime membership in Brazil (from BRL 19.90 to BRL 24.90/month) and Mexico (from MXN 129 to MXN 149/month), effective for new members immediately and for existing members on renewals after November 15, 2025.", "publisher": "aboutamazon.com" },
      { "id": 2, "entity": "Shopee", "country": "Brasil", "impact": "Medio", "title": "Shopee Expands Cross-Border Logistics Hubs in Brazil to Reduce Delivery Times", "url": "https://www.reuters.com/business/retail-consumer/shopee-expands-logistics-hubs-brazil-2025-10-10/", "date": "10-10-2025", "category": "Estrategia", "summary": "Sea Ltd's Shopee is adding three new logistics sorting centers in Brazil's northeast to improve delivery efficiency for its growing cross-border e-commerce operations, aiming to compete with local players on speed.", "publisher": "reuters.com" },
      { "id": 3, "entity": "Rappi Pro", "country": "Colombia", "impact": "Medio", "title": "Rappi Pro and Suramericana Announce New Insurance Benefits for Subscribers", "url": "https://blog.rappi.com/rappi-pro-suramericana-alliance", "date": "06-10-2025", "category": "Producto", "summary": "Rappi announced a strategic alliance with insurer Suramericana to offer exclusive micro-insurance products for theft and accidents to its Rappi Pro subscribers in Colombia, adding a new layer to its loyalty program.", "publisher": "blog.rappi.com" },
      { "id": 4, "entity": "Nubank", "country": "M√©xico", "impact": "Medio", "title": "Nubank's Mexico Unit Reaches 7 Million Credit Card Customers", "url": "https://international.nubank.com.br/media/press-releases/", "date": "02-10-2025", "category": "Resultados Financieros", "summary": "Nu M√©xico, Nubank's Mexican subsidiary, announced it has surpassed 7 million credit card users and 5 million savings account holders, consolidating its position as a leading digital financial player in the country.", "publisher": "international.nubank.com.br" }
    ];
    const contentNewsData = [
      { "id": 5, "entity": "Disney+", "impact": "Alto", "title": "The Walt Disney Company Secures Exclusive Pan-Latin America Streaming Rights for Copa Libertadores", "url": "https://thewaltdisneycompany.com/the-walt-disney-company-secures-copa-libertadores-rights/", "date": "09-10-2025", "category": "Derechos/Deportes", "summary": "In a major move, TWDC has won the exclusive streaming rights for the CONMEBOL Copa Libertadores for all of Latin America from 2026-2029, with games to be broadcast across Disney+ and ESPN platforms.", "publisher": "thewaltdisneycompany.com" },
      { "id": 6, "entity": "Netflix", "impact": "Medio", "title": "Netflix Launches 'Genre Tags', a New Discovery Feature Powered by User Activity", "url": "https://about.netflix.com/en/news/introducing-genre-tags", "date": "07-10-2025", "category": "Producto", "summary": "Netflix is rolling out a new feature called 'Genre Tags' that allows users to browse more specific, community-driven categories (e.g., 'Slow-Burn Sci-Fi'), enhancing content discovery beyond its traditional algorithm.", "publisher": "about.netflix.com" },
      { "id": 7, "entity": "Max", "impact": "Medio", "title": "Warner Bros. Discovery and Am√©rica M√≥vil Announce Expanded Partnership to Bundle Max with Telcel and Claro Plans in Mexico and Brazil", "url": "https://wbd.com/newsroom/press/wbd-and-americal-movil-expand-partnership", "date": "12-10-2025", "category": "Estrategia", "summary": "WBD and Am√©rica M√≥vil are expanding their partnership, which will see the Max streaming service bundled into select postpaid mobile and broadband plans from Telcel (Mexico) and Claro (Brazil) starting in Q1 2026.", "publisher": "wbd.com" },
      { "id": 8, "entity": "Spotify", "impact": "Medio", "title": "Spotify Acquires AI Music Research Firm 'Melody-AI' to Bolster Discovery Algorithms", "url": "https://newsroom.spotify.com/2025-10-03/spotify-acquires-melody-ai/", "date": "03-10-2025", "category": "Fusi√≥n/Adquisici√≥n", "summary": "Spotify has completed the acquisition of Melody-AI, a London-based startup specializing in affective computing and music mood analysis, to enhance its playlist generation and song recommendation engine. The deal is classified as a technology tuck-in.", "publisher": "newsroom.spotify.com" },
      { "id": 9, "entity": "OpenAI", "impact": "Medio", "title": "OpenAI Previews 'Creative Guidance' Tools for DALL-E 4 Enterprise API", "url": "https://openai.com/blog/dall-e-4-creative-guidance", "date": "01-10-2025", "category": "Producto", "summary": "OpenAI has released a preview of new 'Creative Guidance' features for its enterprise clients using the DALL-E 4 API, allowing for more precise control over image composition, style, and character consistency across multiple generations.", "publisher": "openai.com" }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico','Todos los Pa√≠ses'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ual√°','Cablevisi√≥n Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico','Todos los Pa√≠ses'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gr√°fico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: '√çndice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '√çndice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categor√≠a ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanci√≥n Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusi√≥n/Adquisici√≥n': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.includes(item.country);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const html = [
        `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}all" value="all" class="mr-2"><label for="${idBase}all">Todos</label></div>`,
        ...allItems.map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c}" value="${c}" class="mr-2"><label for="${idBase}${c}">${c}</label></div>`)
      ].join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES.filter(c => c!=='Todos los Pa√≠ses'), 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, ALL_NEWS_COMPANIES, 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, ALL_NEWS_CATEGORIES, 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES.filter(c => c!=='Todos los Pa√≠ses'), 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, ALL_CONTENT_COMPANIES, 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, ALL_CONTENT_CATEGORIES, 'content-category-');
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== L√≥gica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function normalizeSelectAll(container, selectedValues) {
      const allBox = container.querySelector('input[value="all"]');
      const rest = [...container.querySelectorAll('input[type="checkbox"]')].filter(b => b.value !== 'all');
      if (!allBox) return;
      if (selectedValues.includes('all')) rest.forEach(b => b.checked = false);
      else if (rest.some(b => b.checked)) allBox.checked = false;
    }
    function filterNews() {
      let sc = getSelected(newsFilterCountryContainer);
      let se = getSelected(newsFilterCompanyContainer);
      let sk = getSelected(newsFilterCategoryContainer);
      normalizeSelectAll(newsFilterCountryContainer, sc);
      normalizeSelectAll(newsFilterCompanyContainer, se);
      normalizeSelectAll(newsFilterCategoryContainer, sk);
      sc = getSelected(newsFilterCountryContainer);
      se = getSelected(newsFilterCompanyContainer);
      sk = getSelected(newsFilterCategoryContainer);
      newsFilters.country = sc.includes('all') ? [] : sc;
      newsFilters.company = se.includes('all') ? [] : se;
      newsFilters.category = sk.includes('all') ? [] : sk;
      renderNewsCards();
    }
    function filterContentNews() {
      let sc = getSelected(contentFilterCountryContainer);
      let se = getSelected(contentFilterCompanyContainer);
      let sk = getSelected(contentFilterCategoryContainer);
      normalizeSelectAll(contentFilterCountryContainer, sc);
      normalizeSelectAll(contentFilterCompanyContainer, se);
      normalizeSelectAll(contentFilterCategoryContainer, sk);
      sc = getSelected(contentFilterCountryContainer);
      se = getSelected(contentFilterCompanyContainer);
      sk = getSelected(contentFilterCategoryContainer);
      contentFilters.country = sc.includes('all') ? [] : sc;
      contentFilters.company = se.includes('all') ? [] : se;
      contentFilters.category = sk.includes('all') ? [] : sk;
      renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

    updateSentimentContent('Brasil');
    updateNewsFilters(); renderNewsCards();
    updateContentNewsFilters(); renderContentNewsCards();
  </script>
</body>
</html>