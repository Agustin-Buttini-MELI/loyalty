<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      "Brasil": {
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "sentimentIndex": [80, 78, 75, 76, 72, 65, 68, 70, 75, 62, 66, 68],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Opción 120% CDI" },
          { "month": "Jun 25", "text": "Cambio en envíos gratis" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Estable", "motivosDet": "Valor percibido reducido", "promotores": "Estable", "motivosPro": "Ecosistema (pagos, envíos)", "eventos": "Período post-cambio en envíos", "competencia": "Magalu y Amazon con campañas agresivas" },
          { "mes": "Jul 25", "detractores": "Aumento leve", "motivosDet": "Confusión con nuevos umbrales", "promotores": "Leve baja", "motivosPro": "Beneficios streaming", "eventos": "Ajuste a cambio en envíos", "competencia": "Prime Day de Amazon" },
          { "mes": "Jun 25", "detractores": "Pico", "motivosDet": "Envío gratis ≥ R$19,90", "promotores": "Caída fuerte", "motivosPro": "Rendimiento 120% CDI", "eventos": "Cambio en política de envíos gratis", "competencia": "Shopee mantiene agresividad en envíos" },
          { "mes": "May 25", "detractores": "Baja", "motivosDet": "Costo de suscripción", "promotores": "Pico", "motivosPro": "Rendimiento 120% CDI", "eventos": "Lanzamiento 'Cofrinhos' Meli+ 120% CDI", "competencia": "Nubank Ultravioleta sin cambios" },
          { "mes": "Feb 25", "detractores": "Pico", "motivosDet": "Reducción % cashback", "promotores": "Caída", "motivosPro": "Disney+ incluido", "eventos": "Cambio en porcentaje de cashback", "competencia": "PicPay intensifica cashback" },
          { "mes": "Sep 24", "detractores": "Moderado", "motivosDet": "Confusión inicial, valor", "promotores": "Alto", "motivosPro": "Novedad, beneficios integrados", "eventos": "Lanzamiento de Meli+", "competencia": "Amazon Prime como benchmark" }
        ],
        "summary": "<ul><li><strong>Principal detractor:</strong> El cambio en la política de envíos gratis en junio 2025 generó la mayor ola de comentarios negativos, percibido como una devaluación del beneficio principal de Meli+. <q>Agora Meli+ não vale mais a pena, o frete grátis era TUDO.</q> (X)</li><li><strong>Principal promotor:</strong> La introducción de la opción de rendimiento al 120% del CDI en mayo 2025 fue muy bien recibida por usuarios con perfil de inversión, diferenciando la oferta de competidores directos. <q>Genial o Meli+ rendendo 120% do CDI, melhor que muito investimento por aí.</q> (YouTube)</li></ul>"
      },
      "México": {
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "sentimentIndex": [78, 77, 79, 81, 75, 68, 70, 72, 65, 68, 71, 73],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Hot Sale / Lanzamiento Nu+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Estable", "motivosDet": "Comparación con Amazon Prime", "promotores": "Estable", "motivosPro": "Velocidad de envíos Full", "eventos": "Temporada post-Hot Sale", "competencia": "Liverpool con ventas nocturnas" },
          { "mes": "May 25", "detractores": "Pico", "motivosDet": "Retrasos en logística (Hot Sale)", "promotores": "Leve baja", "motivosPro": "Descuentos y cuotas", "eventos": "Hot Sale México", "competencia": "Nubank lanza su programa de lealtad 'NU+'" },
          { "mes": "Feb 25", "detractores": "Pico", "motivosDet": "Reducción % cashback", "promotores": "Caída", "motivosPro": "Max y Disney+ incluidos", "eventos": "Cambio en porcentaje de cashback", "competencia": "Klar ofrece cashback competitivo" },
          { "mes": "Sep 24", "detractores": "Moderado", "motivosDet": "Costo mensual", "promotores": "Alto", "motivosPro": "Acceso a Disney+/Max", "eventos": "Lanzamiento de Meli+", "competencia": "Amazon Prime bien establecido" }
        ],
        "summary": "<ul><li><strong>Principal detractor:</strong> La temporada de alta demanda como el Hot Sale en mayo 2025 concentró quejas sobre logística y tiempos de entrega, afectando la percepción de fiabilidad del envío 'Full' de Meli+. <q>De qué sirve Meli+ si mi paquete del Hot Sale lleva una semana atorado?</q> (Apestan.com)</li><li><strong>Principal promotor:</strong> El paquete de streaming (Disney+, Max) sigue siendo el gancho más fuerte y consistentemente elogiado por los usuarios. <q>Pago Meli+ y es como si me regalaran los envíos, ya con Disney y Max se paga solo.</q> (Facebook)</li></ul>"
      },
      "Chile": {
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "sentimentIndex": [70, 72, 73, 75, 74, 75, 77, 82, 80, 79, 78, 78],
        "events": [
          { "month": "Abr 25", "text": "Nuevos beneficios locales" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Bajo", "motivosDet": "Poca variedad en algunos beneficios", "promotores": "Estable", "motivosPro": "Descuentos en comercios asociados", "eventos": "Consolidación de nuevos beneficios", "competencia": "Falabella con descuentos CMR agresivos" },
          { "mes": "Abr 25", "detractores": "Baja", "motivosDet": "Confusión en la redención", "promotores": "Pico", "motivosPro": "Nuevos descuentos locales", "eventos": "Anuncio de nuevos beneficios locales (ej. farmacias, bencina)", "competencia": "Ripley sin cambios en su programa" }
        ],
        "summary": "<ul><li><strong>Principal detractor:</strong> Usuarios reportan que la oferta de streaming, aunque valorada, tiene menor peso que en otros mercados debido a la competencia y a que los beneficios locales son más tangibles. <q>El descuento en la farmacia es útil, pero me gustaría más opciones.</q> (Reddit)</li><li><strong>Principal promotor:</strong> La adición de nuevos beneficios y descuentos en comercios locales en abril 2025 fue un acierto, generando una percepción de valor tangible y adaptado al mercado chileno. <q>¡Buenísimo el descuento en bencina con Meli+! Ahí se desquita al tiro.</q> (X)</li></ul>"
      },
      "Argentina": {
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "sentimentIndex": [65, 68, 70, 72, 73, 74, 75, 77, 82, 80, 78, 77],
        "events": [
          { "month": "May 25", "text": "Lanzamiento Meli+ (desde Nivel 6)" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Estable", "motivosDet": "Costo ajustado por inflación", "promotores": "Estable", "motivosPro": "Paquete de streaming y descuentos", "eventos": "Contexto inflacionario", "competencia": "Ualá y NaranjaX con ofertas de ecosistema" },
          { "mes": "May 25", "detractores": "Bajo", "motivosDet": "Cambio confuso desde Nivel 6", "promotores": "Pico", "motivosPro": "Mejores beneficios que Nivel 6", "eventos": "Migración de Nivel 6 a Meli+", "competencia": "Poca competencia directa en programas similares" }
        ],
        "summary": "<ul><li><strong>Principal detractor:</strong> La principal preocupación recurrente es el impacto de la inflación en el costo de la suscripción, con usuarios evaluando constantemente el costo-beneficio. <q>Con lo que aumenta todo, tengo que ver si me sigue rindiendo pagar Meli+.</q> (tuquejasuma.com)</li><li><strong>Principal promotor:</strong> La transición de Nivel 6 a Meli+ en mayo 2025 fue percibida como una mejora sustancial, especialmente por la inclusión de más servicios de streaming y descuentos mejorados. <q>El cambio a Meli+ valió la pena, ahora tengo Disney y Max por casi lo mismo.</q> (Foro 3DGames)</li></ul>"
      },
      "Colombia": {
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "sentimentIndex": [68, 70, 71, 73, 72, 70, 69, 68, 67, 70, 72, 78],
        "events": [
          { "month": "May 25", "text": "Amazon Prime llega a CO" },
          { "month": "Ago 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "Ago 25", "detractores": "Moderado", "motivosDet": "Precio de lanzamiento, comparación", "promotores": "Alto", "motivosPro": "Novedad, paquete de streaming", "eventos": "Lanzamiento de Meli+", "competencia": "Amazon Prime ya operativo y con envíos gratis" },
          { "mes": "May 25", "detractores": "N/A", "motivosDet": "N/A", "promotores": "N/A", "motivosPro": "N/A", "eventos": "Expectativa por Meli+", "competencia": "Amazon Prime lanza su operación local con Prime Video" }
        ],
        "summary": "<ul><li><strong>Principal detractor:</strong> Durante el lanzamiento en agosto 2025, las comparaciones directas con Amazon Prime (que había llegado en mayo) fueron el principal punto de fricción, especialmente en el costo y la percepción del catálogo de Prime Video vs. el paquete Disney+/Max. <q>Meli+ está caro comparado con Prime que acaba de llegar, toca hacer cuentas.</q> (Comentarios en El Tiempo)</li><li><strong>Principal promotor:</strong> El factor 'novedad' y la fortaleza del ecosistema existente de Mercado Libre (envíos rápidos, red de vendedores) generaron una fuerte ola de adopción inicial. <q>Por fin Meli+ en Colombia, adiós a pagar Disney aparte, y los envíos llegan mañana mismo.</q> (TikTok)</li></ul>"
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      { "id": 1, "entity": "OpenAI", "country": "Todos los Países", "impact": "Alto", "title": "OpenAI Announces General Availability of GPT-5 Series via API and for ChatGPT Plus Subscribers", "url": "https://openai.com/blog/gpt-5-api-and-plus", "date": "06-09-2025", "category": "Flagship AI", "summary": "OpenAI ha lanzado oficialmente su nueva familia de modelos GPT-5, haciéndola disponible para desarrolladores a través de su API y para suscriptores de ChatGPT Plus. El anuncio destaca mejoras exponenciales en razonamiento, multimodalidad y eficiencia.", "publisher": "openai.com", "url_raw": "https://openai.com/blog/gpt-5-api-and-plus", "url_canonical": "https://openai.com/blog/gpt-5-api-and-plus", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 2, "entity": "Amazon Prime", "country": "Brasil", "impact": "Alto", "title": "Amazon to Increase Prime Subscription Price in Brazil by 15% Starting November 1st", "url": "https://press.aboutamazon.com/news/amazon-prime-price-update-brazil-2025", "date": "04-09-2025", "category": "Cambio de Precio", "summary": "Amazon anunció un ajuste en el precio de la suscripción de Amazon Prime en Brasil, que aumentará un 15% a partir del 1 de noviembre de 2025. La compañía cita la expansión de beneficios de envío y el aumento de contenido en Prime Video como justificación.", "publisher": "press.aboutamazon.com", "url_raw": "https://press.aboutamazon.com/news/amazon-prime-price-update-brazil-2025", "url_canonical": "https://press.aboutamazon.com/news/amazon-prime-price-update-brazil-2025", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 3, "entity": "Shein", "country": "México", "impact": "Medio", "title": "Mexico's Antitrust Regulator COFECE Opens Investigation into Fast Fashion E-commerce Practices", "url": "https://www.reuters.com/world/americas/mexico-antitrust-body-probes-fast-fashion-e-commerce-2025-09-02/", "date": "02-09-2025", "category": "Sanción Legal", "summary": "La COFECE ha iniciado una investigación sobre posibles prácticas monopólicas en el mercado de comercio electrónico de moda rápida. Aunque no se nombraron empresas específicas, se entiende que la investigación se centra en jugadores dominantes como Shein y Temu.", "publisher": "reuters.com", "url_raw": "https://www.reuters.com/world/americas/mexico-antitrust-body-probes-fast-fashion-e-commerce-2025-09-02/", "url_canonical": "https://www.reuters.com/world/americas/mexico-antitrust-body-probes-fast-fashion-e-commerce-2025-09-02/", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 4, "entity": "Rappi Pro", "country": "Colombia", "impact": "Medio", "title": "Rappi and Bancolombia Announce Strategic Alliance for Rappi Pro Benefits", "url": "https://blog.rappi.com/rappi-bancolombia-alianza-pro-2025", "date": "29-08-2025", "category": "Estrategia", "summary": "Rappi y Bancolombia anunciaron una alianza estratégica que otorgará a los clientes del banco meses gratis de Rappi Pro y descuentos exclusivos. La medida busca aumentar la base de suscriptores de Pro y fidelizar a los clientes del banco.", "publisher": "blog.rappi.com", "url_raw": "https://blog.rappi.com/rappi-bancolombia-alianza-pro-2025", "url_canonical": "https://blog.rappi.com/rappi-bancolombia-alianza-pro-2025", "http_status": "200", "language": "es", "out_of_window": false }
    ];
    const contentNewsData = [
      { "id": 101, "entity": "Disney+", "country": "Argentina", "impact": "Alto", "title": "Disney's Star+ Secures Exclusive Multi-Year Broadcast Rights for Liga Profesional de Fútbol Starting 2026", "url": "https://www.espnpressroom.com/latin-america/press-releases/2025/09/star-plus-secures-liga-profesional-futbol-argentina/", "date": "05-09-2025", "category": "Derechos/Deportes", "summary": "The Walt Disney Company Latin America confirmó que Star+ será el broadcaster exclusivo de la primera división del fútbol argentino por un período de 5 años a partir de la temporada 2026. Este acuerdo consolida a la plataforma como un jugador clave en el contenido deportivo en vivo.", "publisher": "espnpressroom.com", "url_raw": "https://www.espnpressroom.com/latin-america/press-releases/2025/09/star-plus-secures-liga-profesional-futbol-argentina/", "url_canonical": "https://www.espnpressroom.com/latin-america/press-releases/2025/09/star-plus-secures-liga-profesional-futbol-argentina/", "http_status": "200", "language": "es", "out_of_window": false },
      { "id": 102, "entity": "Netflix", "country": "Todos los Países", "impact": "Medio", "title": "Netflix Rolls Out 'Genre Mix' Feature, Using AI to Create Personalized Content Carousels", "url": "https://about.netflix.com/en/news/introducing-genre-mix-ai-recommendations", "date": "03-09-2025", "category": "Producto", "summary": "Netflix está implementando globalmente una nueva función llamada 'Genre Mix'. Utiliza IA para analizar el historial de visualización de un usuario y crear carruseles de contenido personalizados que combinan géneros, como 'Thrillers de Ciencia Ficción con un Toque de Comedia'.", "publisher": "about.netflix.com", "url_raw": "https://about.netflix.com/en/news/introducing-genre-mix-ai-recommendations", "url_canonical": "https://about.netflix.com/en/news/introducing-genre-mix-ai-recommendations", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 103, "entity": "Max", "country": "Todos los Países", "impact": "Medio", "title": "Warner Bros. Discovery Confirms Plan to Launch Live News Hub on Max in Q1 2026", "url": "https://www.wbd.com/newsroom/press-releases/2025/09/08/wbd-announces-live-news-hub-max/", "date": "08-09-2025", "category": "Estrategia", "summary": "Warner Bros. Discovery ha delineado sus planes para integrar un hub de noticias en vivo dentro de Max, que incluirá contenido de CNN y otras fuentes. El lanzamiento está previsto para el primer trimestre de 2026, comenzando en EE. UU. y expandiéndose a mercados internacionales.", "publisher": "wbd.com", "url_raw": "https://www.wbd.com/newsroom/press-releases/2025/09/08/wbd-announces-live-news-hub-max/", "url_canonical": "https://www.wbd.com/newsroom/press-releases/2025/09/08/wbd-announces-live-news-hub-max/", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 104, "entity": "Spotify", "country": "Todos los Países", "impact": "Medio", "title": "Spotify Faces Renewed EU Regulatory Scrutiny Over 'Discovery Mode' and Artist Royalty Payments", "url": "https://www.bloomberg.com/news/articles/2025-09-08/spotify-s-discovery-mode-draws-fresh-eu-antitrust-complaints", "date": "08-09-2025", "category": "Sanción Legal", "summary": "Reguladores de la Unión Europea están examinando nuevas quejas de grupos de artistas sobre el programa 'Discovery Mode' de Spotify. Las quejas alegan que el sistema, que permite a los artistas aceptar una tasa de regalías más baja a cambio de una mayor visibilidad, es anticompetitivo.", "publisher": "bloomberg.com", "url_raw": "https://www.bloomberg.com/news/articles/2025-09-08/spotify-s-discovery-mode-draws-fresh-eu-antitrust-complaints", "url_canonical": "https://www.bloomberg.com/news/articles/2025-09-08/spotify-s-discovery-mode-draws-fresh-eu-antitrust-complaints", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 105, "entity": "Paramount+", "country": "Todos los Países", "impact": "Medio", "title": "Skydance-Paramount Global Merger Officially Closes; David Ellison Named CEO", "url": "https://www.paramount.com/news/press/skydance-media-and-paramount-global-complete-merger", "date": "28-08-2025", "category": "Fusión/Adquisición", "summary": "La fusión entre Skydance Media y Paramount Global se ha completado oficialmente. David Ellison, CEO de Skydance, ha sido nombrado CEO de la nueva entidad combinada. El cierre marca el fin de un largo proceso de negociación y reestructuración para el futuro de Paramount+ y otros activos.", "publisher": "paramount.com", "url_raw": "https://www.paramount.com/news/press/skydance-media-and-paramount-global-complete-merger", "url_canonical": "https://www.paramount.com/news/press/skydance-media-and-paramount-global-complete-merger", "http_status": "200", "language": "en", "out_of_window": false }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('Todos los Países') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('Todos los Países') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('Todos los Países') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('Todos los Países') || contentFilters.country.includes(item.country);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('Todos los Países') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('Todos los Países') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group, filtersRef) {
      container.innerHTML = allItems.map(item => `
        <div class="filter-checkbox-item">
          <input type="checkbox" id="${group}-${item.replace(/\s+/g, '-')}" value="${item}" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
          <label for="${group}-${item.replace(/\s+/g, '-')}" class="text-sm text-gray-700">${item}</label>
        </div>
      `).join('');
    }

    function setupFilterLogic(container, filterGroup, renderFunction) {
        container.addEventListener('change', (event) => {
            if (event.target.type === 'checkbox') {
                const selected = Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
                filterGroup.splice(0, filterGroup.length, ...selected);
                renderFunction();
            }
        });
    }
    
    function resetFilters(container, filterGroup, renderFunction){
        filterGroup.length = 0;
        Array.from(container.querySelectorAll('input:checked')).forEach(input => input.checked = false);
        renderFunction();
    }

    function initializeFilters() {
      const uniqueNewsCountries = [...new Set(newsData.map(d => d.country))].sort();
      const uniqueNewsCompanies = [...new Set(newsData.map(d => d.entity))].sort();
      const uniqueNewsCategories = [...new Set(newsData.map(d => d.category))].sort();
      populateCheckboxes(newsFilterCountryContainer, uniqueNewsCountries, 'news-country', newsFilters.country);
      populateCheckboxes(newsFilterCompanyContainer, uniqueNewsCompanies, 'news-company', newsFilters.company);
      populateCheckboxes(newsFilterCategoryContainer, uniqueNewsCategories, 'news-category', newsFilters.category);
      setupFilterLogic(newsFilterCountryContainer, newsFilters.country, renderNewsCards);
      setupFilterLogic(newsFilterCompanyContainer, newsFilters.company, renderNewsCards);
      setupFilterLogic(newsFilterCategoryContainer, newsFilters.category, renderNewsCards);
      document.getElementById('news-reset-filters').addEventListener('click', () => resetFilters(document.querySelector('#market-news'), newsFilters.country.concat(newsFilters.company, newsFilters.category), renderNewsCards));
      
      const uniqueContentCountries = [...new Set(contentNewsData.map(d => d.country).filter(c => c))].sort();
      uniqueContentCountries.unshift('Todos los Países');
      const uniqueContentCompanies = [...new Set(contentNewsData.map(d => d.entity))].sort();
      const uniqueContentCategories = [...new Set(contentNewsData.map(d => d.category))].sort();
      populateCheckboxes(contentFilterCountryContainer, uniqueContentCountries, 'content-country', contentFilters.country);
      populateCheckboxes(contentFilterCompanyContainer, uniqueContentCompanies, 'content-company', contentFilters.company);
      populateCheckboxes(contentFilterCategoryContainer, uniqueContentCategories, 'content-category', contentFilters.category);
      setupFilterLogic(contentFilterCountryContainer, contentFilters.country, renderContentNewsCards);
      setupFilterLogic(contentFilterCompanyContainer, contentFilters.company, renderContentNewsCards);
      setupFilterLogic(contentFilterCategoryContainer, contentFilters.category, renderContentNewsCards);
      document.getElementById('content-reset-filters').addEventListener('click', () => {
          contentFilters.country.length=0; contentFilters.company.length=0; contentFilters.category.length=0;
          [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => Array.from(c.querySelectorAll('input:checked')).forEach(i => i.checked = false));
          renderContentNewsCards();
      });
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    
    document.getElementById('news-reset-filters').addEventListener('click', () => {
        newsFilters = { country: [], company: [], category: [] };
        [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(container => {
            Array.from(container.querySelectorAll('input[type="checkbox"]')).forEach(checkbox => checkbox.checked = false);
        });
        renderNewsCards();
    });

    document.getElementById('content-reset-filters').addEventListener('click', () => {
        contentFilters = { country: [], company: [], category: [] };
        [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(container => {
            Array.from(container.querySelectorAll('input[type="checkbox"]')).forEach(checkbox => checkbox.checked = false);
        });
        renderContentNewsCards();
    });

    document.addEventListener('DOMContentLoaded', () => {
      updateSentimentContent('Brasil');
      initializeFilters();
      renderNewsCards();
      renderContentNewsCards();
    });
  </script>
</body>
</html>