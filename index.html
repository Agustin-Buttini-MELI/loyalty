<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
    details summary { list-style: none; cursor: pointer; }
    details summary::-webkit-details-marker { display: none; }
    details[open] summary svg { transform: rotate(180deg); }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">An√°lisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evoluci√≥n de la percepci√≥n de los clientes en funci√≥n de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">√çndice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section id="glosario" class="bg-white rounded-lg shadow-md border border-gray-200 mb-8">
      <details>
        <summary class="w-full flex justify-between items-center px-4 py-3 text-left text-gray-800 font-semibold hover:bg-gray-50 focus:outline-none">
          üìñ Glosario
          <svg class="w-5 h-5 text-gray-500 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </summary>
        <div id="glosario-content" class="px-4 pb-4 pt-2 text-sm text-gray-700 space-y-4 border-t border-gray-200">
          <div>
            <p class="font-semibold mb-1">Niveles de sentimiento</p>
            <ul class="list-disc list-inside space-y-1">
              <li><span class="text-emerald-700 font-medium">Muy alto:</span> ‚â•55% menciones ponderadas o +10 p.p. vs. promedio 3m.</li>
              <li><span class="text-emerald-600 font-medium">Alto:</span> 50‚Äì54% o +5 a +9 p.p.</li>
              <li><span class="text-gray-700 font-medium">Estable:</span> cambio ‚â§¬±3 p.p. vs. mes previo.</li>
              <li><span class="text-rose-600 font-medium">Bajo:</span> 30‚Äì39% o ‚àí5 a ‚àí9 p.p.</li>
              <li><span class="text-rose-700 font-medium">Muy bajo:</span> ‚â§29% o ca√≠da ‚â•‚àí10 p.p.</li>
            </ul>
          </div>
          <div>
            <p class="font-semibold mb-1">Menci√≥n</p>
            <p>
              Comentario individual capturado en fuentes monitorizadas (Reclame Aqui, SERNAC, Apestan.com, tuquejasuma, SIC, redes, foros, comentarios en noticias).
              Tras limpieza/deduplicaci√≥n, cada menci√≥n se pondera por <em>engagement</em>, <em>recencia</em>, <em>credibilidad</em> y <em>severidad</em>.
              La suma ponderada genera el √≠ndice mensual (0‚Äì100).
            </p>
          </div>
          <p class="text-xs text-gray-500">Glosario est√°tico: no cambia entre corridas.</p>
        </div>
      </details>
    </section>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="M√©xico" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">M√©xico</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por Pa√≠s: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualizaci√≥n interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      'Brasil': {
        sentimentIndex: [75, 78, 77, 80, 79, 65, 68, 70, 85, 60, 62, 65, 68, 78, 80],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25', 'Nov 25'],
        events: [
          { month: 'Sep 24', text: 'Lanzamiento Meli+' },
          { month: 'Feb 25', text: 'Cambio % cashback' },
          { month: 'May 25', text: 'Meli+ 120% CDI' },
          { month: 'Jun 25', text: 'Cambio env√≠os gratis' },
          { month: 'Oct 25', text: 'Lanzamiento Meli+ Mega' }
        ],
        table: [
          { mes: 'Oct 25', detractores: 'Bajo', motivosDet: 'Confusi√≥n sobre Meli+ Mega', promotores: 'Alto', motivosPro: 'Beneficios Meli+ Mega', eventos: 'Lanzamiento del tier Meli+ Mega con 4 streamings.', competencia: 'Amazon Prime Day global.' },
          { mes: 'Jun 25', detractores: 'Muy Alto', motivosDet: 'Percepci√≥n de p√©rdida de valor', promotores: 'Bajo', motivosPro: 'Ahorro en compras recurrentes', eventos: 'Env√≠o gratis generalizado desde R$19,90, diluye el beneficio Meli+.', competencia: 'Shopee con cupones agresivos.' },
          { mes: 'May 25', detractores: 'Bajo', motivosDet: 'Demoras en entregas', promotores: 'Muy Alto', motivosPro: 'Rendimiento 120% CDI', eventos: 'Anuncio de rendimiento 120% CDI en cuenta Meli.', competencia: 'Amazon introduce anuncios en Prime Video.' },
          { mes: 'Feb 25', detractores: 'Alto', motivosDet: 'Reducci√≥n de cashback', promotores: 'Estable', motivosPro: 'Disney+ y Star+ incluidos', eventos: 'Cambio en el porcentaje de cashback otorgado.', competencia: 'Nubank con campa√±a de marketing fuerte.' }
        ],
        summary: `
          <ul class="list-disc pl-5 space-y-4">
            <li>
              <strong>Pico Negativo (Junio 2025):</strong> El cambio en la pol√≠tica de env√≠o gratis (a partir de R$19,90 para todos) gener√≥ una ola de quejas, interpretado como una devaluaci√≥n del principal beneficio de Meli+.
              <blockquote class="mt-2 border-l-4 border-rose-300 pl-4 text-gray-600">
                "Pagar Meli+ para ter o mesmo frete que todo mundo? Qual a vantagem agora? Vou cancelar." (Reclame Aqui)
              </blockquote>
            </li>
            <li>
              <strong>Pico Positivo (Mayo 2025 / Octubre 2025):</strong> El anuncio del rendimiento del 120% del CDI y el lanzamiento de Meli+ Mega fueron los principales impulsores de sentimiento positivo. Los usuarios valoran los beneficios financieros y el paquete de streaming ampliado.
              <blockquote class="mt-2 border-l-4 border-emerald-300 pl-4 text-gray-600">
                "A conta rendendo 120% CDI + os streamings do Meli+ Mega compensa demais. Melhor que qualquer banco digital." (Comentario en YouTube)
              </blockquote>
            </li>
          </ul>`
      },
      'M√©xico': {
        sentimentIndex: [78, 80, 79, 82, 81, 70, 72, 74, 72, 75, 76, 77, 78, 79, 80],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25', 'Nov 25'],
        events: [
          { month: 'Sep 24', text: 'Lanzamiento Meli+' },
          { month: 'Feb 25', text: 'Cambio % cashback' },
          { month: 'May 25', text: 'Hot Sale / Competencia NU+' }
        ],
        table: [
          { mes: 'May 25', detractores: 'Medio', motivosDet: 'Confusi√≥n ofertas Hot Sale', promotores: 'Medio', motivosPro: 'Descuentos y cuotas', eventos: 'Hot Sale MX.', competencia: 'Nubank lanza su programa de lealtad NU+.' },
          { mes: 'Feb 25', detractores: 'Alto', motivosDet: 'Menos cashback, menos valor', promotores: 'Estable', motivosPro: 'Acceso a Max y env√≠os', eventos: 'Ajuste en el porcentaje de cashback.', competencia: 'Amazon agresivo con ofertas de Prime.' },
          { mes: 'Sep 24', detractores: 'Bajo', motivosDet: 'Problemas de activaci√≥n', promotores: 'Muy Alto', motivosPro: 'Paquete de beneficios', eventos: 'Lanzamiento de Meli+ en M√©xico.', competencia: 'Walmart Pass renueva beneficios.' }
        ],
        summary: `
          <ul class="list-disc pl-5 space-y-4">
            <li>
              <strong>Impacto Negativo (Febrero 2025):</strong> Similar a Brasil, la reducci√≥n del cashback fue mal recibida, siendo el principal detractor del per√≠odo.
              <blockquote class="mt-2 border-l-4 border-rose-300 pl-4 text-gray-600">
                "Le bajaron al cashback, ya no es tan atractivo como antes. Apenas se justifica con los env√≠os." (Apestan.com)
              </blockquote>
            </li>
            <li>
              <strong>Contexto Competitivo (Mayo 2025):</strong> El lanzamiento de NU+ por parte de Nubank y las agresivas ofertas de Amazon durante Hot Sale generaron comparaciones directas, estabilizando el sentimiento de Meli+ en un nivel m√°s bajo que el inicial.
            </li>
          </ul>`
      },
      'Chile': {
        sentimentIndex: [60, 62, 61, 63, 64, 65, 66, 78, 79, 80, 79, 78, 77, 78, 79],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25', 'Nov 25'],
        events: [
          { month: 'Abr 25', text: 'Nuevos beneficios Meli+' }
        ],
        table: [
          { mes: 'Abr 25', detractores: 'Bajo', motivosDet: 'Log√≠stica en regiones', promotores: 'Muy Alto', motivosPro: 'Nuevos descuentos y Universal+', eventos: 'Se agregan nuevos beneficios al programa Meli+.', competencia: 'Falabella con descuentos agresivos con tarjeta CMR.' },
          { mes: 'Ene 25', detractores: 'Estable', motivosDet: 'Costo de suscripci√≥n', promotores: 'Estable', motivosPro: 'Env√≠os gratis', eventos: 'Per√≠odo sin cambios mayores.', competencia: 'Ripley con campa√±a de env√≠os.' }
        ],
        summary: `
          <ul class="list-disc pl-5 space-y-4">
            <li>
              <strong>Punto de Inflexi√≥n (Abril 2025):</strong> La adici√≥n de nuevos beneficios, incluyendo descuentos en m√°s categor√≠as y la integraci√≥n de Universal+, fue un claro impulsor del sentimiento, llevando el √≠ndice a niveles altos y sostenidos.
              <blockquote class="mt-2 border-l-4 border-emerald-300 pl-4 text-gray-600">
                "Ahora s√≠ vale la pena Meli+. Los descuentos nuevos y otra plataforma de streaming lo hacen mucho m√°s completo." (Comentario en Facebook)
              </blockquote>
            </li>
          </ul>`
      },
      'Argentina': {
        sentimentIndex: [55, 56, 54, 58, 57, 59, 60, 62, 80, 78, 77, 79, 81, 80, 79],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25', 'Nov 25'],
        events: [
          { month: 'May 25', text: 'Lanzamiento Meli+' }
        ],
        table: [
          { mes: 'May 25', detractores: 'Bajo', motivosDet: 'Confusi√≥n migraci√≥n Nivel 6', promotores: 'Muy Alto', motivosPro: 'M√°s beneficios por el mismo precio', eventos: 'Lanzamiento de Meli+, reemplazando Nivel 6.', competencia: 'Ual√° lanza nuevo programa de puntos.' },
          { mes: 'Mar 25', detractores: 'Medio', motivosDet: 'Pocos beneficios percibidos', promotores: 'Estable', motivosPro: 'Env√≠os y descuentos puntuales', eventos: 'Expectativa por la llegada de Meli+.', competencia: 'Sin movimientos relevantes.' }
        ],
        summary: `
          <ul class="list-disc pl-5 space-y-4">
            <li>
              <strong>Salto Cuantitativo (Mayo 2025):</strong> El reemplazo de Nivel 6 por Meli+ fue un √©xito rotundo. Los usuarios percibieron un aumento significativo en el valor del programa, principalmente por la inclusi√≥n de Disney+ y Star+ sin un aumento de precio equivalente.
              <blockquote class="mt-2 border-l-4 border-emerald-300 pl-4 text-gray-600">
                "Pasar a Meli+ fue lo mejor que hicieron. Antes Nivel 6 era medio pelo, ahora con las series y pel√≠culas garpa mucho m√°s." (Foro Reddit)
              </blockquote>
            </li>
          </ul>`
      },
      'Colombia': {
        sentimentIndex: [58, 59, 60, 62, 61, 63, 64, 63, 60, 62, 65, 82, 80, 79, 78],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25', 'Nov 25'],
        events: [
          { month: 'May 25', text: 'Amazon Prime llega a CO' },
          { month: 'Ago 25', text: 'Lanzamiento Meli+' }
        ],
        table: [
          { mes: 'Ago 25', detractores: 'Bajo', motivosDet: 'Comparaci√≥n con Prime', promotores: 'Muy Alto', motivosPro: 'Paquete de streaming y env√≠os', eventos: 'Lanzamiento de Meli+ en Colombia.', competencia: 'Rappi Pro con nueva campa√±a de marketing.' },
          { mes: 'May 25', detractores: 'Estable', motivosDet: 'Beneficios limitados de Nivel 6', promotores: 'Bajo', motivosPro: 'Env√≠os en Bogot√°', eventos: 'Contexto de alta expectativa por Meli+.', competencia: 'Amazon Prime lanza oficialmente su servicio en el pa√≠s.' }
        ],
        summary: `
          <ul class="list-disc pl-5 space-y-4">
            <li>
              <strong>Lanzamiento Exitoso (Agosto 2025):</strong> A pesar de la llegada de Amazon Prime meses antes, el lanzamiento de Meli+ fue muy bien recibido, generando un salto de m√°s de 20 puntos en el √≠ndice de sentimiento. El paquete de streaming fue el diferenciador clave.
              <blockquote class="mt-2 border-l-4 border-emerald-300 pl-4 text-gray-600">
                "Cre√≠ que con Amazon ya no me convendr√≠a, pero Meli+ con Disney y Star+ es una oferta mucho mejor para mi familia. Bien jugado." (SIC)
              </blockquote>
            </li>
          </ul>`
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      { "id": 1, "entity": "Temu", "country": "Argentina", "impact": "Alto", "title": "Temu Confirms Launch in Argentina and Chile for Early 2026", "url": "https://www.bloomberg.com/news/articles/2025-11-12/temu-confirms-launch-in-argentina-chile-for-early-2026", "date": "12-11-2025", "category": "Lanzamiento", "summary": "PDD Holdings' e-commerce platform Temu officially announced its operational launch in Argentina and Chile, slated for Q1 2026, intensifying competition in the South American market.", "publisher": "bloomberg.com" },
      { "id": 2, "entity": "Rappi Pro", "country": "Brasil", "impact": "Alto", "title": "Rappi to Increase Pro Subscription Price in Brazil and Mexico", "url": "https://www.reuters.com/business/retail-consumer/rappi-increase-pro-subscription-price-brazil-mexico-2025-11-15/", "date": "15-11-2025", "category": "Cambio de Precio", "summary": "Rappi announced a 15% price increase for its 'Pro' membership in Brazil and Mexico, effective January 2026, citing expanded benefits and rising operational costs.", "publisher": "reuters.com" },
      { "id": 3, "entity": "Shein", "country": "M√©xico", "impact": "Medio", "title": "Shein Expands Logistics Network in Mexico Through New Local Partnership", "url": "https://www.reuters.com/business/retail-consumer/shein-expands-logistics-network-mexico-2025-11-10/", "date": "10-11-2025", "category": "Estrategia", "summary": "Shein has partnered with a major local logistics firm in Mexico to reduce delivery times and improve last-mile service across the country.", "publisher": "reuters.com" },
      { "id": 4, "entity": "Amazon Prime", "country": "Brasil", "impact": "Medio", "title": "Amazon Brazil Touts Record Prime Day Sales Driven by Electronics and Home Goods", "url": "https://press.aboutamazon.com/br/news/amazon-brazil-touts-record-prime-day-sales", "date": "06-11-2025", "category": "Resultados Financieros", "summary": "Amazon announced that its recent Prime Day event in Brazil was the largest to date, with millions of items sold and significant growth in the electronics and home goods categories.", "publisher": "press.aboutamazon.com" }
    ];
    const contentNewsData = [
      { "id": 5, "entity": "OpenAI", "country": "Todos los Pa√≠ses", "impact": "Alto", "title": "OpenAI Begins Phased Rollout of GPT-5 API for Enterprise Customers", "url": "https://openai.com/blog/gpt-5-api-phased-rollout", "date": "14-11-2025", "category": "Flagship AI", "summary": "OpenAI has started providing access to its next-generation GPT-5 model via API to a select group of enterprise partners, with broader availability expected in early 2026.", "publisher": "openai.com" },
      { "id": 6, "entity": "Max", "country": "Brasil", "impact": "Alto", "title": "Warner Bros. Discovery Secures Exclusive UEFA Champions League Rights for Max in Brazil Through 2030", "url": "https://wbd.com/pressroom/2025/11/05/wbd-secures-exclusive-uefa-champions-league-rights-for-max-in-brazil/", "date": "05-11-2025", "category": "Derechos/Deportes", "summary": "In a major move, WBD has won the bidding for exclusive streaming rights to the UEFA Champions League in Brazil for its Max platform, covering the 2027-2030 cycle.", "publisher": "wbd.com" },
      { "id": 7, "entity": "Netflix", "country": "Todos los Pa√≠ses", "impact": "Medio", "title": "Netflix to Add Cloud Gaming Features for Premium Subscribers", "url": "https://about.netflix.com/en/news/cloud-gaming-coming-to-netflix-premium", "date": "11-11-2025", "category": "Producto", "summary": "Netflix is expanding its gaming strategy by introducing a cloud gaming beta, allowing Premium members to play select games on TVs and computers without downloads.", "publisher": "about.netflix.com" },
      { "id": 8, "entity": "Disney+", "country": "M√©xico", "impact": "Medio", "title": "Disney+ introduces new 'Premium Family' tier in Mexico with 4K and more simultaneous streams", "url": "https://thewaltdisneycompany.com/disney-plus-introduces-new-premium-family-tier-in-mexico/", "date": "07-11-2025", "category": "Cambio de Precio", "summary": "Disney launched a new, higher-priced subscription tier in Mexico, 'Premium Family,' offering 4K streaming and up to 4 simultaneous devices, repositioning its existing plans.", "publisher": "thewaltdisneycompany.com" },
      { "id": 9, "entity": "Spotify", "country": "Todos los Pa√≠ses", "impact": "Medio", "title": "Spotify Acquires AI Music Composition Startup 'Melodai' to Bolster Creation Tools", "url": "https://investors.spotify.com/press/2025/11/09/spotify-acquires-melodai/", "date": "09-11-2025", "category": "Fusi√≥n/Adquisici√≥n", "summary": "Spotify has completed the acquisition of Melodai, a startup specializing in AI-driven music composition, to integrate its technology into Spotify for Artists.", "publisher": "investors.spotify.com" }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico','Todos los Pa√≠ses'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ual√°','Cablevisi√≥n Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico','Todos los Pa√≠ses'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gr√°fico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: '√çndice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '√çndice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-rose-50 text-rose-700 ring-1 ring-inset ring-rose-600/10">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-emerald-50 text-emerald-700 ring-1 ring-inset ring-emerald-600/10">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categor√≠a ==== */
    function getCategoryTag(category) {
      const colors = {
        'Sanci√≥n Legal': 'bg-red-100 text-red-800',
        'Cambio de Precio': 'bg-yellow-100 text-yellow-800',
        'Lanzamiento': 'bg-blue-100 text-blue-800',
        'Fusi√≥n/Adquisici√≥n': 'bg-green-100 text-green-800',
        'Estrategia': 'bg-purple-100 text-purple-800',
        'Producto': 'bg-orange-100 text-orange-800',
        'Resultados Financieros': 'bg-teal-100 text-teal-800',
        'Derechos/Deportes': 'bg-indigo-100 text-indigo-800',
        'Flagship AI': 'bg-pink-100 text-pink-800'
      };
      const colorClass = colors[category] || 'bg-gray-100 text-gray-800';
      return `<span class="${colorClass} text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const countryMatch = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.includes(item.country);
        const entityMatch = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const categoryMatch = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return countryMatch && entityMatch && categoryMatch;
      }).sort((a,b) => {
        const impactOrder = { 'Alto': 1, 'Medio': 2, 'Bajo': 3 };
        const dateA = new Date(a.date.split('-').reverse().join('-'));
        const dateB = new Date(b.date.split('-').reverse().join('-'));
        if (dateA > dateB) return -1;
        if (dateA < dateB) return 1;
        return (impactOrder[a.impact] || 99) - (impactOrder[b.impact] || 99);
      });
      newsNoResults.classList.toggle('hidden', filtered.length > 0);
      alertsGrid.classList.toggle('hidden', filtered.length === 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Pa√≠ses' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const countryMatch = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.includes(item.country);
        const entityMatch = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const categoryMatch = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return countryMatch && entityMatch && categoryMatch;
      }).sort((a, b) => {
        const impactOrder = { 'Alto': 1, 'Medio': 2, 'Bajo': 3 };
        const dateA = new Date(a.date.split('-').reverse().join('-'));
        const dateB = new Date(b.date.split('-').reverse().join('-'));
        if (dateA > dateB) return -1;
        if (dateA < dateB) return 1;
        return (impactOrder[a.impact] || 99) - (impactOrder[b.impact] || 99);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length > 0);
      contentAlertsGrid.classList.toggle('hidden', filtered.length === 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const sortedItems = allItems.slice().sort();
      let html = `<div class="filter-checkbox-item"><input type="checkbox" id="${group}all" value="all" class="mr-2"><label for="${group}all" class="font-medium">Todos</label></div>`;
      html += sortedItems.map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${group}${c.replace(/\s+/g, '-')}" value="${c}" class="mr-2"><label for="${group}${c.replace(/\s+/g, '-')}" class="text-sm">${c}</label></div>`).join('');
      container.innerHTML = html;
    }

    function setupFilterLogic(container, stateObject, renderFunc) {
      container.addEventListener('change', (event) => {
        const selected = Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
        if (event.target.value === 'all' && event.target.checked) {
          container.querySelectorAll('input:not([value="all"])').forEach(i => i.checked = false);
          stateObject.length = 0;
        } else if (event.target.value !== 'all' && event.target.checked) {
          const allCheckbox = container.querySelector('input[value="all"]');
          if (allCheckbox) allCheckbox.checked = false;
          stateObject.length = 0;
          container.querySelectorAll('input:checked:not([value="all"])').forEach(i => stateObject.push(i.value));
        } else {
            stateObject.length = 0;
            container.querySelectorAll('input:checked:not([value="all"])').forEach(i => stateObject.push(i.value));
        }
        renderFunc();
      });
    }
    
    function resetFilters(containers, filters, renderFunc) {
      Object.keys(filters).forEach(key => filters[key] = []);
      containers.forEach(container => {
        container.querySelectorAll('input').forEach(input => input.checked = false);
      });
      renderFunc();
    }
    
    /* ==== Tabs & Boot ==== */
    document.addEventListener('DOMContentLoaded', () => {
      // Vertiente 1
      tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
        tabButtons.forEach(b => b.classList.remove('active'));
        e.target.classList.add('active');
        updateSentimentContent(e.target.dataset.country);
      }));
      updateSentimentContent('Brasil');

      // Vertiente 2
      populateCheckboxes(newsFilterCountryContainer, [...new Set(newsData.map(i => i.country).filter(Boolean))], 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, [...new Set(newsData.map(i => i.entity))], 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, [...new Set(newsData.map(i => i.category))], 'news-category-');
      setupFilterLogic(newsFilterCountryContainer, newsFilters.country = [], renderNewsCards);
      setupFilterLogic(newsFilterCompanyContainer, newsFilters.company = [], renderNewsCards);
      setupFilterLogic(newsFilterCategoryContainer, newsFilters.category = [], renderNewsCards);
      document.getElementById('news-reset-filters').addEventListener('click', () => resetFilters(
        [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer], newsFilters, renderNewsCards
      ));
      renderNewsCards();

      // Vertiente 3
      populateCheckboxes(contentFilterCountryContainer, [...new Set(contentNewsData.map(i => i.country).filter(Boolean))], 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, [...new Set(contentNewsData.map(i => i.entity))], 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, [...new Set(contentNewsData.map(i => i.category))], 'content-category-');
      setupFilterLogic(contentFilterCountryContainer, contentFilters.country = [], renderContentNewsCards);
      setupFilterLogic(contentFilterCompanyContainer, contentFilters.company = [], renderContentNewsCards);
      setupFilterLogic(contentFilterCategoryContainer, contentFilters.category = [], renderContentNewsCards);
      document.getElementById('content-reset-filters').addEventListener('click', () => resetFilters(
        [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer], contentFilters, renderContentNewsCards
      ));
      renderContentNewsCards();
    });
  </script>
</body>
</html>
