<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
    details summary { list-style: none; }
    details summary::-webkit-details-marker { display: none; }
    details[open] summary svg { transform: rotate(180deg); }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">An√°lisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evoluci√≥n de la percepci√≥n de los clientes en funci√≥n de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">√çndice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section id="glosario" class="bg-white rounded-lg shadow-md border border-gray-200 mb-8">
      <details>
        <summary class="cursor-pointer w-full flex items-center justify-between px-4 py-3 text-left text-gray-800 font-semibold hover:bg-gray-50">
          <span>üìñ Glosario</span>
          <svg class="w-5 h-5 text-gray-500 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </summary>
        <div class="px-4 pb-4 text-sm text-gray-700 pt-2 space-y-4">
          <div>
            <p class="font-semibold mb-1">Niveles de sentimiento</p>
            <ul class="list-disc list-inside space-y-1">
              <li><span class="text-emerald-700 font-medium">Muy alto:</span> ‚â•55% menciones ponderadas o +10 p.p. vs. promedio 3m.</li>
              <li><span class="text-emerald-600 font-medium">Alto:</span> 50‚Äì54% o +5 a +9 p.p.</li>
              <li><span class="text-gray-700 font-medium">Estable:</span> cambio ‚â§¬±3 p.p. vs. mes previo.</li>
              <li><span class="text-rose-600 font-medium">Bajo:</span> 30‚Äì39% o ‚àí5 a ‚àí9 p.p.</li>
              <li><span class="text-rose-700 font-medium">Muy bajo:</span> ‚â§29% o ca√≠da ‚â•‚àí10 p.p.</li>
            </ul>
          </div>
          <div>
            <p class="font-semibold mb-1">Menci√≥n</p>
            <p>
              Comentario individual capturado en fuentes monitorizadas (Reclame Aqui, SERNAC, Apestan.com, tuquejasuma, SIC, redes, foros, comentarios en noticias).
              Tras limpieza/deduplicaci√≥n, cada menci√≥n se pondera por <em>engagement</em>, <em>recencia</em>, <em>credibilidad</em> y <em>severidad</em>.
              La suma ponderada genera el √≠ndice mensual (0‚Äì100).
            </p>
          </div>
          <p class="text-xs text-gray-500">Glosario est√°tico: no cambia entre corridas.</p>
        </div>
      </details>
    </section>

    <section class="mb-8">
      <div class="flex flex-wrap justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-4 md:px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="M√©xico" class="tab-btn px-4 md:px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">M√©xico</button>
        <button data-country="Chile" class="tab-btn px-4 md:px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-4 md:px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-4 md:px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por Pa√≠s: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none prose-blockquote:border-l-blue-500 prose-blockquote:bg-blue-50 prose-blockquote:p-4 prose-blockquote:rounded-r-lg"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualizaci√≥n interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      "Brasil": {
        "sentimentIndex": [72, 75, 71, 68, 66, 58, 62, 65, 78, 64, 66, 68, 70, 72, 74, 73],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25", "Oct 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Meli+ 120% CDI" },
          { "month": "Jun 25", "text": "Env√≠o gratis general ‚â• R$19,90" }
        ],
        "table": [
          { "mes": "Oct 25", "detractores": "Bajo", "motivosDet": "Precio suscripci√≥n", "promotores": "Alto", "motivosPro": "Rendimiento 120% CDI", "eventos": "Estabilizaci√≥n post-cambios", "competencia": "Shopee agresivo en cupones" },
          { "mes": "Sep 25", "detractores": "Bajo", "motivosDet": "Confusi√≥n beneficios", "promotores": "Alto", "motivosPro": "Entrega r√°pida", "eventos": "Aniversario Meli+", "competencia": "Amazon con Prime Day" },
          { "mes": "Jun 25", "detractores": "Alto", "motivosDet": "Beneficio diluido", "promotores": "Medio", "motivosPro": "Rendimiento 120% CDI", "eventos": "Env√≠o gratis general ‚â• R$19,90", "competencia": "Magalu con ofertas" },
          { "mes": "May 25", "detractores": "Bajo", "motivosDet": "Soporte lento", "promotores": "Muy Alto", "motivosPro": "Rendimiento 120% CDI", "eventos": "Lanzamiento cuenta con 120% CDI", "competencia": "Nubank anuncia cashback" },
          { "mes": "Feb 25", "detractores": "Muy Alto", "motivosDet": "Cashback reducido", "promotores": "Bajo", "motivosPro": "Variedad cat√°logo", "eventos": "Ajuste en % de cashback", "competencia": "N/A" },
          { "mes": "Sep 24", "detractores": "Medio", "motivosDet": "Bugs en la app", "promotores": "Alto", "motivosPro": "Nuevos beneficios", "eventos": "Lanzamiento de Meli+", "competencia": "N/A" }
        ],
        "summary": `<h4>Principales Hallazgos en Brasil</h4>
          <ul>
            <li><strong>Pico Positivo (Mayo 2025):</strong> El lanzamiento de la cuenta con rendimiento del 120% del CDI gener√≥ un fuerte sentimiento promotor, siendo el beneficio m√°s celebrado del a√±o.</li>
            <li><strong>Ca√≠da Significativa (Junio 2025):</strong> La extensi√≥n del env√≠o gratis a compras de bajo valor para no suscriptores fue percibida negativamente por usuarios Meli+, que sintieron una devaluaci√≥n del programa.</li>
            <li><strong>Detractor Persistente:</strong> Aunque bajo, persiste la percepci√≥n de que el precio de la suscripci√≥n es alto si no se aprovechan todos los beneficios.</li>
          </ul>
          <blockquote>
            <p>"Pagar Meli+ para que ahora cualquiera tenga env√≠o gratis en compras chicas no tiene sentido. El √∫nico motivo para quedarme es la cuenta que rinde." (Comentario en Reclame Aqui)</p>
          </blockquote>`
      },
      "M√©xico": {
        "sentimentIndex": [70, 74, 72, 75, 73, 65, 68, 70, 62, 65, 68, 71, 74, 72],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25", "Oct 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Hot Sale / Nubank lanza NU+" }
        ],
        "table": [
          { "mes": "Oct 25", "detractores": "Bajo", "motivosDet": "Disney+ con anuncios", "promotores": "Alto", "motivosPro": "Env√≠os FULL", "eventos": "Estabilizaci√≥n", "competencia": "Amazon con ofertas pre-Buen Fin" },
          { "mes": "May 25", "detractores": "Alto", "motivosDet": "Problemas log√≠sticos", "promotores": "Medio", "motivosPro": "Descuentos Hot Sale", "eventos": "Hot Sale / Lanzamiento NU+", "competencia": "Nubank lanza NU+; Liverpool agresivo" },
          { "mes": "Feb 25", "detractores": "Muy Alto", "motivosDet": "Cashback reducido", "promotores": "Bajo", "motivosPro": "Acceso a Max", "eventos": "Reducci√≥n de % de cashback", "competencia": "Klar ofrece rendimientos" },
          { "mes": "Sep 24", "detractores": "Medio", "motivosDet": "Poca claridad en beneficios", "promotores": "Alto", "motivosPro": "Combo con Disney+", "eventos": "Lanzamiento de Meli+", "competencia": "Amazon Prime Day" }
        ],
        "summary": `<h4>Principales Hallazgos en M√©xico</h4>
          <ul>
            <li><strong>Impacto del Hot Sale (Mayo 2025):</strong> El evento gener√≥ un volumen alto de quejas log√≠sticas que opacaron los comentarios positivos sobre las ofertas, causando una ca√≠da temporal en el √≠ndice de sentimiento.</li>
            <li><strong>Reacci√≥n a Competencia (Mayo 2025):</strong> El lanzamiento de NU+ por parte de Nubank gener√≥ comparaciones directas en redes sociales, con usuarios evaluando qu√© programa de lealtad ofrec√≠a mejor valor.</li>
            <li><strong>Promotor Clave:</strong> La log√≠stica (env√≠os r√°pidos y gratis) sigue siendo el pilar de la propuesta de valor y el principal motivo de comentarios positivos recurrentes.</li>
          </ul>
          <blockquote>
            <p>"De qu√© sirve Meli+ en Hot Sale si mi paquete lleva una semana sin moverse. P√©simo servicio." (Queja en Apestan.com)</p>
          </blockquote>`
      },
      "Chile": {
        "sentimentIndex": [65, 68, 70, 72, 70, 71, 73, 80, 78, 77, 75, 76, 74, 75],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25", "Oct 25"],
        "events": [
          { "month": "Abr 25", "text": "Nuevos beneficios Meli+" }
        ],
        "table": [
          { "mes": "Oct 25", "detractores": "Bajo", "motivosDet": "Pocas cuotas sin inter√©s", "promotores": "Alto", "motivosPro": "Env√≠os a regiones", "eventos": "N/A", "competencia": "Falabella con CyberMonday" },
          { "mes": "Abr 25", "detractores": "Muy Bajo", "motivosDet": "Comunicaci√≥n confusa", "promotores": "Muy Alto", "motivosPro": "Nuevos beneficios", "eventos": "Adici√≥n de nuevos beneficios locales", "competencia": "Ripley con descuentos CMR" }
        ],
        "summary": `<h4>Principales Hallazgos en Chile</h4>
          <ul>
            <li><strong>Pico de Sentimiento (Abril 2025):</strong> La adici√≥n de beneficios locales (descuentos en comercios, etc.) fue muy bien recibida, llevando el √≠ndice a su punto m√°s alto del per√≠odo.</li>
            <li><strong>Factor Competitivo:</strong> Las campa√±as de Falabella y Ripley con descuentos CMR son mencionadas frecuentemente como alternativa, especialmente en lo que respecta a financiamiento (cuotas).</li>
          </ul>
          <blockquote>
            <p>"Los nuevos descuentos en farmacias con Meli+ hacen que la suscripci√≥n se pague sola. ¬°Buena jugada!" (Comentario en X)</p>
          </blockquote>`
      },
      "Argentina": {
        "sentimentIndex": [0, 0, 0, 0, 0, 0, 0, 0, 68, 72, 70, 68, 65, 66],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25", "Oct 25"],
        "events": [
          { "month": "May 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "Oct 25", "detractores": "Medio", "motivosDet": "Costo de suscripci√≥n", "promotores": "Medio", "motivosPro": "Env√≠os gratis", "eventos": "Contexto inflacionario", "competencia": "NaranjaX y Ual√° con promociones" },
          { "mes": "May 25", "detractores": "Medio", "motivosDet": "Confusi√≥n migraci√≥n Nivel 6", "promotores": "Alto", "motivosPro": "Acceso a Disney+/Max", "eventos": "Lanzamiento de Meli+ reemplazando Nivel 6", "competencia": "N/A" }
        ],
        "summary": `<h4>Principales Hallazgos en Argentina</h4>
          <ul>
            <li><strong>Lanzamiento (Mayo 2025):</strong> La transici√≥n de Nivel 6 a Meli+ gener√≥ confusi√≥n inicial, pero el valor percibido por el paquete de streaming fue el principal impulsor de la adopci√≥n.</li>
            <li><strong>Sensibilidad al Precio:</strong> El costo mensual de la suscripci√≥n es el principal detractor, con usuarios evaluando constantemente el costo-beneficio en un contexto de alta inflaci√≥n.</li>
          </ul>
          <blockquote>
            <p>"No entend√≠ bien el cambio de Nivel 6 a Meli+, pero mientras siga teniendo Disney y env√≠os gratis, me sirve. Aunque cada mes duele m√°s pagarlo." (Usuario en foro)</p>
          </blockquote>`
      },
      "Colombia": {
        "sentimentIndex": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 70, 73, 71],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25", "Sep 25", "Oct 25"],
        "events": [
          { "month": "May 25", "text": "Amazon Prime llega a CO" },
          { "month": "Ago 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "Oct 25", "detractores": "Bajo", "motivosDet": "Falta de beneficios locales", "promotores": "Alto", "motivosPro": "Env√≠os r√°pidos", "eventos": "N/A", "competencia": "Rappi Pro con ofertas agresivas" },
          { "mes": "Ago 25", "detractores": "Medio", "motivosDet": "Comparaci√≥n con Amazon Prime", "promotores": "Alto", "motivosPro": "Paquete de streaming", "eventos": "Lanzamiento de Meli+", "competencia": "Amazon Prime ya establecido" }
        ],
        "summary": `<h4>Principales Hallazgos en Colombia</h4>
          <ul>
            <li><strong>Lanzamiento Tard√≠o (Agosto 2025):</strong> Meli+ entr√≥ en un mercado donde Amazon Prime ya estaba operativo, llevando a comparaciones directas desde el d√≠a uno. El paquete de streaming fue el diferenciador clave.</li>
            <li><strong>Competencia Feroz:</strong> La competencia con Rappi Pro y Amazon Prime es intensa. Los usuarios mencionan activamente las ofertas y beneficios de los tres servicios para decidir cu√°l mantener.</li>
          </ul>
          <blockquote>
            <p>"Meli+ est√° bueno por Disney, pero Rappi me da descuentos en todo y Amazon a veces entrega m√°s r√°pido. Est√° dif√≠cil la decisi√≥n." (Comentario en TikTok)</p>
          </blockquote>`
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      {
        "id": 1, "entity": "Netflix", "country": "Todos los Pa√≠ses", "impact": "Alto",
        "title": "Netflix to Increase Prices on Ad-Free Plans in Key Markets Including US, UK, and France",
        "url": "https://ir.netflix.net/news/news-details/2025/Netflix-to-Increase-Prices-on-Ad-Free-Plans/default.aspx",
        "date": "23-10-2025", "category": "Cambio de Precio",
        "summary": "Netflix anunci√≥ un aumento en sus planes B√°sico y Premium sin anuncios en varios mercados clave, efectivo para nuevos miembros inmediatamente y para miembros existentes en el pr√≥ximo ciclo de facturaci√≥n. El plan con anuncios no se ver√° afectado.",
        "analysis": "Impacto ALTO. Afecta directamente la retenci√≥n de suscriptores y el ARPU. Podr√≠a generar una migraci√≥n hacia el plan con anuncios o una p√©rdida de clientes hacia competidores. Monitorear sentimiento post-anuncio."
      },
      {
        "id": 2, "entity": "Amazon Prime", "country": "M√©xico", "impact": "Medio",
        "title": "Amazon Expands Same-Day Delivery to Five New Cities in Mexico",
        "url": "https://www.aboutamazon.com/news/operations/amazon-expands-same-day-delivery-mexico",
        "date": "20-10-2025", "category": "Estrategia",
        "summary": "Amazon M√©xico ha ampliado su servicio de entrega el mismo d√≠a a las ciudades de Guadalajara, Monterrey, Puebla, Quer√©taro y M√©rida, fortaleciendo su promesa log√≠stica de cara a la temporada de fin de a√±o.",
        "analysis": "Impacto MEDIO. Aumenta la presi√≥n competitiva sobre la log√≠stica de Meli en ciudades clave. Refuerza la propuesta de valor de Amazon Prime en el pilar de la conveniencia."
      },
      {
        "id": 3, "entity": "Rappi Pro", "country": "Brasil", "impact": "Medio",
        "title": "Rappi and Ita√∫ Unibanco Announce Strategic Partnership for Rappi Pro Benefits",
        "url": "https://blog.rappi.com/rappi-e-itau-anunciam-parceria",
        "date": "16-10-2025", "category": "Estrategia",
        "summary": "Rappi Brasil y el banco Ita√∫ Unibanco formaron una alianza para ofrecer meses de suscripci√≥n gratuita a Rappi Pro y descuentos exclusivos a clientes de tarjetas de cr√©dito Ita√∫.",
        "analysis": "Impacto MEDIO. Alianza que busca atar al cliente a trav√©s de beneficios cruzados, compitiendo con la estrategia de ecosistema de Meli. Puede atraer a un segmento de clientes bancarizados de alto valor."
      },
      {
        "id": 4, "entity": "Shein", "country": "Brasil", "impact": "Medio",
        "title": "Shein Inaugurates First of Five Planned Pop-Up Stores in Brazil",
        "url": "https://www.reuters.com/business/retail-consumer/shein-opens-first-brazilian-pop-up-ahead-physical-store-push-2025-10-14/",
        "date": "14-10-2025", "category": "Estrategia",
        "summary": "Shein abri√≥ su primera tienda f√≠sica temporal (pop-up) en S√£o Paulo, como parte de su estrategia para expandir su presencia omnicanal en el mercado brasile√±o y aumentar la confianza del consumidor.",
        "analysis": "Impacto MEDIO. Movimiento de un competidor digital puro hacia el retail f√≠sico, buscando capturar un nuevo segmento de mercado y generar confianza. Podr√≠a presionar a marketplaces locales."
      }
    ];
    const contentNewsData = [
      {
        "id": 101, "entity": "Spotify", "country": "Todos los Pa√≠ses", "impact": "Alto",
        "title": "Spotify Reports Strong Q3 2025 Results, Exceeding Subscriber and Revenue Forecasts",
        "url": "https://investors.spotify.com/press/2025/q3-2025-update/",
        "date": "26-10-2025", "category": "Resultados Financieros",
        "summary": "Spotify anunci√≥ sus resultados del tercer trimestre de 2025, superando las expectativas de los analistas en crecimiento de suscriptores Premium y ingresos. La compa√±√≠a cit√≥ la fortaleza en Am√©rica Latina y el √©xito de su expansi√≥n en audiolibros.",
        "analysis": "Se√±al positiva para el mercado de suscripciones de audio. La fortaleza en LATAM indica un mercado receptivo y en crecimiento, relevante para la estrategia de Meli+."
      },
      {
        "id": 102, "entity": "Max", "country": "Todos los Pa√≠ses", "impact": "Medio",
        "title": "Warner Bros. Discovery Names New Head of Streaming Product and Design",
        "url": "https://wbd.com/newsroom/press-releases/2025/wbd-names-new-head-of-streaming-product/",
        "date": "24-10-2025", "category": "Estrategia",
        "summary": "Warner Bros. Discovery ha nombrado a un ex-ejecutivo de Netflix como su nuevo Vicepresidente Senior de Producto y Dise√±o para su plataforma de streaming Max, con el objetivo de mejorar la experiencia de usuario y el descubrimiento de contenido.",
        "analysis": "Movimiento ejecutivo clave que indica un enfoque renovado en la usabilidad de la plataforma Max, uno de los beneficios incluidos en Meli+. Mejoras en Max podr√≠an fortalecer indirectamente la propuesta de valor de Meli+."
      },
      {
        "id": 103, "entity": "OpenAI", "country": "Todos los Pa√≠ses", "impact": "Alto",
        "title": "OpenAI Begins Phased Rollout of New 'Scribe' Model with Advanced Multilingual Capabilities in API",
        "url": "https://openai.com/blog/introducing-scribe-model",
        "date": "22-10-2025", "category": "Flagship AI",
        "summary": "OpenAI anunci√≥ el inicio del despliegue de 'Scribe', un nuevo modelo de lenguaje con capacidades mejoradas de traducci√≥n, resumen y generaci√≥n en idiomas de bajo recurso, disponible para clientes empresariales a trav√©s de su API.",
        "analysis": "Lanzamiento de un modelo de IA de pr√≥xima generaci√≥n. Impacto ALTO por su potencial para crear nuevas aplicaciones y servicios. Relevante para las capacidades de IA internas de Meli."
      },
      {
        "id": 104, "entity": "Disney+", "country": "Todos los Pa√≠ses", "impact": "Medio",
        "title": "Disney Confirms Live-Action 'Hercules' and 'Moana 2' for 2026 Theatrical and Streaming Release Windows",
        "url": "https://www.thewaltdisneycompany.com/disney-confirms-release-windows-for-live-action-slate/",
        "date": "19-10-2025", "category": "Producto",
        "summary": "Durante una presentaci√≥n a inversores, Disney deline√≥ su calendario de lanzamientos para 2026, confirmando que las muy esperadas 'H√©rcules' (live-action) y 'Moana 2' tendr√°n estrenos en cines seguidos de una ventana exclusiva en Disney+.",
        "analysis": "Refuerza el pipeline de contenido exclusivo para Disney+, un componente clave de la oferta de Meli+. Asegura la llegada de contenido 'flagship' que puede impulsar la adquisici√≥n y retenci√≥n de suscriptores."
      },
      {
        "id": 105, "entity": "Apple TV+", "country": "Todos los Pa√≠ses", "impact": "Medio",
        "title": "Apple TV+ Renews Critically Acclaimed Sci-Fi Series 'Foundation' for a Fourth Season",
        "url": "https://www.apple.com/tv-pr/news/2025/10/apple-tv-renews-foundation-for-fourth-season/",
        "date": "15-10-2025", "category": "Producto",
        "summary": "Apple ha anunciado la renovaci√≥n de 'Foundation', una de sus series insignia de ciencia ficci√≥n, para una cuarta temporada, reafirmando su compromiso con producciones de gran presupuesto y alto perfil.",
        "analysis": "Muestra la estrategia de Apple de retener audiencias a trav√©s de la continuidad de su contenido m√°s popular y de alta calidad, compitiendo en el segmento premium del mercado de streaming."
      }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico','Todos los Pa√≠ses'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ual√°','Cablevisi√≥n Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico','Todos los Pa√≠ses'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gr√°fico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: '√çndice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '√çndice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><div class="flex flex-wrap gap-1">${row.motivosDet.split(',').map(m => `<span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${m.trim()}</span>`).join('')}</div></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><div class="flex flex-wrap gap-1">${row.motivosPro.split(',').map(m => `<span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${m.trim()}</span>`).join('')}</div></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categor√≠a ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanci√≥n Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusi√≥n/Adquisici√≥n': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const countryMatch = newsFilters.country.length === 0 || newsFilters.country.includes('Todos los Pa√≠ses') || newsFilters.country.includes(item.country) || item.country === "Todos los Pa√≠ses";
        const entityMatch = newsFilters.company.length === 0 || newsFilters.company.includes(item.entity);
        const categoryMatch = newsFilters.category.length === 0 || newsFilters.category.includes(item.category);
        return countryMatch && entityMatch && categoryMatch;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-lg transition-shadow duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg pr-2">${row.entity}${row.country && row.country !== 'Todos los Pa√≠ses' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const countryMatch = contentFilters.country.length === 0 || contentFilters.country.includes('Todos los Pa√≠ses') || contentFilters.country.includes(item.country) || item.country === "Todos los Pa√≠ses";
        const entityMatch = contentFilters.company.length === 0 || contentFilters.company.includes(item.entity);
        const categoryMatch = contentFilters.category.length === 0 || contentFilters.category.includes(item.category);
        return countryMatch && entityMatch && categoryMatch;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-lg transition-shadow duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg pr-2">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, groupName, handler) {
      container.innerHTML = allItems.sort().map(item => `
        <div class="filter-checkbox-item">
          <input type="checkbox" id="${groupName}-${item.replace(/\s+/g, '-')}" value="${item}" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
          <label for="${groupName}-${item.replace(/\s+/g, '-')}" class="ml-2 block text-sm text-gray-900">${item}</label>
        </div>
      `).join('');
      container.addEventListener('change', handler);
    }
    
    function createFilterHandler(filterObject, renderFunction, containerMap) {
      return function() {
        for (const [key, container] of Object.entries(containerMap)) {
            const selected = Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
            filterObject[key] = selected;
        }
        renderFunction();
      }
    }

    /* ==== Inicializaci√≥n ==== */
    document.addEventListener('DOMContentLoaded', () => {
      const newsHandler = createFilterHandler(newsFilters, renderNewsCards, {
          country: newsFilterCountryContainer,
          company: newsFilterCompanyContainer,
          category: newsFilterCategoryContainer
      });
      const contentHandler = createFilterHandler(contentFilters, renderContentNewsCards, {
          country: contentFilterCountryContainer,
          company: contentFilterCompanyContainer,
          category: contentFilterCategoryContainer
      });
      
      populateCheckboxes(newsFilterCountryContainer, [...new Set(newsData.map(n => n.country || 'Todos los Pa√≠ses'))], 'news-country', newsHandler);
      populateCheckboxes(newsFilterCompanyContainer, [...new Set(newsData.map(n => n.entity))], 'news-company', newsHandler);
      populateCheckboxes(newsFilterCategoryContainer, [...new Set(newsData.map(n => n.category))], 'news-category', newsHandler);

      populateCheckboxes(contentFilterCountryContainer, [...new Set(contentNewsData.map(n => n.country || 'Todos los Pa√≠ses'))], 'content-country', contentHandler);
      populateCheckboxes(contentFilterCompanyContainer, [...new Set(contentNewsData.map(n => n.entity))], 'content-company', contentHandler);
      populateCheckboxes(contentFilterCategoryContainer, [...new Set(contentNewsData.map(n => n.category))], 'content-category', contentHandler);

      tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
        tabButtons.forEach(b => b.classList.remove('active'));
        e.target.classList.add('active');
        updateSentimentContent(e.target.dataset.country);
      }));
      
      document.getElementById('news-reset-filters').addEventListener('click', () => {
          newsFilters = { country: [], company: [], category: [] };
          [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
              Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
          });
          renderNewsCards();
      });
      document.getElementById('content-reset-filters').addEventListener('click', () => {
          contentFilters = { country: [], company: [], category: [] };
          [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
              Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
          });
          renderContentNewsCards();
      });

      updateSentimentContent('Brasil');
      renderNewsCards();
      renderContentNewsCards();
    });
  </script>
</body>
</html>
