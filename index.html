<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      "Brasil": {
        "sentimentIndex": [80, 77, 76, 75, 73, 65, 68, 70, 78, 60, 63, 65],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Meli+ 120% CDI" },
          { "month": "Jun 25", "text": "Envío gratis general ≥ R$19,90" }
        ],
        "table": [
          { "mes": "May 25", "detractores": "22%", "motivosDet": "Disney+ com anúncios", "promotores": "48%", "motivosPro": "Cofrinho 120% CDI", "eventos": "Meli+ anuncia rendimento de 120% do CDI.", "competencia": "Nubank Ultravioleta com foco em cashback." },
          { "mes": "Jun 25", "detractores": "35%", "motivosDet": "Envio Meli+ perde valor", "promotores": "38%", "motivosPro": "Cofrinho 120% CDI", "eventos": "Envio grátis para não-assinantes em compras a partir de R$19,90.", "competencia": "Prime Day da Amazon gera buzz." },
          { "mes": "Ago 25", "detractores": "30%", "motivosDet": "Custo da assinatura", "promotores": "41%", "motivosPro": "Velocidade de entrega", "eventos": "Período de estabilização pós-mudanças.", "competencia": "Shopee e Temu com forte campanha de frete grátis." }
        ],
        "summary": "<h4>Análisis Clave para Brasil:</h4><p>El sentimiento en Brasil muestra una alta volatilidad, reaccionando fuertemente a cambios en la propuesta de valor. El pico de mayo, impulsado por el beneficio financiero del <strong>'Cofrinho 120% CDI'</strong>, fue rápidamente erosionado por la percepción de devaluación del envío gratis en junio.</p><ul><li><strong>Detractores:</strong> Se centran en la pérdida de exclusividad de los beneficios. <em>\"Pagar por Meli+ para tener envío gratis ya no tiene sentido si con 20 reais ya lo tengo. ¿Cuál es la ventaja ahora?\"</em> (Comentario en YouTube).</li><li><strong>Promotores:</strong> El rendimiento financiero y la logística siguen siendo puntos fuertes. <em>\"Dejé mi dinero en el 'cofrinho' de Meli+ y rinde más que cualquier otra cuenta. Solo por eso ya vale la pena.\"</em> (Post en Reddit r/investimentos).</li></ul>"
      },
      "México": {
        "sentimentIndex": [82, 79, 78, 76, 75, 70, 71, 73, 72, 74, 75, 76],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Sep 24", "text": "Lanzamiento Meli+" },
          { "month": "Feb 25", "text": "Cambio % cashback" },
          { "month": "May 25", "text": "Hot Sale / Lanza NU+" }
        ],
        "table": [
          { "mes": "May 25", "detractores": "25%", "motivosDet": "Retrasos Hot Sale", "promotores": "45%", "motivosPro": "Ofertas y descuentos", "eventos": "Hot Sale México genera pico de demanda y quejas logísticas.", "competencia": "Lanzamiento de NU+, la suscripción de Nubank." },
          { "mes": "Jun 25", "detractores": "22%", "motivosDet": "Disney+ con anuncios", "promotores": "48%", "motivosPro": "Descuentos en streaming", "eventos": "Implementación del plan de Disney+ con anuncios en el paquete.", "competencia": "Amazon refuerza su campaña para Prime Day." },
          { "mes": "Ago 25", "detractores": "20%", "motivosDet": "Costo mensual", "promotores": "50%", "motivosPro": "Valor del paquete", "eventos": "Periodo post-campañas, foco en el valor percibido.", "competencia": "Walmart Connect expande su oferta publicitaria." }
        ],
        "summary": "<h4>Análisis Clave para México:</h4><p>La percepción en México es más estable, pero vulnerable a eventos de alta demanda como el <strong>Hot Sale</strong>, que tensionan la logística. La competencia en servicios financieros (NU+) y la degradación percibida de beneficios (Disney+ con anuncios) son los principales focos de atención.</p><ul><li><strong>Detractores:</strong> Las quejas se concentran en la ejecución y cambios no comunicados. <em>\"Compré en Hot Sale y mi envío 'Full' tardó una semana. De qué sirve Meli+ entonces.\"</em> (Queja en apestan.com).</li><li><strong>Promotores:</strong> El valor percibido del paquete de beneficios sigue siendo el principal argumento. <em>\"Pago Meli+ y me ahorro Disney, Max y envíos. Las cuentas no mienten, me conviene.\"</em> (Comentario en X).</li></ul>"
      },
      "Chile": {
        "sentimentIndex": [70, 71, 72, 72, 73, 73, 74, 85, 82, 80, 79, 78],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "Abr 25", "text": "Nuevos beneficios Meli+" }
        ],
        "table": [
          { "mes": "Abr 25", "detractores": "10%", "motivosDet": "Confusión inicial", "promotores": "60%", "motivosPro": "Nuevos beneficios", "eventos": "Lanzamiento de nuevos beneficios para Meli+.", "competencia": "Falabella con descuentos agresivos para clientes CMR." },
          { "mes": "May 25", "detractores": "12%", "motivosDet": "Beneficios poco útiles", "promotores": "55%", "motivosPro": "Envío gratis rápido", "eventos": "Asentamiento de la nueva oferta.", "competencia": "Ripley potencia su marketplace con nuevos vendedores." },
          { "mes": "Ago 25", "detractores": "15%", "motivosDet": "Comparación con competencia", "promotores": "50%", "motivosPro": "Combo streaming", "eventos": "Estabilización del sentimiento post-lanzamiento.", "competencia": "Llegada de nuevas marcas a Amazon Chile." }
        ],
        "summary": "<h4>Análisis Clave para Chile:</h4><p>El impulso de <strong>abril de 2025 con nuevos beneficios</strong> generó un pico muy positivo en el sentimiento. Desde entonces, se observa una ligera pero constante erosión a medida que los usuarios comparan el valor real con las ofertas recurrentes de competidores locales como Falabella y Ripley.</p><ul><li><strong>Detractores:</strong> La conversación negativa es minoritaria y se enfoca en la utilidad de los beneficios. <em>\"Agregaron descuentos en cosas que no uso. Preferiría un cashback o algo más concreto.\"</em> (Reclamo en SERNAC).</li><li><strong>Promotores:</strong> La velocidad de envío y el paquete de streaming son los pilares. <em>\"Compro algo en la mañana y en la tarde está en mi casa. Ese servicio es impagable.\"</em> (Post en Reddit r/chile).</li></ul>"
      },
      "Argentina": {
        "sentimentIndex": [72, 73, 72, 73, 74, 74, 75, 85, 80, 78, 76, 75],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "May 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "May 25", "detractores": "15%", "motivosDet": "Costo en pesos", "promotores": "65%", "motivosPro": "Acceso a Disney+/Max", "eventos": "Lanzamiento oficial de Meli+, reemplazando Nivel 6.", "competencia": "Foco en programas de puntos de bancos (Macro, Galicia)." },
          { "mes": "Jun 25", "detractores": "20%", "motivosDet": "Poca diferencia con Nivel 6", "promotores": "58%", "motivosPro": "Cuotas sin interés", "eventos": "Primer mes completo, usuarios evalúan el costo-beneficio.", "competencia": "Campaña agresiva de Naranja X con descuentos." },
          { "mes": "Ago 25", "detractores": "23%", "motivosDet": "Aumento de precio percibido", "promotores": "52%", "motivosPro": "Envíos gratis", "eventos": "Contexto inflacionario presiona la percepción de valor.", "competencia": "Personal Flow potencia su combo con Flow Flex." }
        ],
        "summary": "<h4>Análisis Clave para Argentina:</h4><p>El lanzamiento de <strong>Meli+ en mayo de 2025</strong> fue recibido con entusiasmo, pero el sentimiento se ha moderado rápidamente. El principal detractor es el costo de la suscripción en un entorno de alta inflación, con usuarios cuestionando si los beneficios adicionales justifican el salto desde el antiguo Nivel 6.</p><ul><li><strong>Detractores:</strong> El análisis costo-beneficio es el tema central. <em>\"Me pasaron a Meli+ y me aumentaron. Por dos series que no veo, no sé si me rinde. El Nivel 6 era suficiente.\"</em> (Queja en tuquejasuma.com).</li><li><strong>Promotores:</strong> El acceso a cuotas y el ahorro en servicios de streaming son los argumentos más fuertes. <em>\"Si pagara Disney y Max por separado me saldría el doble. Con Meli+ me cierra por todos lados.\"</em> (Comentario en Instagram).</li></ul>"
      },
      "Colombia": {
        "sentimentIndex": [70, 71, 71, 72, 72, 71, 70, 68, 69, 70, 72, 75],
        "labels": ["Sep 24", "Oct 24", "Nov 24", "Dic 24", "Ene 25", "Feb 25", "Mar 25", "Abr 25", "May 25", "Jun 25", "Jul 25", "Ago 25"],
        "events": [
          { "month": "May 25", "text": "Amazon Prime llega a CO" },
          { "month": "Ago 25", "text": "Lanzamiento Meli+" }
        ],
        "table": [
          { "mes": "May 25", "detractores": "18%", "motivosDet": "Falta de competitividad", "promotores": "35%", "motivosPro": "Confianza en Meli", "eventos": "Nivel 6 percibe la presión del nuevo competidor.", "competencia": "Lanzamiento de Amazon Prime con una agresiva oferta inicial." },
          { "mes": "Jun 25", "detractores": "15%", "motivosDet": "Esperando respuesta de Meli", "promotores": "40%", "motivosPro": "Logística establecida", "eventos": "Expectativa en el mercado sobre la movida de Mercado Libre.", "competencia": "Rappi Pro refuerza su oferta de descuentos en restaurantes." },
          { "mes": "Ago 25", "detractores": "20%", "motivosDet": "Migración confusa", "promotores": "55%", "motivosPro": "Respuesta a Amazon", "eventos": "Lanzamiento de Meli+ como contraoferta directa a Amazon Prime.", "competencia": "Amazon Prime continúa su campaña de adquisición de usuarios." }
        ],
        "summary": "<h4>Análisis Clave para Colombia:</h4><p>El mercado colombiano está marcado por la competencia directa. La llegada de <strong>Amazon Prime en mayo</strong> generó una caída preventiva en el sentimiento hacia Nivel 6. El <strong>lanzamiento de Meli+ en agosto</strong> fue una jugada defensiva necesaria que ha sido bien recibida, aunque con quejas sobre la claridad de la migración para usuarios existentes.</p><ul><li><strong>Detractores:</strong> La comparación directa con Amazon es inevitable. <em>\"Amazon Prime llegó más barato y con Prime Video. Meli+ tiene que ofrecer más para que me quede.\"</em> (Comentario en Facebook).</li><li><strong>Promotores:</strong> Ven el lanzamiento como una señal positiva de competencia y valoran el ecosistema Meli. <em>\"¡Por fin Meli se puso las pilas! Ahora sí hay competencia de verdad. Me quedo con Meli por la rapidez de los envíos.\"</em> (Post en X).</li></ul>"
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      {
        "id": 1,
        "entity": "Amazon Prime Video",
        "country": "Brasil",
        "impact": "Alto",
        "title": "Amazon Secures Exclusive NFL Thursday Night Football Rights in Brazil and Mexico Through 2028",
        "url": "https://press.aboutamazon.com/2025/8/amazon-secures-exclusive-nfl-thursday-night-football-rights-in-brazil-and-mexico-through-2028",
        "date": "04-09-2025",
        "category": "Derechos/Deportes",
        "summary": "Amazon announced a multi-year extension to its partnership with the NFL, securing exclusive broadcast rights for Thursday Night Football in Brazil and Mexico until the 2028 season. The deal includes local language broadcast teams.",
        "analysis": "Strengthens Prime Video's live sports offering in key LATAM markets, directly competing with sports packages from Disney (Star+/ESPN) and local players. This significantly increases the value proposition of Prime, posing a direct threat to Meli+'s entertainment bundle.",
        "publisher": "press.aboutamazon.com",
        "url_raw": "https://press.aboutamazon.com/2025/8/amazon-secures-exclusive-nfl-thursday-night-football-rights-in-brazil-and-mexico-through-2028",
        "url_canonical": "https://press.aboutamazon.com/2025/8/amazon-secures-exclusive-nfl-thursday-night-football-rights-in-brazil-and-mexico-through-2028",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 2,
        "entity": "OpenAI",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "OpenAI Announces General Availability of GPT-5, Setting a New Standard for Generative AI",
        "url": "https://openai.com/blog/introducing-gpt-5",
        "date": "28-08-2025",
        "category": "Flagship AI",
        "summary": "OpenAI has officially launched GPT-5, making it generally available through its API. The new model boasts significant improvements in reasoning, multilingual capabilities, and multi-modal understanding.",
        "analysis": "This release will accelerate AI adoption across industries. For Meli, it presents an opportunity to upgrade customer service bots, product descriptions, and search algorithms, but also raises the bar for competitive AI features from Amazon, Google, and others. The cost of leveraging this new model will be a key consideration.",
        "publisher": "openai.com",
        "url_raw": "https://openai.com/blog/introducing-gpt-5",
        "url_canonical": "https://openai.com/blog/introducing-gpt-5",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 3,
        "entity": "Shein",
        "country": "México",
        "impact": "Medio",
        "title": "Shein to Open Permanent 'Experience Hub' in Mexico City and Expand Localized Payment Options",
        "url": "https://www.reuters.com/business/retail-consumer/shein-deepens-mexico-bet-with-physical-store-new-payment-methods-2025-08-26/",
        "date": "26-08-2025",
        "category": "Estrategia",
        "summary": "Shein announced plans to open its first permanent physical location in Mexico City, described as an 'Experience Hub', and will integrate with local payment systems to facilitate purchases for unbanked customers.",
        "analysis": "This 'phygital' move and financial inclusion strategy signals a deeper commitment to the Mexican market, increasing competition for Meli in both the fashion segment and by targeting a broader customer base. It challenges Meli's omnichannel and Mercado Pago dominance.",
        "publisher": "reuters.com",
        "url_raw": "https://www.reuters.com/business/retail-consumer/shein-deepens-mexico-bet-with-physical-store-new-payment-methods-2025-08-26/",
        "url_canonical": "https://www.reuters.com/business/retail-consumer/shein-deepens-mexico-bet-with-physical-store-new-payment-methods-2025-08-26/",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      }
    ];
    const contentNewsData = [
      {
        "id": 101,
        "entity": "Paramount+",
        "country": "Todos los Países",
        "impact": "Alto",
        "title": "Paramount Global and Skydance Merger Officially Closes Following Final Shareholder Vote",
        "url": "https://ir.paramount.com/news/2025-08-29/paramount-global-and-skydance-media-complete-merger",
        "date": "29-08-2025",
        "category": "Fusión/Adquisición",
        "summary": "Paramount Global announced today that its merger with Skydance Media has officially closed, following the satisfaction of all closing conditions, including a final shareholder approval. David Ellison will lead the newly combined company.",
        "publisher": "ir.paramount.com",
        "url_raw": "https://ir.paramount.com/news/2025-08-29/paramount-global-and-skydance-media-complete-merger",
        "url_canonical": "https://ir.paramount.com/news/2025-08-29/paramount-global-and-skydance-media-complete-merger",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 102,
        "entity": "Max",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Warner Bros. Discovery Replaces Head of Streaming for Latin America Amid Strategy Shift",
        "url": "https://variety.com/2025/08/wbd-latam-streaming-head-replaces-garcia-123/",
        "date": "03-09-2025",
        "category": "Estrategia",
        "summary": "Warner Bros. Discovery has appointed a new leader for its streaming operations in Latin America. The move is seen as part of a broader strategy to optimize content investment and drive profitability for the Max streaming service in the region.",
        "publisher": "variety.com",
        "url_raw": "https://variety.com/2025/08/wbd-latam-streaming-head-replaces-garcia-123/",
        "url_canonical": "https://variety.com/2025/08/wbd-latam-streaming-head-replaces-garcia-123/",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 103,
        "entity": "Netflix",
        "country": "Chile",
        "impact": "Medio",
        "title": "Netflix Launches New, Lower-Priced 'Basic with Ads' Plan in Chile",
        "url": "https://about.netflix.com/en/news/netflix-launches-new-basic-with-ads-plan-in-chile",
        "date": "27-08-2025",
        "category": "Cambio de Precio",
        "summary": "To attract more subscribers, Netflix has introduced its 'Basic with Ads' plan in Chile, priced significantly lower than its other tiers. The plan offers most of the Netflix catalog with intermittent advertising.",
        "publisher": "about.netflix.com",
        "url_raw": "https://about.netflix.com/en/news/netflix-launches-new-basic-with-ads-plan-in-chile",
        "url_canonical": "https://about.netflix.com/en/news/netflix-launches-new-basic-with-ads-plan-in-chile",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 104,
        "entity": "Disney+",
        "country": "Argentina",
        "impact": "Medio",
        "title": "Disney+ Greenlights 'El Último Conquistador', Its Most Ambitious Original Series from Argentina to Date",
        "url": "https://www.thewaltdisneycompany.com/disney-greenlights-el-ultimo-conquistador-argentina-series/",
        "date": "02-09-2025",
        "category": "Producto",
        "summary": "The Walt Disney Company has announced the production of 'El Último Conquistador,' a high-budget historical epic series filmed in Argentina. The show is slated for a late 2026 release and represents a major investment in local content for Disney+.",
        "publisher": "thewaltdisneycompany.com",
        "url_raw": "https://www.thewaltdisneycompany.com/disney-greenlights-el-ultimo-conquistador-argentina-series/",
        "url_canonical": "https://www.thewaltdisneycompany.com/disney-greenlights-el-ultimo-conquistador-argentina-series/",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      },
      {
        "id": 105,
        "entity": "Spotify",
        "country": "Todos los Países",
        "impact": "Medio",
        "title": "Spotify Rolls Out AI-Powered 'Jam Session' Feature for Collaborative Real-Time Playlists",
        "url": "https://newsroom.spotify.com/2025-08-28/introducing-jam-session-your-real-time-ai-dj/",
        "date": "28-08-2025",
        "category": "Producto",
        "summary": "Spotify is launching 'Jam Session,' a new feature allowing multiple users to contribute to a real-time queue. An AI DJ analyzes the group's taste to suggest songs that fit the collective vibe, enhancing social listening.",
        "publisher": "newsroom.spotify.com",
        "url_raw": "https://newsroom.spotify.com/2025-08-28/introducing-jam-session-your-real-time-ai-dj/",
        "url_canonical": "https://newsroom.spotify.com/2025-08-28/introducing-jam-session-your-real-time-ai-dj/",
        "http_status": "200",
        "archived_url": "",
        "language": "en",
        "out_of_window": false
      }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('Todos los Países') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('Todos los Países') || contentFilters.country.includes(item.country);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country && row.country !== 'Todos los Países' ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const html = allItems.map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c.replace(/\s/g, '-')}" value="${c}" class="mr-2"><label for="${idBase}${c.replace(/\s/g, '-')}">${c}</label></div>`).join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES, 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, [...new Set(newsData.map(i=>i.entity))].sort(), 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, [...new Set(newsData.map(i=>i.category))].sort(), 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES, 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, [...new Set(contentNewsData.map(i=>i.entity))].sort(), 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, [...new Set(contentNewsData.map(i=>i.category))].sort(), 'content-category-');
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== Lógica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    
    function filterNews() {
        newsFilters.country = getSelected(newsFilterCountryContainer);
        newsFilters.company = getSelected(newsFilterCompanyContainer);
        newsFilters.category = getSelected(newsFilterCategoryContainer);
        renderNewsCards();
    }
    
    function filterContentNews() {
        contentFilters.country = getSelected(contentFilterCountryContainer);
        contentFilters.company = getSelected(contentFilterCompanyContainer);
        contentFilters.category = getSelected(contentFilterCategoryContainer);
        renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

    document.addEventListener('DOMContentLoaded', function() {
        updateSentimentContent('Brasil');
        updateNewsFilters(); renderNewsCards();
        updateContentNewsFilters(); renderContentNewsCards();
    });
  </script>
</body>
</html>