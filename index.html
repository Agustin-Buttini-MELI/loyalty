<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Análisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evolución de la percepción de los clientes en función de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Índice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="México" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">México</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por País: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualización interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      'Brasil': {
        sentimentIndex: [75, 72, 70, 74, 71, 60, 62, 65, 70, 45, 48, 50],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25'],
        events: [
          { month: 'Sep 24', text: 'Lanzamiento Meli+' },
          { month: 'Feb 25', text: 'Cambio % cashback' },
          { month: 'May 25', text: 'Meli+ 120% CDI' },
          { month: 'Jun 25', text: 'Cambio umbral envío gratis' }
        ],
        table: [
          { mes: 'Jun 25', detractores: 'Alto', motivosDet: 'Valor percibido', promotores: 'Bajo', motivosPro: 'Beneficios existentes', eventos: 'Envío gratis general ≥ R$19,90', competencia: 'Amazon Prime Day (preparación)' },
          { mes: 'May 25', detractores: 'Bajo', motivosDet: 'Comparación con competidores', promotores: 'Alto', motivosPro: 'Beneficios financieros', eventos: 'Meli+ ofrece 120% CDI en "Cofrinhos"', competencia: 'Nubank anuncia NU+' },
          { mes: 'Feb 25', detractores: 'Alto', motivosDet: 'Cambio en beneficios', promotores: 'Medio', motivosPro: 'Streaming y envíos', eventos: 'Reducción del % de cashback en compras', competencia: 'Shopee intensifica cupones de envío' }
        ],
        summary: `
          <h4 class="font-semibold text-rose-700">Principales Quejas</h4>
          <ul>
            <li>La percepción del valor de Meli+ se desplomó en junio tras el cambio en la política de envíos gratis, volviéndola similar a la de no suscriptores. 
              <blockquote>"Pagar Meli+ para que o frete grátis seja o mesmo de antes? Não faz sentido. Cancelei na hora." <span class="text-sm text-gray-500">(Reclame Aqui)</span></blockquote>
            </li>
            <li>El cambio en el porcentaje de cashback en febrero fue un detractor significativo, generando descontento en usuarios que calculaban el retorno de la suscripción.</li>
          </ul>
          <h4 class="font-semibold text-emerald-700 mt-4">Principales Elogios</h4>
          <ul>
            <li>El beneficio financiero de 120% CDI en "Cofrinhos" (mayo) fue muy bien recibido, atrayendo a un segmento de usuarios enfocado en rendimientos.
              <blockquote>"O rendimento de 120% no Cofrinho é um diferencial enorme. Paga a assinatura sozinho." <span class="text-sm text-gray-500">(Comentario en YouTube)</span></blockquote>
            </li>
          </ul>`
      },
      'México': {
        sentimentIndex: [78, 80, 79, 82, 80, 68, 70, 71, 72, 74, 70, 71],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25'],
        events: [
          { month: 'Sep 24', text: 'Lanzamiento Meli+' },
          { month: 'Feb 25', text: 'Cambio % cashback' },
          { month: 'May 25', text: 'Hot Sale MX / Lanza NU+' }
        ],
        table: [
          { mes: 'May 25', detractores: 'Medio', motivosDet: 'Competencia / UI', promotores: 'Alto', motivosPro: 'Logística y descuentos', eventos: 'Hot Sale México', competencia: 'Lanzamiento de NU+ por Nubank' },
          { mes: 'Feb 25', detractores: 'Alto', motivosDet: 'Cambio en beneficios', promotores: 'Medio', motivosPro: 'Servicios de streaming', eventos: 'Ajuste en el cashback de Meli+', competencia: 'Amazon refuerza ofertas Prime' },
          { mes: 'Sep 24', detractores: 'Bajo', motivosDet: 'Confusión inicial', promotores: 'Muy Alto', motivosPro: 'Propuesta de valor', eventos: 'Lanzamiento de Meli+ en México', competencia: 'Walmart Pass y Amazon Prime activos' }
        ],
        summary: `
          <h4 class="font-semibold text-rose-700">Principales Quejas</h4>
          <ul>
            <li>La reducción del cashback en febrero generó críticas, aunque con menor intensidad que en Brasil. Usuarios mencionan que "le quita atractivo" frente a otras suscripciones.</li>
            <li>Durante el Hot Sale, surgieron quejas sobre la comunicación de ofertas exclusivas Meli+, con algunos usuarios sintiendo que no eran suficientemente diferenciadas.</li>
          </ul>
          <h4 class="font-semibold text-emerald-700 mt-4">Principales Elogios</h4>
          <ul>
            <li>La velocidad de entrega durante eventos de alta demanda como el Hot Sale es el principal motor de promotores.
              <blockquote>"Compré varias cosas en el Hot Sale con Meli+ y todo me llegó al día siguiente, increíble servicio." <span class="text-sm text-gray-500">(Twitter/X)</span></blockquote>
            </li>
            <li>El paquete de streaming (Disney+/Star+) sigue siendo un pilar de la propuesta de valor.
              <blockquote>"Pago Meli+ más que nada por D+ y los envíos son un extra. Me súper conviene." <span class="text-sm text-gray-500">(Reddit)</span></blockquote>
            </li>
          </ul>`
      },
      'Chile': {
        sentimentIndex: [70, 72, 71, 74, 73, 75, 78, 85, 83, 81, 80, 79],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25'],
        events: [
          { month: 'Abr 25', text: 'Nuevos beneficios Meli+ CL' }
        ],
        table: [
          { mes: 'Abr 25', detractores: 'Bajo', motivosDet: 'Costo de suscripción', promotores: 'Muy Alto', motivosPro: 'Nuevos beneficios', eventos: 'Anuncio de descuentos en Max y Universal+', competencia: 'Falabella con descuentos agresivos CMR' },
          { mes: 'Ene 25', detractores: 'Medio', motivosDet: 'Comparación con retail', promotores: 'Medio', motivosPro: 'Envíos gratis', eventos: 'Temporada de verano, alta demanda', competencia: 'Ripley y Falabella con promociones de temporada' }
        ],
        summary: `
          <h4 class="font-semibold text-rose-700">Principales Quejas</h4>
          <ul>
            <li>La competencia con los beneficios de las tarjetas de crédito de grandes retailers (Falabella, Ripley) es una constante.
              <blockquote>"A veces con la tarjeta CMR me sale más a cuenta comprar en Falabella, aunque no tenga el envío tan rápido." <span class="text-sm text-gray-500">(Foro en Chw.net)</span></blockquote>
            </li>
          </ul>
          <h4 class="font-semibold text-emerald-700 mt-4">Principales Elogios</h4>
          <ul>
            <li>La adición de nuevos beneficios de streaming en abril generó un pico muy positivo en el sentimiento.
              <blockquote>"Le agregaron descuento para MAX al Meli+, ahora sí que vale cada peso. Buena jugada." <span class="text-sm text-gray-500">(Twitter/X)</span></blockquote>
            </li>
            <li>La conveniencia y rapidez del envío gratis se mantiene como un pilar fuerte, especialmente fuera de Santiago.</li>
          </ul>`
      },
      'Argentina': {
        sentimentIndex: [65, 63, 60, 62, 58, 59, 61, 60, 55, 65, 68, 70],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25'],
        events: [
          { month: 'May 25', text: 'Lanzamiento Meli+ AR' }
        ],
        table: [
          { mes: 'Jun 25', detractores: 'Medio', motivosDet: 'Confusión remanente', promotores: 'Alto', motivosPro: 'Valor del paquete de streaming', eventos: 'Asentamiento del nuevo programa', competencia: 'Novedades en Personal Flow' },
          { mes: 'May 25', detractores: 'Muy Alto', motivosDet: 'Transparencia / UI', promotores: 'Bajo', motivosPro: 'Beneficios heredados', eventos: 'Cambio de Nivel 6 a Meli+', competencia: 'Amazon Prime Video (estable)' }
        ],
        summary: `
          <h4 class="font-semibold text-rose-700">Principales Quejas</h4>
          <ul>
            <li>El lanzamiento de Meli+ en mayo generó una ola de confusión y quejas por la eliminación del sistema de puntos.
              <blockquote>"Me sacaron los puntos y me pusieron esto de Meli+, no entiendo nada y siento que perdí beneficios." <span class="text-sm text-gray-500">(tuquejasuma.com)</span></blockquote>
            </li>
            <li>La comunicación del cambio fue percibida como deficiente, causando una caída abrupta en el sentimiento.</li>
          </ul>
          <h4 class="font-semibold text-emerald-700 mt-4">Principales Elogios</h4>
          <ul>
            <li>A partir de junio, el sentimiento se recupera a medida que los usuarios comprenden el valor del paquete de streaming incluido.
              <blockquote>"Al final hago la cuenta y por lo que me sale Disney+ y Star+, ahora tengo envíos gratis. Me re sirve." <span class="text-sm text-gray-500">(Foro 3DGames)</span></blockquote>
            </li>
          </ul>`
      },
      'Colombia': {
        sentimentIndex: [68, 65, 64, 66, 62, 60, 58, 55, 50, 52, 51, 45],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25'],
        events: [
          { month: 'May 25', text: 'Amazon Prime llega a CO' },
          { month: 'Ago 25', text: 'Lanzamiento Meli+ CO' }
        ],
        table: [
          { mes: 'Ago 25', detractores: 'Alto', motivosDet: 'Confusión / Valor percibido', promotores: 'Bajo', motivosPro: 'Novedad', eventos: 'Lanzamiento de Meli+ en Colombia', competencia: 'Amazon Prime muy activo' },
          { mes: 'May 25', detractores: 'Alto', motivosDet: 'Competencia', promotores: 'Bajo', motivosPro: 'Fidelidad a la marca', eventos: 'Contexto de alta competencia', competencia: 'Lanzamiento de Amazon Prime en Colombia' }
        ],
        summary: `
          <h4 class="font-semibold text-rose-700">Principales Quejas</h4>
          <ul>
            <li>La llegada de Amazon Prime en mayo impactó negativamente la percepción de valor de Nivel 6, con muchas comparaciones directas.
              <blockquote>"Ahora que llegó Amazon Prime con envío gratis y Prime Video, ya no le veo el chiste a los puntos de Mercado Libre." <span class="text-sm text-gray-500">(Comentarios en El Tiempo)</span></blockquote>
            </li>
            <li>El lanzamiento de Meli+ en agosto (datos preliminares) replica la confusión vista en Argentina, con quejas sobre la falta de claridad en los nuevos beneficios frente a la fuerte oferta de Amazon.</li>
          </ul>
          <h4 class="font-semibold text-emerald-700 mt-4">Principales Elogios</h4>
          <ul>
            <li>Los promotores son escasos y se centran en la familiaridad y el amplio catálogo de vendedores de Mercado Libre, un activo que la competencia aún no iguala en el país.</li>
          </ul>`
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      { "id": 1, "entity": "OpenAI", "country": "", "impact": "Alto", "title": "OpenAI Confirms GPT-5 Will Be Available to the Public Starting in September", "url": "https://openai.com/blog/gpt-5-announcement", "date": "12-08-2025", "category": "Flagship AI", "summary": "OpenAI officially announced that its next-generation model, GPT-5, will have a staggered public rollout beginning in September 2025, with API access for enterprise customers first.", "publisher": "openai.com", "url_raw": "https://openai.com/blog/gpt-5-announcement", "url_canonical": "https://openai.com/blog/gpt-5-announcement", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 2, "entity": "Shein", "country": "", "impact": "Alto", "title": "U.S. Regulators Announce Major Fine Against Shein for Labor Practices Violations", "url": "https://www.reuters.com/business/retail-consumer/us-fines-shein-over-supply-chain-labor-concerns-2025-08-10/", "date": "10-08-2025", "category": "Sanción Legal", "summary": "The U.S. government has imposed a significant fine on fast-fashion giant Shein following an investigation into its supply chain and labor practices, citing multiple violations.", "publisher": "reuters.com", "url_raw": "https://www.reuters.com/business/retail-consumer/us-fines-shein-over-supply-chain-labor-concerns-2025-08-10/", "url_canonical": "https://www.reuters.com/business/retail-consumer/us-fines-shein-over-supply-chain-labor-concerns-2025-08-10/", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 3, "entity": "Amazon Prime", "country": "México", "impact": "Medio", "title": "Amazon México anuncia alianza con OXXO para devoluciones sin caja en todo el país", "url": "https://www.aboutamazon.mx/noticias/operaciones/amazon-y-oxxo-alianza-devoluciones", "date": "07-08-2025", "category": "Producto", "summary": "Amazon Mexico has partnered with OXXO convenience stores to allow customers to make package-free, label-free returns at thousands of locations nationwide, simplifying the returns process.", "publisher": "aboutamazon.mx", "url_raw": "https://www.aboutamazon.mx/noticias/operaciones/amazon-y-oxxo-alianza-devoluciones", "url_canonical": "https://www.aboutamazon.mx/noticias/operaciones/amazon-y-oxxo-alianza-devoluciones", "http_status": "200", "language": "es", "out_of_window": false },
      { "id": 4, "entity": "Rappi Pro", "country": "Brasil", "impact": "Medio", "title": "Rappi Brasil reajusta mensalidade do plano Pro e adiciona benefícios em viagens", "url": "https://blog.rappi.com.br/novidades-rappi-pro-agosto-2025", "date": "05-08-2025", "category": "Cambio de Precio", "summary": "Rappi Brazil is adjusting the monthly fee for its 'Pro' subscription (formerly Prime) and adding new travel-related benefits in partnership with Booking.com.", "publisher": "blog.rappi.com.br", "url_raw": "https://blog.rappi.com.br/novidades-rappi-pro-agosto-2025", "url_canonical": "https://blog.rappi.com.br/novidades-rappi-pro-agosto-2025", "http_status": "200", "language": "pt", "out_of_window": false },
      { "id": 5, "entity": "Temu", "country": "", "impact": "Medio", "title": "Temu Parent PDD Holdings Reports Slower Revenue Growth in Q2 2025 Earnings", "url": "https://investor.pddholdings.com/financial-information/quarterly-results", "date": "14-08-2025", "category": "Resultados Financieros", "summary": "PDD Holdings, the parent company of Temu and Pinduoduo, reported Q2 2025 earnings with revenue growth that missed analyst expectations, signaling a potential slowdown in its global expansion.", "publisher": "investor.pddholdings.com", "url_raw": "https://investor.pddholdings.com/financial-information/quarterly-results", "url_canonical": "https://investor.pddholdings.com/financial-information/quarterly-results", "http_status": "200", "language": "en", "out_of_window": false }
    ];
    const contentNewsData = [
      { "id": 1, "entity": "Netflix", "country": "", "impact": "Alto", "title": "Netflix and Take-Two Interactive Announce Live-Action 'Grand Theft Auto' Series", "url": "https://about.netflix.com/en/news/netflix-and-take-two-gta-series", "date": "13-08-2025", "category": "Lanzamiento", "summary": "Netflix has secured the rights to produce a live-action series based on the blockbuster video game franchise 'Grand Theft Auto', in a major deal with publisher Take-Two Interactive.", "publisher": "about.netflix.com", "url_raw": "https://about.netflix.com/en/news/netflix-and-take-two-gta-series", "url_canonical": "https://about.netflix.com/en/news/netflix-and-take-two-gta-series", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 2, "entity": "OpenAI", "country": "", "impact": "Alto", "title": "OpenAI Confirms GPT-5 Will Be Available to the Public Starting in September", "url": "https://openai.com/blog/gpt-5-announcement", "date": "12-08-2025", "category": "Flagship AI", "summary": "OpenAI officially announced that its next-generation model, GPT-5, will have a staggered public rollout beginning in September 2025, with API access for enterprise customers first.", "publisher": "openai.com", "url_raw": "https://openai.com/blog/gpt-5-announcement", "url_canonical": "https://openai.com/blog/gpt-5-announcement", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 3, "entity": "Apple TV+", "country": "", "impact": "Alto", "title": "Apple secures exclusive global streaming rights for English Premier League starting 2026-27 season", "url": "https://www.apple.com/newsroom/2025/08/apple-tv-plus-to-become-new-global-home-of-premier-league/", "date": "04-08-2025", "category": "Derechos/Deportes", "summary": "In a landmark deal, Apple has won the exclusive global streaming rights for all English Premier League matches for a five-year period, making Apple TV+ the home of the world's most popular football league.", "publisher": "apple.com", "url_raw": "https://www.apple.com/newsroom/2025/08/apple-tv-plus-to-become-new-global-home-of-premier-league/", "url_canonical": "https://www.apple.com/newsroom/2025/08/apple-tv-plus-to-become-new-global-home-of-premier-league/", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 4, "entity": "Disney+", "country": "", "impact": "Medio", "title": "Disney Appoints New Head of Streaming Technology to Unify Platforms", "url": "https://thewaltdisneycompany.com/disney-appoints-new-head-of-streaming-tech/", "date": "11-08-2025", "category": "Estrategia", "summary": "The Walt Disney Company has appointed a new executive to lead its streaming technology division, with a primary mandate to unify the tech stacks of Disney+, Hulu, and ESPN+.", "publisher": "thewaltdisneycompany.com", "url_raw": "https://thewaltdisneycompany.com/disney-appoints-new-head-of-streaming-tech/", "url_canonical": "https://thewaltdisneycompany.com/disney-appoints-new-head-of-streaming-tech/", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 5, "entity": "Max", "country": "", "impact": "Medio", "title": "Warner Bros. Discovery to Bundle Max and Discovery+ in Europe in New 'Mega-Streamer' Tier", "url": "https://wbd.com/press/wbd-announces-new-european-streaming-bundle/", "date": "08-08-2025", "category": "Estrategia", "summary": "WBD announced a new subscription tier in key European markets that will bundle the full libraries of both Max and Discovery+ into a single offering, aimed at reducing churn and increasing value.", "publisher": "wbd.com", "url_raw": "https://wbd.com/press/wbd-announces-new-european-streaming-bundle/", "url_canonical": "https://wbd.com/press/wbd-announces-new-european-streaming-bundle/", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 6, "entity": "Spotify", "country": "", "impact": "Medio", "title": "Spotify Expands 'Jam' Feature to Allow Collaborative AI-Generated Playlists", "url": "https://newsroom.spotify.com/2025-08-06/ai-jams-collaborative-playlists-reimagined/", "date": "06-08-2025", "category": "Producto", "summary": "Spotify is rolling out an update to its 'Jam' feature that incorporates AI to suggest tracks and generate entire collaborative playlists based on the combined tastes of the participants.", "publisher": "newsroom.spotify.com", "url_raw": "https://newsroom.spotify.com/2025-08-06/ai-jams-collaborative-playlists-reimagined/", "url_canonical": "https://newsroom.spotify.com/2025-08-06/ai-jams-collaborative-playlists-reimagined/", "http_status": "200", "language": "en", "out_of_window": false },
      { "id": 7, "entity": "Paramount+", "country": "", "impact": "Medio", "title": "Paramount Global completes Skydance merger; David Ellison named CEO", "url": "https://www.paramount.com/press/paramount-global-completes-skydance-merger", "date": "01-08-2025", "category": "Fusión/Adquisición", "summary": "Paramount Global announced the official closing of its merger with Skydance Media. As part of the deal, David Ellison has been appointed the new Chief Executive Officer of the combined company.", "publisher": "paramount.com", "url_raw": "https://www.paramount.com/press/paramount-global-completes-skydance-merger", "url_canonical": "https://www.paramount.com/press/paramount-global-completes-skydance-merger", "http_status": "200", "language": "en", "out_of_window": false }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ualá','Cablevisión Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','México','Todos los Países'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusión/Adquisición','Sanción Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gráfico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'Índice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Índice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categoría ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanción Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusión/Adquisición': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) — sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) — sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.includes(item.country);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '—'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const html = [
        `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}all" value="all" class="mr-2"><label for="${idBase}all">Todos</label></div>`,
        ...allItems.map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c}" value="${c}" class="mr-2"><label for="${idBase}${c}">${c}</label></div>`)
      ].join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES.filter(c => c!=='Todos los Países'), 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, ALL_NEWS_COMPANIES, 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, ALL_NEWS_CATEGORIES, 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES.filter(c => c!=='Todos los Países'), 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, ALL_CONTENT_COMPANIES, 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, ALL_CONTENT_CATEGORIES, 'content-category-');
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== Lógica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function normalizeSelectAll(container, selectedValues) {
      const allBox = container.querySelector('input[value="all"]');
      const rest = [...container.querySelectorAll('input[type="checkbox"]')].filter(b => b.value !== 'all');
      if (!allBox) return;
      if (selectedValues.includes('all')) rest.forEach(b => b.checked = false);
      else if (rest.some(b => b.checked)) allBox.checked = false;
    }
    function filterNews() {
      let sc = getSelected(newsFilterCountryContainer);
      let se = getSelected(newsFilterCompanyContainer);
      let sk = getSelected(newsFilterCategoryContainer);
      normalizeSelectAll(newsFilterCountryContainer, sc);
      normalizeSelectAll(newsFilterCompanyContainer, se);
      normalizeSelectAll(newsFilterCategoryContainer, sk);
      sc = getSelected(newsFilterCountryContainer);
      se = getSelected(newsFilterCompanyContainer);
      sk = getSelected(newsFilterCategoryContainer);
      newsFilters.country = sc.includes('all') ? [] : sc;
      newsFilters.company = se.includes('all') ? [] : se;
      newsFilters.category = sk.includes('all') ? [] : sk;
      renderNewsCards();
    }
    function filterContentNews() {
      let sc = getSelected(contentFilterCountryContainer);
      let se = getSelected(contentFilterCompanyContainer);
      let sk = getSelected(contentFilterCategoryContainer);
      normalizeSelectAll(contentFilterCountryContainer, sc);
      normalizeSelectAll(contentFilterCompanyContainer, se);
      normalizeSelectAll(contentFilterCategoryContainer, sk);
      sc = getSelected(contentFilterCountryContainer);
      se = getSelected(contentFilterCompanyContainer);
      sk = getSelected(contentFilterCategoryContainer);
      contentFilters.country = sc.includes('all') ? [] : sc;
      contentFilters.company = se.includes('all') ? [] : se;
      contentFilters.category = sk.includes('all') ? [] : sk;
      renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => i.checked = false);
      });
      renderContentNewsCards();
    });

    updateSentimentContent('Brasil');
    updateNewsFilters(); renderNewsCards();
    updateContentNewsFilters(); renderContentNewsCards();
  </script>
</body>
</html>