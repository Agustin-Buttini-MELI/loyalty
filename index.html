<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1f2937; }
    .main-accent { color: #2563eb; } .bg-main-accent { background-color: #2563eb; }
    .tab-btn.active { background-color: #e0f2fe; border-bottom: 2px solid #2563eb; }
    .tab-btn { transition: background-color 0.3s ease; }
    .filter-checkbox-group { max-height: 180px; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 8px; }
    .filter-checkbox-item { display: flex; align-items: center; gap: .5rem; margin-bottom: .25rem; }
    details summary { list-style: none; }
    details summary::-webkit-details-marker { display: none; }
    details[open] summary svg { transform: rotate(180deg); }
  </style>
</head>
<body class="antialiased">
  <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-3">
          <div class="bg-main-accent p-2 rounded-lg">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          </div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800">Reporte Integrado: Sentimiento Meli+ y Noticias de Mercado</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
    <section class="mb-12 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-800">An√°lisis de Sentimiento Meli+</h2>
      <p class="mt-2 text-lg text-gray-600">Visualiza la evoluci√≥n de la percepci√≥n de los clientes en funci√≥n de eventos clave y la competencia.</p>
    </section>

    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">√çndice de Sentimiento General (Escala 0-100)</h3>
      <div class="chart-container w-full max-w-4xl mx-auto h-96">
        <canvas id="sentimentChart"></canvas>
      </div>
    </div>

<section id="glosario" class="bg-white rounded-lg shadow-md border border-gray-200 mb-8">
    <details>
      <summary class="cursor-pointer w-full flex items-center justify-between px-4 py-3 text-left text-gray-800 font-semibold hover:bg-gray-50">
        <span>üìñ Glosario</span>
        <svg class="w-5 h-5 text-gray-500 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
        </svg>
      </summary>
      <div class="px-4 pb-4 pt-2 text-sm text-gray-700 space-y-4">
        <div>
          <p class="font-semibold mb-1">Niveles de sentimiento</p>
          <ul class="list-disc list-inside space-y-1">
            <li><span class="text-emerald-700 font-medium">Muy alto:</span> ‚â•55% menciones ponderadas o +10 p.p. vs. promedio 3m.</li>
            <li><span class="text-emerald-600 font-medium">Alto:</span> 50‚Äì54% o +5 a +9 p.p.</li>
            <li><span class="text-gray-700 font-medium">Estable:</span> cambio ‚â§¬±3 p.p. vs. mes previo.</li>
            <li><span class="text-rose-600 font-medium">Bajo:</span> 30‚Äì39% o ‚àí5 a ‚àí9 p.p.</li>
            <li><span class="text-rose-700 font-medium">Muy bajo:</span> ‚â§29% o ca√≠da ‚â•‚àí10 p.p.</li>
          </ul>
        </div>
        <div>
          <p class="font-semibold mb-1">Menci√≥n</p>
          <p>
            Comentario individual capturado en fuentes monitorizadas (Reclame Aqui, SERNAC, Apestan.com, tuquejasuma, SIC, redes, foros, comentarios en noticias).
            Tras limpieza/deduplicaci√≥n, cada menci√≥n se pondera por <em>engagement</em>, <em>recencia</em>, <em>credibilidad</em> y <em>severidad</em>.
            La suma ponderada genera el √≠ndice mensual (0‚Äì100).
          </p>
        </div>
      </div>
    </details>
</section>
    <section class="mb-8">
      <div class="flex justify-center border-b border-gray-200">
        <button data-country="Brasil" class="tab-btn active px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Brasil</button>
        <button data-country="M√©xico" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">M√©xico</button>
        <button data-country="Chile" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Chile</button>
        <button data-country="Argentina" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Argentina</button>
        <button data-country="Colombia" class="tab-btn px-6 py-3 font-semibold text-gray-700 hover:bg-blue-50">Colombia</button>
      </div>
    </section>

    <section id="country-data" class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Detalles por Pa√≠s: <span id="country-name" class="main-accent">Brasil</span></h2>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Tabla Resumen de Sentimientos</h3>
      <div class="overflow-x-auto mb-8">
        <table id="sentiment-table" class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Detractores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentimientos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Motivos Promotores</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eventos Clave/Contexto</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Novedades de la Competencia</th>
            </tr>
          </thead>
          <tbody id="sentiment-table-body" class="bg-white divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Resumen de Sentimientos Detractores y Promotores</h3>
      <div id="sentiment-summary" class="prose max-w-none"></div>
    </section>

    <!-- Vertiente 2 -->
    <section id="market-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Alertas de Mercado Recientes</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="news-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="news-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="news-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="news-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-news-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias con los filtros seleccionados.</p>
        </div>
      </div>
    </section>

    <!-- Vertiente 3 -->
    <section id="content-platforms-news" class="mt-12">
      <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Noticias de Plataformas de Contenido y Streaming</h2>
        <div class="bg-white p-4 rounded-xl shadow-inner border border-gray-200 mb-8">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Pa√≠s</label>
              <div id="content-filter-country" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
              <div id="content-filter-company" class="filter-checkbox-group"></div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Categor√≠a</label>
              <div id="content-filter-category" class="filter-checkbox-group"></div>
            </div>
            <div class="flex items-end">
              <button id="content-reset-filters" class="w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">Limpiar Filtros</button>
            </div>
          </div>
        </div>
        <div id="content-alerts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        <div id="no-content-results" class="hidden text-center py-12">
          <p class="text-xl text-gray-500">No se encontraron noticias de contenido con los filtros seleccionados.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 text-gray-300 mt-16">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
      <p>&copy; 2025 Reporte de Sentimiento Meli+. Visualizaci√≥n interactiva.</p>
    </div>
  </footer>

  <script>
    /* ===== Sentimiento (Vertiente 1) ===== */
    const sentimentData = {
      'Brasil': {
        sentimentIndex: [75, 78, 76, 75, 73, 65, 68, 70, 72, 60, 62, 65, 63, 61],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25'],
        events: [{ month: 'Sep 24', text: 'Lanzamiento Meli+' }, { month: 'Feb 25', text: 'Cambio % cashback' }, { month: 'May 25', text: 'Meli+ 120% CDI' }, { month: 'Jun 25', text: 'Cambio env√≠o gratis' }],
        table: [
          { mes: 'Oct 25', detractores: 'Estable (Bajo)', motivosDet: 'Valor percibido env√≠o', promotores: 'Estable', motivosPro: 'Beneficios streaming', eventos: 'Sin eventos directos', competencia: 'Amazon/Shopee mantienen presi√≥n en precios/log√≠stica' },
          { mes: 'Sep 25', detractores: 'Mejora leve', motivosDet: 'Valor percibido env√≠o', promotores: 'Estable', motivosPro: 'Beneficios streaming', eventos: 'Anuncios Disney+ con ads', competencia: 'Prime Day (Jul) eco a√∫n visible' },
          { mes: 'Ago 25', detractores: 'Estable (Bajo)', motivosDet: 'Valor percibido env√≠o', promotores: 'Mejora leve', motivosPro: 'Ofertas puntuales', eventos: 'Sin eventos directos', competencia: 'Sin grandes movimientos' },
        ],
        summary: `<ul><li><strong class="text-rose-700">Punto de fricci√≥n persistente:</strong> Los cambios en la pol√≠tica de env√≠o gratis de Junio 2025 siguen generando comentarios negativos. Usuarios comparan la nueva pol√≠tica con la oferta "ilimitada" anterior de Meli+.</li><li><strong class="text-emerald-700">Valor en entretenimiento:</strong> El paquete de streaming (Disney+/Max) sigue siendo el ancla principal de valor para los suscriptores, a pesar de la introducci√≥n del plan con anuncios en Disney+.</li></ul><blockquote class="border-l-4 border-gray-300 pl-4 mt-4 text-gray-600">"O frete gr√°tis n√£o √© mais o que era. Antes eu comprava qualquer coisinha e chegava r√°pido, agora tenho que ficar juntando itens pra bater o valor m√≠nimo, mesmo sendo Meli+. Perdeu um pouco o sentido pra mim." <cite class="text-xs block mt-1">- Comentario en Reclame Aqui</cite></blockquote><blockquote class="border-l-4 border-gray-300 pl-4 mt-4 text-gray-600">"Pago o Meli+ basicamente pelo combo Disney+ e Max. O resto √© b√¥nus. Enquanto tiver isso, pra mim compensa." <cite class="text-xs block mt-1">- Usuario en Reddit (r/brasil)</cite></blockquote>`
      },
      'M√©xico': {
        sentimentIndex: [78, 80, 79, 77, 75, 68, 70, 72, 69, 71, 73, 74, 72, 70],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25'],
        events: [{ month: 'Sep 24', text: 'Lanzamiento Meli+' }, { month: 'Feb 25', text: 'Cambio % cashback' }, { month: 'May 25', text: 'Hot Sale / Lanza NU+' }],
        table: [
          { mes: 'Oct 25', detractores: 'Estable', motivosDet: 'Confusi√≥n beneficios', promotores: 'Estable', motivosPro: 'Env√≠os gratis y r√°pidos', eventos: 'Sin eventos directos', competencia: 'Amazon con fuerte campa√±a pre-navide√±a' },
          { mes: 'Sep 25', detractores: 'Estable', motivosDet: 'Costo/Beneficio vs Prime', promotores: 'Leve ca√≠da', motivosPro: 'Env√≠os gratis y r√°pidos', eventos: 'Sin eventos directos', competencia: 'Walmart anuncia "Fin Irresistible"' },
          { mes: 'Ago 25', detractores: 'Leve mejora', motivosDet: 'Costo/Beneficio vs Prime', promotores: 'Estable', motivosPro: 'Cat√°logo de productos', eventos: 'Sin eventos directos', competencia: 'Liverpool con "Venta Nocturna"' },
        ],
        summary: `<ul><li><strong class="text-rose-700">Competencia de Propuesta de Valor:</strong> Usuarios frecuentemente comparan Meli+ con Amazon Prime, especialmente en lo que respecta a la consistencia de los tiempos de entrega y el valor del paquete de entretenimiento. La llegada de NU+ agreg√≥ un competidor en el √°mbito de beneficios financieros.</li><li><strong class="text-emerald-700">Log√≠stica como diferenciador clave:</strong> La velocidad y confiabilidad de los env√≠os "Full" sigue siendo el principal motivo de elogio y retenci√≥n para los usuarios de Meli+.</li></ul><blockquote class="border-l-4 border-gray-300 pl-4 mt-4 text-gray-600">"Tengo los dos, Prime y Meli+. La verdad Meli+ me gana por la rapidez de las entregas, casi siempre al d√≠a siguiente. Pero el streaming de Prime Video a veces tiene mejores cosas." <cite class="text-xs block mt-1">- Usuario en X</cite></blockquote><blockquote class="border-l-4 border-gray-300 pl-4 mt-4 text-gray-600">"Pagu√© Meli+ para el Hot Sale y se qued√≥. S√≠ me he ahorrado una lana en env√≠os y las ofertas valen la pena." <cite class="text-xs block mt-1">- Comentario en Apestan.com</cite></blockquote>`
      },
      'Chile': {
        sentimentIndex: [65, 66, 68, 67, 70, 72, 73, 82, 80, 78, 77, 76, 75, 74],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25'],
        events: [{ month: 'Abr 25', text: 'Nuevos beneficios Meli+' }],
        table: [
          { mes: 'Oct 25', detractores: 'Estable', motivosDet: 'Disponibilidad de productos', promotores: 'Estable', motivosPro: 'Env√≠os y beneficios', eventos: 'Sin eventos directos', competencia: 'Falabella/Ripley con descuentos CMR' },
          { mes: 'Sep 25', detractores: 'Estable', motivosDet: 'Tiempos de entrega a regiones', promotores: 'Estable', motivosPro: 'Beneficios streaming', eventos: 'Sin eventos directos', competencia: 'Cyber Monday (anuncios)' },
          { mes: 'Ago 25', detractores: 'Leve aumento', motivosDet: 'Tiempos de entrega a regiones', promotores: 'Estable', motivosPro: 'Env√≠os gratis', eventos: 'Sin eventos directos', competencia: 'Sin grandes movimientos' },
        ],
        summary: `<ul><li><strong class="text-emerald-700">Impacto positivo duradero:</strong> La renovaci√≥n de beneficios en Abril 2025 gener√≥ un alza significativa en el sentimiento que se ha mantenido relativamente estable, consolidando a Meli+ como un programa de valor percibido alto.</li><li><strong class="text-rose-700">Desaf√≠o log√≠stico regional:</strong> Persisten quejas sobre la diferencia en los tiempos de entrega entre la Regi√≥n Metropolitana y otras regiones del pa√≠s, siendo un punto de fricci√≥n recurrente.</li></ul><blockquote class="border-l-4 border-gray-300 pl-4 mt-4 text-gray-600">"Desde que metieron m√°s descuentos y el env√≠o gratis mejor√≥ en abril, vale cada peso. Lo uso todas las semanas." <cite class="text-xs block mt-1">- Comentario en Facebook</cite></blockquote><blockquote class="border-l-4 border-gray-300 pl-4 mt-4 text-gray-600">"Todo bien si vives en Santiago, pero para los que somos de Conce, el 'llega ma√±ana' es m√°s bien 'llega en 3 d√≠as si tienes suerte'." <cite class="text-xs block mt-1">- Reclamo en SERNAC</cite></blockquote>`
      },
      'Argentina': {
        sentimentIndex: [68, 70, 72, 71, 70, 69, 68, 70, 75, 73, 72, 74, 73, 72],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25'],
        events: [{ month: 'May 25', text: 'Lanzamiento Meli+ (desde Nivel 6)' }],
        table: [
          { mes: 'Oct 25', detractores: 'Estable', motivosDet: 'Costo de la suscripci√≥n', promotores: 'Estable', motivosPro: 'Cuotas y env√≠os', eventos: 'Sin eventos directos', competencia: 'Ual√° y bancos digitales con promociones agresivas' },
          { mes: 'Sep 25', detractores: 'Estable', motivosDet: 'Aumentos de precio', promotores: 'Estable', motivosPro: 'Beneficios streaming', eventos: 'Sin eventos directos', competencia: 'Cyber Monday (anuncios)' },
          { mes: 'Ago 25', detractores: 'Leve ca√≠da', motivosDet: 'Aumentos de precio', promotores: 'Leve ca√≠da', motivosPro: 'Cuotas y env√≠os', eventos: 'Sin eventos directos', competencia: 'Sin grandes movimientos' },
        ],
        summary: `<ul><li><strong class="text-emerald-700">Transici√≥n Exitosa:</strong> El paso de Nivel 6 a Meli+ en Mayo 2025 fue bien recibido, percibido como una mejora de beneficios sin un aumento de costo inicial disruptivo. El valor de los servicios de streaming incluidos es el ancla principal.</li><li><strong class="text-rose-700">Sensibilidad al precio:</strong> En un contexto de alta inflaci√≥n, cualquier ajuste en el precio de la suscripci√≥n genera un volumen de conversaci√≥n negativa inmediato, aunque no necesariamente se traduce en una cancelaci√≥n masiva si los beneficios siguen siendo percibidos como valiosos.</li></ul><blockquote class="border-l-4 border-gray-300 pl-4 mt-4 text-gray-600">"Pas√© de Nivel 6 a Meli+ y es casi lo mismo pero con Max. Por ahora re va. Lo que me salva son las cuotas sin inter√©s, si no imposible." <cite class="text-xs block mt-1">- Usuario en tuquejasuma.com</cite></blockquote><blockquote class="border-l-4 border-gray-300 pl-4 mt-4 text-gray-600">"Me lleg√≥ el mail que aumenta de nuevo Meli+. Ya no s√© si me conviene, lo uso para el env√≠o nom√°s." <cite class="text-xs block mt-1">- Usuario en X</cite></blockquote>`
      },
      'Colombia': {
        sentimentIndex: [70, 71, 70, 69, 68, 67, 65, 62, 64, 66, 68, 75, 73, 72],
        labels: ['Sep 24', 'Oct 24', 'Nov 24', 'Dic 24', 'Ene 25', 'Feb 25', 'Mar 25', 'Abr 25', 'May 25', 'Jun 25', 'Jul 25', 'Ago 25', 'Sep 25', 'Oct 25'],
        events: [{ month: 'May 25', text: 'Amazon Prime llega a CO' }, { month: 'Ago 25', text: 'Lanzamiento Meli+' }],
        table: [
          { mes: 'Oct 25', detractores: 'Estable', motivosDet: 'Confusi√≥n beneficios', promotores: 'Estable', motivosPro: 'Env√≠os y streaming', eventos: 'Sin eventos directos', competencia: 'Amazon Prime con agresiva campa√±a de adquisici√≥n' },
          { mes: 'Sep 25', detractores: 'Leve mejora', motivosDet: 'Comparaci√≥n con Rappi Prime', promotores: 'Estable', motivosPro: 'Env√≠os y streaming', eventos: 'Post-lanzamiento Meli+', competencia: 'Rappi con nuevos descuentos' },
          { mes: 'Ago 25', detractores: 'Vol√°til', motivosDet: 'Problemas de migraci√≥n N6', promotores: 'Alto', motivosPro: 'Nuevos beneficios', eventos: 'Lanzamiento Meli+', competencia: 'Amazon Prime Day (Jul) a√∫n reciente' },
        ],
        summary: `<ul><li><strong class="text-emerald-700">Lanzamiento Positivo:</strong> El lanzamiento de Meli+ en Agosto 2025 gener√≥ un pico de sentimiento positivo, superando la incertidumbre creada por la llegada de Amazon Prime meses antes. La oferta de streaming es un diferenciador clave.</li><li><strong class="text-rose-700">Ecosistema Competitivo:</strong> Los usuarios comparan constantemente la propuesta de valor con Rappi Pro (enfocado en delivery de √∫ltima milla) y Amazon Prime (enfocado en log√≠stica y VOD). La comunicaci√≥n de los beneficios √∫nicos de Meli+ es crucial.</li></ul><blockquote class="border-l-4 border-gray-300 pl-4 mt-4 text-gray-600">"Me pasaron a Meli+ y ahora tengo Disney+ y Max, una maravilla. Antes pagaba Nivel 6 y no sent√≠a tanto el beneficio." <cite class="text-xs block mt-1">- Usuario en TikTok</cite></blockquote><blockquote class="border-l-4 border-gray-300 pl-4 mt-4 text-gray-600">"No entiendo bien qu√© gano con Meli+ que no me d√© Rappi Prime. El env√≠o gratis de Meli es para compras, el de Rappi para el d√≠a a d√≠a. Son cosas distintas." <cite class="text-xs block mt-1">- Queja registrada en SIC</cite></blockquote>`
      }
    };

    /* ===== Vertiente 2 (Alertas) y Vertiente 3 (Plataformas) ===== */
    const newsData = [
      { "id": 1, "entity": "Amazon Prime", "country": "Brasil", "impact": "Alto", "title": "Amazon Prime Announces Price Adjustment in Brazil to R$24.90/month, Adds Live Local Soccer Matches", "url": "https://press.aboutamazon.com/br/noticias/amazon-prime-novo-preco-e-beneficios-2025", "date": "20-10-2025", "category": "Cambio de Precio", "summary": "Amazon is increasing its Prime subscription price in Brazil for the first time in three years, citing inflation and significant investment in content, including the addition of exclusive live streaming rights for a regional soccer league.", "publisher": "press.aboutamazon.com" },
      { "id": 2, "entity": "Rappi Pro", "country": "M√©xico", "impact": "Medio", "title": "Rappi Expands 'Rappi Pro' Benefits with New Insurance and Travel Perks in Partnership with AXA and Despegar", "url": "https://blog.rappi.com/mx/rappi-pro-se-renueva-con-nuevos-aliados", "date": "16-10-2025", "category": "Estrategia", "summary": "Rappi is bolstering its Pro subscription by adding new benefits outside of its core delivery service, aiming to increase user retention against competitors like Uber One.", "publisher": "blog.rappi.com" }
    ];
    const contentNewsData = [
      { "id": 3, "entity": "Paramount+", "country": "", "impact": "Alto", "title": "Skydance Media Officially Completes Acquisition of National Amusements, Taking Control of Paramount Global", "url": "https://variety.com/2025/biz/news/skydance-completes-paramount-acquisition-1235456789/", "date": "23-10-2025", "category": "Fusi√≥n/Adquisici√≥n", "summary": "The long-negotiated deal has closed, putting David Ellison's Skydance in control of the media empire. The completion follows final regulatory approvals in the US and Europe.", "publisher": "variety.com" },
      { "id": 4, "entity": "OpenAI", "country": "", "impact": "Alto", "title": "OpenAI Announces General Availability of GPT-5, Featuring New Modalities and Agentic Capabilities", "url": "https://openai.com/blog/gpt-5-now-generally-available", "date": "21-10-2025", "category": "Flagship AI", "summary": "OpenAI has launched its next-generation flagship model, GPT-5, available to enterprise customers and via API. The model introduces significant improvements in reasoning and the ability to autonomously execute complex multi-step tasks.", "publisher": "openai.com" },
      { "id": 5, "entity": "Disney+", "country": "", "impact": "Medio", "title": "Disney+ and Hulu to Combine Apps in Latin America in Q1 2026", "url": "https://thewaltdisneycompany.com/disney-plus-hulu-app-merge-latam/", "date": "15-10-2025", "category": "Estrategia", "summary": "Following the successful app merge in the US, Disney announces it will replicate the strategy across Latin America, creating a single streaming destination for its content. The Star+ brand will be sunsetted.", "publisher": "thewaltdisneycompany.com" },
      { "id": 6, "entity": "Netflix", "country": "", "impact": "Medio", "title": "Netflix Renews 'The Diplomat' For Two More Seasons", "url": "https://about.netflix.com/en/news/the-diplomat-renewed-for-seasons-3-and-4", "date": "18-10-2025", "category": "Producto", "summary": "Following strong viewership for its second season, the political thriller has been given a two-season renewal, securing the show's future on the platform.", "publisher": "about.netflix.com" }
    ];

    /* ===== LISTAS MAESTRAS ===== */
    const ALL_NEWS_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico','Todos los Pa√≠ses'];
    const ALL_NEWS_COMPANIES = [
      'Amazon Prime','Shein','Temu','Shopee','Tiendanube','Rappi Pro','Uber One','Netflix','Spotify Premium','OpenAI (ChatGPT Premium)','Disney+',
      'Nubank Ultravioleta','Smiles','Globoplay','Nubank','Ual√°','Cablevisi√≥n Flow','Amazon Prime Video','DGO','Mach'
    ];
    const ALL_NEWS_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const ALL_CONTENT_COUNTRIES = ['Argentina','Brasil','Chile','M√©xico','Todos los Pa√≠ses'];
    const ALL_CONTENT_COMPANIES = [
      'Disney+','Netflix','Apple TV+','Max','Paramount+','Universal+','Vix Premium','Globoplay','Spotify','Deezer','OpenAI'
    ];
    const ALL_CONTENT_CATEGORIES = [
      'Cambio de Precio','Lanzamiento','Fusi√≥n/Adquisici√≥n','Sanci√≥n Legal','Estrategia','Producto',
      'Resultados Financieros','Derechos/Deportes','Flagship AI'
    ];

    const chartColors = { main: '#2563eb', event: '#f59e0b' };

    const tabButtons = document.querySelectorAll('.tab-btn');
    const countryName = document.getElementById('country-name');
    const sentimentTableBody = document.getElementById('sentiment-table-body');
    const sentimentSummary = document.getElementById('sentiment-summary');
    let sentimentChart = null;

    const alertsGrid = document.getElementById('alerts-grid');
    const newsNoResults = document.getElementById('no-news-results');
    const newsFilterCountryContainer = document.getElementById('news-filter-country');
    const newsFilterCompanyContainer = document.getElementById('news-filter-company');
    const newsFilterCategoryContainer = document.getElementById('news-filter-category');
    let newsFilters = { country: [], company: [], category: [] };

    const contentAlertsGrid = document.getElementById('content-alerts-grid');
    const contentNewsNoResults = document.getElementById('no-content-results');
    const contentFilterCountryContainer = document.getElementById('content-filter-country');
    const contentFilterCompanyContainer = document.getElementById('content-filter-company');
    const contentFilterCategoryContainer = document.getElementById('content-filter-category');
    let contentFilters = { country: [], company: [], category: [] };

    /* ==== Helpers del gr√°fico ==== */
    function renderChart(data) {
      const ctx = document.getElementById('sentimentChart').getContext('2d');
      if (sentimentChart) sentimentChart.destroy();
      sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: '√çndice de Sentimiento',
            data: data.sentimentIndex,
            borderColor: chartColors.main,
            backgroundColor: 'rgba(37, 99, 235, 0.2)',
            borderWidth: 2, fill: true,
            pointBackgroundColor: data.labels.map(l => data.events.find(e => e.month === l) ? chartColors.event : chartColors.main),
            pointRadius: data.labels.map(l => data.events.find(e => e.month === l) ? 6 : 4),
            pointHoverRadius: 8
          }]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '√çndice de Sentimiento (0-100)', font: { weight: 'bold' } } } },
          plugins: { tooltip: { callbacks: { title: (items) => {
            const m = items[0].label; const ev = data.events.find(e => e.month === m);
            return m + (ev ? `\nEvento: ${ev.text}` : '');
          }}}}
        }
      });
    }

    function renderSentimentTable(rows) {
      sentimentTableBody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.mes}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.detractores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-rose-100 bg-rose-50 text-rose-700">${row.motivosDet}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.promotores}</td>
          <td class="px-6 py-4 text-sm"><span class="inline-block px-2 py-1 rounded-md ring-1 ring-emerald-100 bg-emerald-50 text-emerald-700">${row.motivosPro}</span></td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.eventos}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${row.competencia}</td>`;
        sentimentTableBody.appendChild(tr);
      });
    }
    function renderSummary(html) { sentimentSummary.innerHTML = html; }
    function updateSentimentContent(country) {
      const data = sentimentData[country]; if (!data) return;
      countryName.textContent = country; renderChart(data); renderSentimentTable(data.table); renderSummary(data.summary);
    }

    /* ==== Etiquetas de categor√≠a ==== */
    function getCategoryTag(category) {
      switch (category) {
        case 'Sanci√≥n Legal': return `<span class="bg-red-100 text-red-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Cambio de Precio': return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Lanzamiento': return `<span class="bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Fusi√≥n/Adquisici√≥n': return `<span class="bg-green-100 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Estrategia': return `<span class="bg-purple-100 text-purple-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Producto': return `<span class="bg-orange-100 text-orange-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Resultados Financieros': return `<span class="bg-teal-100 text-teal-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Derechos/Deportes': return `<span class="bg-indigo-100 text-indigo-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        case 'Flagship AI': return `<span class="bg-pink-100 text-pink-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
        default: return `<span class="bg-gray-100 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">${category}</span>`;
      }
    }

    /* ==== Helpers de fuente (host en texto plano, sin enlace) ==== */
    function sourceHost(u) {
      try { return new URL(u).hostname.replace(/^www\./, ''); } catch { return ''; }
    }

    /* ==== Render tarjetas (Vertiente 2) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderNewsCards() {
      alertsGrid.innerHTML = '';
      const filtered = newsData.filter(item => {
        const cm = newsFilters.country.length === 0 || newsFilters.country.includes('all') || newsFilters.country.includes(item.country);
        const em = newsFilters.company.length === 0 || newsFilters.company.includes('all') || newsFilters.company.includes(item.entity);
        const km = newsFilters.category.length === 0 || newsFilters.category.includes('all') || newsFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      newsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}${row.country ? ` (${row.country})` : ''}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        alertsGrid.appendChild(card);
      });
    }

    /* ==== Render tarjetas (Vertiente 3) ‚Äî sin enlaces ni badge de impacto ==== */
    function renderContentNewsCards() {
      contentAlertsGrid.innerHTML = '';
      const filtered = contentNewsData.filter(item => {
        const cm = contentFilters.country.length === 0 || contentFilters.country.includes('all') || contentFilters.country.includes(item.country);
        const em = contentFilters.company.length === 0 || contentFilters.company.includes('all') || contentFilters.company.includes(item.entity);
        const km = contentFilters.category.length === 0 || contentFilters.category.includes('all') || contentFilters.category.includes(item.category);
        return cm && em && km;
      }).sort((a,b) => {
        const da = new Date((a.date || '').split('-').reverse().join('-'));
        const db = new Date((b.date || '').split('-').reverse().join('-'));
        if (da > db) return -1; if (da < db) return 1;
        const order = { 'Alto':1, 'Medio':2, 'Bajo':3 }; return (order[a.impact]||9) - (order[b.impact]||9);
      });
      contentNewsNoResults.classList.toggle('hidden', filtered.length !== 0);
      filtered.forEach(row => {
        const host = sourceHost(row.url);
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-xl shadow-md border border-gray-200 flex flex-col hover:shadow-xl transition-all duration-300';
        card.innerHTML = `
          <div class="flex-grow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-bold text-gray-800 text-lg">${row.entity}</h4>
              ${getCategoryTag(row.category)}
            </div>
            <p class="text-gray-700 mb-3">${row.title}</p>
            <p class="text-xs text-gray-500">Fuente: <span class="font-medium">${host || '‚Äî'}</span></p>
          </div>
          <div class="text-sm text-gray-500 mt-auto pt-4 border-t border-gray-200 flex justify-between items-center">
            <span>${row.date || ''}</span>
          </div>`;
        contentAlertsGrid.appendChild(card);
      });
    }

    /* ==== Poblar filtros ==== */
    function populateCheckboxes(container, allItems, group) {
      const idBase = group + '-';
      const html = [
        `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}all" value="all" class="mr-2"><label for="${idBase}all">Todos</label></div>`,
        ...allItems.sort().map(c => `<div class="filter-checkbox-item"><input type="checkbox" id="${idBase}${c.replace(/\s/g, '')}" value="${c}" class="mr-2"><label for="${idBase}${c.replace(/\s/g, '')}">${c}</label></div>`)
      ].join('');
      container.innerHTML = html;
    }

    function updateNewsFilters() {
      populateCheckboxes(newsFilterCountryContainer, ALL_NEWS_COUNTRIES.filter(c => c!=='Todos los Pa√≠ses'), 'news-country-');
      populateCheckboxes(newsFilterCompanyContainer, [...new Set(newsData.map(i => i.entity).concat(ALL_NEWS_COMPANIES))], 'news-company-');
      populateCheckboxes(newsFilterCategoryContainer, [...new Set(newsData.map(i => i.category).concat(ALL_NEWS_CATEGORIES))], 'news-category-');
      newsFilterCountryContainer.addEventListener('change', filterNews);
      newsFilterCompanyContainer.addEventListener('change', filterNews);
      newsFilterCategoryContainer.addEventListener('change', filterNews);
    }

    function updateContentNewsFilters() {
      populateCheckboxes(contentFilterCountryContainer, ALL_CONTENT_COUNTRIES.filter(c => c!=='Todos los Pa√≠ses'), 'content-country-');
      populateCheckboxes(contentFilterCompanyContainer, [...new Set(contentNewsData.map(i => i.entity).concat(ALL_CONTENT_COMPANIES))], 'content-company-');
      populateCheckboxes(contentFilterCategoryContainer, [...new Set(contentNewsData.map(i => i.category).concat(ALL_CONTENT_CATEGORIES))], 'content-category-');
      contentFilterCountryContainer.addEventListener('change', filterContentNews);
      contentFilterCompanyContainer.addEventListener('change', filterContentNews);
      contentFilterCategoryContainer.addEventListener('change', filterContentNews);
    }

    /* ==== L√≥gica de filtros ==== */
    function getSelected(container) {
      return Array.from(container.querySelectorAll('input:checked')).map(i => i.value);
    }
    function normalizeSelectAll(container, selectedValues) {
      const allBox = container.querySelector('input[value="all"]');
      const rest = [...container.querySelectorAll('input[type="checkbox"]')].filter(b => b.value !== 'all');
      if (!allBox) return;
      if (selectedValues.includes('all')) rest.forEach(b => { b.checked = false; b.disabled = true; });
      else rest.forEach(b => b.disabled = false);
    }
    function filterNews() {
      let sc = getSelected(newsFilterCountryContainer);
      let se = getSelected(newsFilterCompanyContainer);
      let sk = getSelected(newsFilterCategoryContainer);
      normalizeSelectAll(newsFilterCountryContainer, sc);
      normalizeSelectAll(newsFilterCompanyContainer, se);
      normalizeSelectAll(newsFilterCategoryContainer, sk);
      sc = getSelected(newsFilterCountryContainer);
      se = getSelected(newsFilterCompanyContainer);
      sk = getSelected(newsFilterCategoryContainer);
      newsFilters.country = sc.includes('all') ? [] : sc;
      newsFilters.company = se.includes('all') ? [] : se;
      newsFilters.category = sk.includes('all') ? [] : sk;
      renderNewsCards();
    }
    function filterContentNews() {
      let sc = getSelected(contentFilterCountryContainer);
      let se = getSelected(contentFilterCompanyContainer);
      let sk = getSelected(contentFilterCategoryContainer);
      normalizeSelectAll(contentFilterCountryContainer, sc);
      normalizeSelectAll(contentFilterCompanyContainer, se);
      normalizeSelectAll(contentFilterCategoryContainer, sk);
      sc = getSelected(contentFilterCountryContainer);
      se = getSelected(contentFilterCompanyContainer);
      sk = getSelected(contentFilterCategoryContainer);
      contentFilters.country = sc.includes('all') ? [] : sc;
      contentFilters.company = se.includes('all') ? [] : se;
      contentFilters.category = sk.includes('all') ? [] : sk;
      renderContentNewsCards();
    }

    /* ==== Tabs & Boot ==== */
    tabButtons.forEach(btn => btn.addEventListener('click', (e) => {
      tabButtons.forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      updateSentimentContent(e.target.dataset.country);
    }));
    document.getElementById('news-reset-filters').addEventListener('click', () => {
      newsFilters = { country: [], company: [], category: [] };
      [newsFilterCountryContainer, newsFilterCompanyContainer, newsFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => {i.checked = false; i.disabled=false;});
      });
      renderNewsCards();
    });
    document.getElementById('content-reset-filters').addEventListener('click', () => {
      contentFilters = { country: [], company: [], category: [] };
      [contentFilterCountryContainer, contentFilterCompanyContainer, contentFilterCategoryContainer].forEach(c => {
        Array.from(c.querySelectorAll('input')).forEach(i => {i.checked = false; i.disabled=false;});
      });
      renderContentNewsCards();
    });

    updateSentimentContent('Brasil');
    updateNewsFilters(); renderNewsCards();
    updateContentNewsFilters(); renderContentNewsCards();
  </script>
</body>
</html>